import{a as m}from"./chunk-L5TQBNKQ.js";import{Vb as $,W as l,Z as d,a as u,b as h,d as n,x as a}from"./chunk-3BHHYQXT.js";var L=(()=>{class p{constructor(e){this.http=e,this.apiUrl=`${m.url}academic-lessons`}createLesson(e){return this.http.post(this.apiUrl,e)}getGroupLessons(e){return this.http.get(`${this.apiUrl}/group/${e}`)}getMyLessons(){return this.http.get(`${this.apiUrl}/my-lessons`)}getTeacherLessons(){return this.http.get(`${this.apiUrl}/teacher-lessons`)}getLessonById(e){return this.http.get(`${this.apiUrl}/${e}`)}updateLesson(e,t){return this.http.put(`${this.apiUrl}/${e}`,t)}deleteLesson(e){return this.http.delete(`${this.apiUrl}/${e}`)}approveLesson(e,t){return this.http.post(`${this.apiUrl}/${e}/approve`,t,{responseType:"text"}).pipe(a(s=>{try{return JSON.parse(s)}catch{return{status:"success",message:s,data:{}}}}))}rejectLesson(e,t){return this.http.post(`${this.apiUrl}/${e}/reject`,{reason:t},{responseType:"text"}).pipe(a(s=>{try{return JSON.parse(s)}catch{return{status:"success",message:s,data:{}}}}))}gradeLesson(e,t){return this.http.post(`${this.apiUrl}/${e}/grade`,t,{responseType:"text"}).pipe(a(s=>{try{return JSON.parse(s)}catch{return{status:"success",message:s,data:{}}}}))}updateLessonStatus(e,t){return this.http.put(`${this.apiUrl}/${e}/state`,t)}requestExport(e){return this.http.post(`${this.apiUrl}/${e}/request-export`,{},{responseType:"text"}).pipe(a(t=>{try{return JSON.parse(t)}catch{return{status:"success",message:t,data:{}}}}))}inviteCollaborator(e){let o=e,{lessonId:t}=o,s=n(o,["lessonId"]),r=h(u({},s),{role:"member"});return r.userId&&!r.user&&(r.user=r.userId),console.log("\u{1F4E4} [AcademicLessonService.inviteCollaborator] URL:",`${this.apiUrl}/${t}/invite`),console.log("\u{1F4E4} [AcademicLessonService.inviteCollaborator] Request Body:",r),console.log("\u{1F4E4} [AcademicLessonService.inviteCollaborator] Original payload:",e),this.http.post(`${this.apiUrl}/${t}/invite`,r,{responseType:"text"}).pipe(a(i=>{console.log("\u{1F4E5} [AcademicLessonService.inviteCollaborator] Raw response:",i);try{let c=JSON.parse(i);return console.log("\u{1F4E5} [AcademicLessonService.inviteCollaborator] Parsed response:",c),c}catch{return console.log("\u26A0\uFE0F [AcademicLessonService.inviteCollaborator] No se pudo parsear como JSON, devolviendo texto"),{status:"success",message:i,data:{}}}}))}sendChatMessage(e){let r=e,{lessonId:t}=r,s=n(r,["lessonId"]);return this.http.post(`${this.apiUrl}/${t}/chat`,s,{responseType:"text"}).pipe(a(o=>{try{return JSON.parse(o)}catch{return{status:"success",message:o,data:{}}}}))}uploadResource(e){let t=new FormData;return t.append("file",e.file),e.description&&t.append("description",e.description),t.append("category",e.category),this.http.post(`${this.apiUrl}/${e.lessonId}/resources`,t,{responseType:"text"}).pipe(a(s=>{try{return JSON.parse(s)}catch{return{status:"success",message:s,data:{}}}}))}addTeacherComment(e,t,s){return this.http.post(`${this.apiUrl}/${e}/teacher-comments`,{content:t,type:s},{responseType:"text"}).pipe(a(r=>{try{return JSON.parse(r)}catch{return{status:"success",message:r,data:{}}}}))}deleteTeacherComment(e,t){return this.http.delete(`${this.apiUrl}/${e}/teacher-comments/${t}`,{responseType:"text"}).pipe(a(s=>{try{return JSON.parse(s)}catch{return{status:"success",message:s,data:{}}}}))}leaveLesson(e){return this.http.post(`${this.apiUrl}/${e}/leave`,{})}createConversation(e,t){return this.http.post(`${this.apiUrl}/${e}/conversations`,{title:t},{responseType:"text"}).pipe(a(s=>{try{return JSON.parse(s)}catch{return{status:"success",message:s,data:{}}}}))}sendMessageToConversation(e,t,s){return this.http.post(`${this.apiUrl}/${e}/conversations/${t}/messages`,{content:s},{responseType:"text"}).pipe(a(r=>{try{return JSON.parse(r)}catch{return{status:"success",message:r,data:{}}}}))}updateConversationMessage(e,t,s,r){return this.http.put(`${this.apiUrl}/${e}/conversations/${t}/messages/${s}`,{content:r},{responseType:"text"}).pipe(a(o=>{try{return JSON.parse(o)}catch{return{status:"success",message:o,data:{}}}}))}deleteConversationMessage(e,t,s){return this.http.delete(`${this.apiUrl}/${e}/conversations/${t}/messages/${s}`,{responseType:"text"}).pipe(a(r=>{try{return JSON.parse(r)}catch{return{status:"success",message:r,data:{}}}}))}static{this.\u0275fac=function(t){return new(t||p)(d($))}}static{this.\u0275prov=l({token:p,factory:p.\u0275fac,providedIn:"root"})}}return p})();export{L as a};
