import{a as Vt,b as Mt,c as ve}from"./chunk-ANDSCDB6.js";import{a as be}from"./chunk-TCGBOSDO.js";import{b as xe,c as Ut,d as Ot,e as St}from"./chunk-HD7OORPX.js";import{d as _e,f as he}from"./chunk-D2BCPON4.js";import{a as fe}from"./chunk-FGJ5GDKF.js";import{a as yt}from"./chunk-P5FOJTOO.js";import{a as de}from"./chunk-RHRI3TQF.js";import{a as Pt,b as me}from"./chunk-QSZSAD22.js";import"./chunk-4MSQXD5K.js";import{a as pe}from"./chunk-NZNPCDGT.js";import{a as ue,b as ge}from"./chunk-27IZBTZL.js";import"./chunk-MN65NYX4.js";import{a as oe,c as re,d as ae}from"./chunk-DEF5ACRI.js";import{a as ce}from"./chunk-GGPFJYSD.js";import{a as K}from"./chunk-5P7CLSZR.js";import{a as E}from"./chunk-43WXPJ7N.js";import{a as U}from"./chunk-L5TQBNKQ.js";import{A as Ct,B as ne,C as wt,b as te,c as _t,d as I,e as X,f as ht,k as Ft,l as ee,m as vt,p as ie,q as bt,r as xt}from"./chunk-GWDAXWU7.js";import{$b as k,Ba as Yt,Da as c,Ea as dt,Fa as S,Ga as Ht,H as q,Ha as N,Hb as ut,Ib as L,Jb as V,Na as o,Oa as r,Pa as p,Qa as Wt,R as O,Ra as Gt,Rb as gt,Sb as Q,Ta as b,Ua as h,Ub as Tt,Va as s,Vb as Kt,W as st,X as lt,Ya as P,Z as G,Za as kt,ab as mt,ac as se,ba as g,bb as pt,bc as T,ca as _,cb as ft,cc as Z,db as Y,dc as le,eb as l,ec as Lt,fb as x,g as Nt,ga as $t,gb as w,h as Rt,hb as D,ib as R,j as at,ja as Bt,jb as Jt,kb as Qt,lb as Xt,na as A,nb as J,ob as y,pa as a,pb as Zt,sa as v,t as $,ta as F,ua as ct,va as qt,vb as H,w as it,x as B,y as jt,ya as f}from"./chunk-3BHHYQXT.js";var Te=i=>["/perfil/",i,"editar"],Fe=()=>["/error","report-error"],Le=i=>({category:"user",reportedUserId:i}),Ve=(i,d)=>["/perfil/",i,d],Ce=()=>({scrollTo:"top"}),Ue=()=>({}),Ae=()=>({exact:!0}),De=i=>["/perfil/",i,"info"],ze=i=>["/perfil/",i,"publicaciones"];function Ne(i,d){i&1&&p(0,"img",60)}function Re(i,d){if(i&1&&p(0,"img",61),i&2){let t=s(2);c("src",t.url+"get-image-user/"+t.ownProfile.picture+"?v="+t.profilePicVersion,A)}}function je(i,d){if(i&1&&(o(0,"button",62),p(1,"i",63),l(2,"Editar perfil "),r()),i&2){let t=s(2);c("routerLink",y(1,Te,t.ownProfile._id))}}function $e(i,d){if(i&1){let t=b();o(0,"button",64),h("click",function(){g(t);let n=s(2);return _(n.followUser(n.ownProfile._id.toString()))}),p(1,"i",65),l(2,"Seguir "),r()}}function Be(i,d){i&1&&(o(0,"span"),p(1,"i",68),l(2,"Dejar de seguir "),r())}function qe(i,d){i&1&&(o(0,"span"),p(1,"i",69),l(2,"Siguiendo "),r())}function Ye(i,d){if(i&1){let t=b();o(0,"button",66),h("mouseenter",function(){g(t);let n=s(2);return _(n.mouseEnter(n.ownProfile._id.toString()))})("mouseleave",function(){g(t);let n=s(2);return _(n.mouseLeave())})("click",function(){g(t);let n=s(2);return _(n.openUnfollowModal(n.ownProfile._id.toString()))}),f(1,Be,3,0,"span",67)(2,qe,3,0,"ng-template",null,0,H),r()}if(i&2){let t=Y(3),e=s(2);S("btn-unfollow",e.ownProfile._id==e.followUserOver),a(),c("ngIf",e.ownProfile._id==e.followUserOver)("ngIfElse",t)}}function He(i,d){if(i&1&&(o(0,"a",70),p(1,"i",71),l(2,"Denunciar usuario "),r()),i&2){let t=s(2);c("routerLink",J(2,Fe))("queryParams",y(3,Le,t.ownProfile._id))}}function We(i,d){if(i&1&&(o(0,"span"),p(1,"i",72),l(2),r()),i&2){let t=s(2);Ht("badge role-badge role-"+t.ownProfile.role.toString().toLowerCase()+" "+t.getRoleClass(t.ownProfile.role.toString())),a(2),w("",t.getRoleLabel(t.ownProfile.role.toString())," ")}}function Ge(i,d){if(i&1&&(o(0,"p",73)(1,"small"),p(2,"i",74),l(3),r()()),i&2){let t=s(2);a(3),x(t.ownProfile.profession.name)}}function Je(i,d){if(i&1&&(o(0,"p",73)(1,"small"),p(2,"i",75),l(3),r()()),i&2){let t=s(2);a(3),x(t.ownProfile.institution.name)}}function Qe(i,d){if(i&1&&(o(0,"p",73)(1,"small"),p(2,"i",76),l(3),r()()),i&2){let t=s(2);a(3),R("",t.ownProfile.city.name,", ",t.ownProfile.city.state,", ",t.ownProfile.city.country,"")}}function Xe(i,d){if(i&1&&(o(0,"li",77)(1,"a",78),p(2,"i"),l(3),r()()),i&2){let t=d.$implicit,e=s(2);a(),c("routerLink",Zt(7,Ve,e.ownProfile==null?null:e.ownProfile._id,t.value))("queryParams",t.value==="publicaciones"?J(10,Ce):J(11,Ue))("routerLinkActiveOptions",J(12,Ae)),a(),N("",t.icon," me-2"),a(),w("",t.name," ")}}function Ze(i,d){if(i&1&&(o(0,"p",90)(1,"span"),l(2),r()()),i&2){let t=d.$implicit;S("mb-0",t===""),a(2),x(t)}}function Ke(i,d){if(i&1){let t=b();o(0,"button",91),h("click",function(){g(t);let n=s(3);return _(n.toggleAbout())}),p(1,"i",92),l(2),r()}if(i&2){let t=s(3);a(),S("fa-expand-alt",!t.aboutExpanded)("fa-compress-alt",t.aboutExpanded),a(),w(" ",t.aboutExpanded?"Mostrar menos":"Mostrar m\xE1s"," ")}}function ti(i,d){if(i&1&&(o(0,"div",79)(1,"div",80)(2,"h6",81),p(3,"i",82),l(4,"Acerca de "),r()(),o(5,"div",83)(6,"div",84),f(7,Ze,3,3,"p",85),r(),o(8,"div",86),f(9,Ke,3,5,"button",87),o(10,"button",88),p(11,"i",89),l(12,"Informaci\xF3n completa "),r()()()()),i&2){let t=s(2);a(6),S("expanded",t.aboutExpanded),a(),c("ngForOf",(t.aboutExpanded?(t.ownProfile==null?null:t.ownProfile.about)||"":t.about||"").split(`
`)),a(2),c("ngIf",t.ownProfile.about&&t.ownProfile.about.length>200),a(),c("routerLink",y(5,De,t.ownProfile._id))}}function ei(i,d){if(i&1&&(o(0,"div",95)(1,"a",96),p(2,"i",97),o(3,"span",98),l(4),r()()()),i&2){let t=d.$implicit,e=s(3);a(),c("href",e.formatLink(t),A)("title","Visitar "+t.trim()),a(3),x(t.trim())}}function ii(i,d){if(i&1&&(o(0,"div",79)(1,"div",80)(2,"h6",81),p(3,"i",93),l(4,"Redes sociales "),r()(),o(5,"div",83),f(6,ei,5,3,"div",94),r()()),i&2){let t=s(2);a(6),c("ngForOf",t.getSocialLinks(t.ownProfile.socialNetworks))}}function ni(i,d){i&1&&(o(0,"div",79)(1,"div",99)(2,"h6",81),p(3,"i",100),l(4,"Informaci\xF3n restringida "),r()(),o(5,"div",83)(6,"p",81),l(7,"Debes tener una cuenta activa para ver los detalles del perfil."),r()()())}function oi(i,d){if(i&1&&(o(0,"button",101),p(1,"i",102),r()),i&2){let t=s(2);c("routerLink",y(2,ze,t.ownProfile==null?null:t.ownProfile._id))("queryParams",J(4,Ce))}}function ri(i,d){if(i&1){let t=b();o(0,"div",14)(1,"section",15)(2,"div",16)(3,"div",17)(4,"div",18)(5,"div",19)(6,"div",20)(7,"div",21)(8,"div",22)(9,"div",23),f(10,Ne,1,0,"img",24)(11,Re,1,1,"img",25),r(),o(12,"div",26),f(13,je,3,3,"button",27)(14,$e,3,0,"button",28)(15,Ye,4,4,"button",29)(16,He,3,5,"a",30),r()(),o(17,"div",31)(18,"div",32)(19,"h2",33)(20,"strong"),l(21),r()(),o(22,"div",34),f(23,We,3,3,"span",35),r(),o(24,"div",36),f(25,Ge,4,1,"p",37)(26,Je,4,1,"p",37)(27,Qe,4,3,"p",37),r()()(),o(28,"div",38)(29,"div",39)(30,"div",40)(31,"div",41),h("click",function(){g(t);let n=s();return _(n.goToPublications())}),o(32,"div",42),l(33),r(),o(34,"div",43),l(35,"Publicaciones"),r()()(),o(36,"div",40)(37,"div",44),h("click",function(){g(t);let n=s();return _(n.goToLessons())}),o(38,"div",42),l(39),r(),o(40,"div",43),l(41,"Lecciones"),r()()(),o(42,"div",40)(43,"div",45),h("click",function(){g(t);let n=s();return _(n.showFollowers())}),o(44,"div",42),l(45),r(),o(46,"div",43),l(47,"Seguidores"),r()()(),o(48,"div",40)(49,"div",46),h("click",function(){g(t);let n=s();return _(n.showFollowing())}),o(50,"div",42),l(51),r(),o(52,"div",43),l(53,"Siguiendo"),r()()()()()()()()()()()(),o(54,"section",47)(55,"nav",48)(56,"div",49)(57,"ul",50),f(58,Xe,4,13,"li",51),r()()()(),o(59,"section",52)(60,"div",53)(61,"div",54)(62,"div",55),f(63,ti,13,7,"div",56)(64,ii,7,1,"div",56)(65,ni,8,0,"div",56),r()(),o(66,"div",57)(67,"div",58),p(68,"router-outlet"),r()()()(),f(69,oi,2,5,"button",59),r()}if(i&2){let t=s();a(10),c("ngIf",!(t.ownProfile!=null&&t.ownProfile.picture)),a(),c("ngIf",t.ownProfile==null?null:t.ownProfile.picture),a(2),c("ngIf",(t.identity==null?null:t.identity._id)==(t.ownProfile==null?null:t.ownProfile._id)),a(),c("ngIf",(t.identity==null?null:t.identity._id)!=(t.ownProfile==null?null:t.ownProfile._id)&&!t.following),a(),c("ngIf",(t.identity==null?null:t.identity._id)!=(t.ownProfile==null?null:t.ownProfile._id)&&t.following),a(),c("ngIf",(t.identity==null?null:t.identity._id)!=(t.ownProfile==null?null:t.ownProfile._id)),a(5),D("",t.ownProfile==null?null:t.ownProfile.name," ",t.ownProfile==null?null:t.ownProfile.surname,""),a(2),c("ngIf",(t.ownProfile==null?null:t.ownProfile.role)&&t.hasRoleCategory(t.ownProfile.role.toString())),a(2),c("ngIf",t.ownProfile==null?null:t.ownProfile.profession),a(),c("ngIf",t.ownProfile==null?null:t.ownProfile.institution),a(),c("ngIf",t.ownProfile==null?null:t.ownProfile.city),a(6),x((t.counters==null?null:t.counters.publications)||0),a(6),x((t.counters==null?null:t.counters.lessons)||0),a(6),x((t.counters==null?null:t.counters.followed)||0),a(6),x((t.counters==null?null:t.counters.following)||0),a(4),S("navbar-light",!0)("bg-white",!0)("navbar-dark",!1)("bg-dark",!1),a(3),c("ngForOf",t.menuOptions),a(5),c("ngIf",(t.ownProfile==null?null:t.ownProfile.about)&&((t.identity==null?null:t.identity._id)===(t.ownProfile==null?null:t.ownProfile._id)||(t.identity==null?null:t.identity.actived)===!0)),a(),c("ngIf",(t.ownProfile==null?null:t.ownProfile.socialNetworks)&&((t.identity==null?null:t.identity._id)===(t.ownProfile==null?null:t.ownProfile._id)||(t.identity==null?null:t.identity.actived)===!0)),a(),c("ngIf",!((t.identity==null?null:t.identity._id)===(t.ownProfile==null?null:t.ownProfile._id)||(t.identity==null?null:t.identity.actived)===!0)),a(4),c("ngIf",t.shouldShowFloatingButton())}}function ai(i,d){i&1&&(o(0,"div",106)(1,"span",107),l(2,"Cargando..."),r()())}function si(i,d){if(i&1){let t=b();o(0,"div",108)(1,"h4"),l(2,"Error al cargar el perfil"),r(),o(3,"p"),l(4,"No se pudo cargar la informaci\xF3n del usuario. Por favor, int\xE9ntalo de nuevo."),r(),o(5,"button",109),h("click",function(){g(t);let n=s(2);return _(n.loadPage())}),l(6,"Reintentar"),r()()}}function li(i,d){if(i&1&&(o(0,"div",14)(1,"div",103),f(2,ai,3,0,"div",104)(3,si,7,0,"div",105),r()()),i&2){let t=s();a(2),c("ngIf",!t.status),a(),c("ngIf",t.status==="error")}}var we=(()=>{class i{constructor(t,e,n,m){this._userService=t,this._router=e,this._route=n,this._followService=m,this.title="Perfil",this.ownProfile=new K,this.about="",this.aboutExpanded=!1,this.followUserOver=null,this.tempUserId=null,this.url=U.url,this.token=t.getToken(),this.menuOptions=xe,this.categories=St,this.counters={following:0,followed:0,publications:0,lessons:0},this.profilePicVersion=new Date().getTime(),this.loadPage()}ngOnInit(){if(this.identity=this._userService.getIdentity(),!this.identity||!this.token){console.log("No hay usuario autenticado, redirigiendo a home"),this._router.navigate(["/"]);return}this.loadPage(),this.identitySubscription=this._userService.identityChanged.subscribe(t=>{t&&this.identity&&t._id===this.identity._id&&(this.ownProfile=t)}),this.profilePicUpdateSubscription=this._userService.profilePictureUpdated.subscribe(()=>{console.log("Profile picture updated event received in ProfileComponent, updating version."),this.profilePicVersion=new Date().getTime(),this._route.params.subscribe(e=>{let n=e.id;n&&this.getUser(n)});let t=this._userService.getIdentity();t&&this.identity&&t._id===this.identity._id&&(this.ownProfile=t)})}ngOnDestroy(){this.identitySubscription&&this.identitySubscription.unsubscribe(),this.profilePicUpdateSubscription&&this.profilePicUpdateSubscription.unsubscribe()}ngDoCheck(){this._route.params.subscribe(t=>{let e=t.id;this.identity._id==e&&(this.ownProfile=this._userService.getIdentity())})}getRoleClass(t){return this.categories&&this.categories[t]?this.categories[t].class:""}getRoleLabel(t){return this.categories&&this.categories[t]?this.categories[t].label:""}hasRoleCategory(t){return!!(this.categories&&this.categories[t])}loadPage(){if(this.identity=this._userService.getIdentity(),!this.identity||!this.token){console.log("No hay usuario autenticado en loadPage, redirigiendo a home"),this._router.navigate(["/"]);return}this._route.params.subscribe(t=>{let e=t.id;if(!e){console.log("No se proporcion\xF3 ID de usuario, redirigiendo al perfil propio"),this._router.navigate(["/perfil",this.identity._id]);return}this.getUser(e)})}getUser(t){this._userService.getUser(t).subscribe({next:e=>{e.user?(this.following=e.following,this.follower=e.follower,this.ownProfile=e.user,this.ownProfile.about?(this.about=this.ownProfile.about.toString(),this.about=this.truncateChar(this.about)):this.about="",this.getCounters(t)):(console.log("Usuario no encontrado, redirigiendo al perfil propio"),this.status="error",this.ownProfile=this.identity,this._router.navigate(["/perfil/"+this.identity._id]))},error:e=>{console.log("Error en profile: ",e),this.ownProfile=this.identity,this._router.navigate(["/perfil/"+this.identity._id])}})}truncateChar(t){let e=200;return!t||t.length<=e?t:t.replace(/<(?:.|\n)*?>/gm,"").substring(0,e)+"..."}getCounters(t){this._userService.getCounters(t).subscribe({next:e=>{e?this.identity._id!=t?(localStorage.setItem("ownProfileStats",JSON.stringify(e)),this.counters=JSON.parse(localStorage.getItem("ownProfileStats"))):(localStorage.setItem("stats",JSON.stringify(e)),this.counters=JSON.parse(localStorage.getItem("stats"))):(this.status="error",this.ownProfile=this.identity)},error:e=>{console.log(e),this.ownProfile=this.identity,this._router.navigate(["/perfil/"+this.identity._id])}})}followUser(t){let e={followed:t};this._followService.addFollow(this.token,e).subscribe({next:n=>{n.follow&&(this.following=n.follow,this.counters.followed=this.counters.followed+1)},error:n=>{console.log(n)}})}unfollowUser(t){this._followService.removeFollow(this.token,t).subscribe({next:e=>{e.follow&&(this.following=null,this.counters.followed=Math.max(0,this.counters.followed-1))},error:e=>{console.log(e)}})}mouseEnter(t){this.followUserOver=t}mouseLeave(){this.followUserOver=null}getus(t){this.tempUserId=t}unfollow(){this.tempUserId&&(this.unfollowUser(this.tempUserId),this.tempUserId=null)}showFollowing(){this._router.navigate(["/perfil",this.ownProfile._id.toString(),"red"],{queryParams:{tab:"following"}}),console.log("Navegando a usuarios seguidos"),setTimeout(()=>{this.scrollToContent()},300)}showFollowers(){this._router.navigate(["/perfil",this.ownProfile._id.toString(),"red"],{queryParams:{tab:"followers"}}),console.log("Navegando a seguidores"),setTimeout(()=>{this.scrollToContent()},300)}goToPublications(){this._router.navigate(["/perfil",this.ownProfile._id.toString(),"publicaciones"]),console.log("Navegando a publicaciones"),setTimeout(()=>{this.scrollToContent()},300)}goToLessons(){this._router.navigate(["/perfil",this.ownProfile._id.toString(),"lecciones"]),console.log("Navegando a lecciones"),setTimeout(()=>{this.scrollToContent()},300)}getus_old(t){this.TempU=t}isOnPublications(){let t=this._router.url;return t.includes("/publicaciones")||t.endsWith("/"+this.ownProfile._id)}shouldShowFloatingButton(){let t=this._router.url;return t.includes("/lecciones")||t.includes("/info")||t.includes("/red")||t.includes("/editar")}updateProfilePictureVersion(){this.profilePicVersion=new Date().getTime(),console.log("Profile picture version updated to:",this.profilePicVersion)}reloadProfile(){this._route.params.subscribe(t=>{let e=t.id;e&&(this.getUser(e),this.updateProfilePictureVersion())})}scrollToContent(){let t=document.getElementById("content");t?t.scrollIntoView({behavior:"smooth",block:"start"}):window.scrollTo({top:window.innerHeight*.8,behavior:"smooth"})}toggleAbout(){this.aboutExpanded=!this.aboutExpanded}getSocialLinks(t){return t?t.toString().split(";").map(n=>n.trim()).filter(n=>n.length>0):[]}formatLink(t){if(!t)return"";let e=t.trim();return e.startsWith("http://")||e.startsWith("https://")?e:"https://"+e}openUnfollowModal(t){this.getus(t),setTimeout(()=>{try{let e=document.getElementById("unfollowus");if(e){let n=window.bootstrap?.Modal?.getInstance(e);n&&n.dispose(),new window.bootstrap.Modal(e,{backdrop:"static",keyboard:!1}).show()}}catch(e){console.log("Error al abrir modal de dejar de seguir:",e)}},0)}static{this.\u0275fac=function(e){return new(e||i)(v(E),v(T),v(k),v(yt))}}static{this.\u0275cmp=F({type:i,selectors:[["profile"]],standalone:!1,decls:18,vars:2,consts:[["followingTemplate",""],["class","container",4,"ngIf"],["id","unfollowus","tabindex","-1","role","dialog","aria-labelledby","unfollowUsuario","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","unfollowUsr",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],["role","alert",1,"alert","alert-warning","mb-0"],[1,"fas","fa-exclamation-triangle","icon-message","me-2"],[1,"modal-footer"],["data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"],["data-bs-dismiss","modal",1,"btn","btn-primary","text-white"],[1,"container"],["id","profile"],[1,"container-fluid","card","rounded","overflow-hidden","bg-white","profile-header-card"],[1,"row","bg-primary"],[1,"col"],[1,"card","border-0"],[1,"card-body","bg-primary","p-4"],[1,"row","align-items-center","justify-content-center"],[1,"col-lg-3","col-md-3","text-center"],[1,"profile-picture-container-compact"],["class","profile-picture-compact","src","assets/images/user-default.png","alt","Imagen por defecto",4,"ngIf"],["class","profile-picture-compact","alt","Foto de perfil",3,"src",4,"ngIf"],[1,"mt-3"],["class","btn btn-danger btn-profile-action-compact",3,"routerLink",4,"ngIf"],["class","btn btn-follow-primary btn-profile-action-compact",3,"click",4,"ngIf"],["type","button","class","btn btn-following btn-profile-action-compact",3,"btn-unfollow","mouseenter","mouseleave","click",4,"ngIf"],["class","btn btn-outline-warning btn-profile-action-compact mt-2","title","Denunciar usuario",3,"routerLink","queryParams",4,"ngIf"],[1,"col-lg-5","col-md-5","text-center","text-lg-start"],[1,"profile-info-compact","text-white"],[1,"text-white","text-capitalize","mb-2"],[1,"mb-3"],[3,"class",4,"ngIf"],[1,"profile-professional-info-compact"],["class","mb-1",4,"ngIf"],[1,"col-lg-4","col-md-4"],[1,"row","text-white","counters-compact","justify-content-center"],[1,"col-6","mb-3"],["title","Ver publicaciones",1,"counter-compact","text-center",3,"click"],[1,"counter-number-compact"],[1,"counter-label-compact"],["title","Ver lecciones",1,"counter-compact","text-center",3,"click"],["title","Ver seguidores",1,"counter-compact","text-center",3,"click"],["title","Ver siguiendo",1,"counter-compact","text-center",3,"click"],["id","menu",1,"mt-0"],[1,"navbar","navbar-expand-lg","rounded","profile-menu-nav",2,"border","1px solid #dee2e6"],[1,"container-fluid"],[1,"navbar-nav","me-auto","mb-2","mb-lg-0","w-100","justify-content-around",2,"justify-content","space-evenly"],["class","nav-item",4,"ngFor","ngForOf"],["id","content",1,"mt-0"],[1,"row"],[1,"col-lg-4","col-md-5"],[1,"profile-sidebar"],["class","card mb-3",4,"ngIf"],[1,"col-lg-8","col-md-7"],[1,"profile-content"],["class","btn floating-publications-btn position-fixed rounded-circle shadow-lg d-flex align-items-center justify-content-center","title","Volver a publicaciones",3,"routerLink","queryParams",4,"ngIf"],["src","assets/images/user-default.png","alt","Imagen por defecto",1,"profile-picture-compact"],["alt","Foto de perfil",1,"profile-picture-compact",3,"src"],[1,"btn","btn-danger","btn-profile-action-compact",3,"routerLink"],[1,"fas","fa-edit","me-2"],[1,"btn","btn-follow-primary","btn-profile-action-compact",3,"click"],[1,"fas","fa-user-plus","me-2"],["type","button",1,"btn","btn-following","btn-profile-action-compact",3,"mouseenter","mouseleave","click"],[4,"ngIf","ngIfElse"],[1,"fas","fa-user-minus","me-2"],[1,"fas","fa-user-check","me-2"],["title","Denunciar usuario",1,"btn","btn-outline-warning","btn-profile-action-compact","mt-2",3,"routerLink","queryParams"],[1,"fas","fa-exclamation-triangle","me-2"],[1,"fas","fa-user-tag","me-1"],[1,"mb-1"],[1,"fas","fa-briefcase","me-2"],[1,"fas","fa-university","me-2"],[1,"fas","fa-map-marker-alt","me-2"],[1,"nav-item"],["routerLinkActive","active",1,"nav-link",3,"routerLink","queryParams","routerLinkActiveOptions"],[1,"card","mb-3"],[1,"card-header","bg-info","text-white"],[1,"mb-0"],[1,"fas","fa-user-circle","me-2"],[1,"card-body"],[1,"profile-about-content"],["class","text-break mb-1 lh-sm",3,"mb-0",4,"ngFor","ngForOf"],[1,"mt-2","d-flex","justify-content-between"],["class","btn btn-sm btn-outline-primary",3,"click",4,"ngIf"],["title","Ver informaci\xF3n completa del perfil",1,"btn","btn-sm","btn-info",3,"routerLink"],[1,"fas","fa-info-circle","me-1"],[1,"text-break","mb-1","lh-sm"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"me-1"],[1,"fas","fa-share-alt","me-2"],["class","social-link-item mb-2",4,"ngFor","ngForOf"],[1,"social-link-item","mb-2"],["target","_blank",1,"text-decoration-none","text-primary","d-flex","align-items-center","p-2","border","rounded","bg-light",3,"href","title"],[1,"fas","fa-external-link-alt","me-2"],[1,"text-truncate"],[1,"card-header","bg-warning","text-dark"],[1,"fas","fa-lock","me-2"],["title","Volver a publicaciones",1,"btn","floating-publications-btn","position-fixed","rounded-circle","shadow-lg","d-flex","align-items-center","justify-content-center",3,"routerLink","queryParams"],[1,"fas","fa-newspaper","fa-lg"],[1,"text-center","mt-5"],["class","spinner-border text-primary","role","status",4,"ngIf"],["class","alert alert-danger mt-3",4,"ngIf"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"alert","alert-danger","mt-3"],[1,"btn","btn-primary",3,"click"]],template:function(e,n){e&1&&(f(0,ri,70,29,"div",1)(1,li,4,2,"div",1),o(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h5",6),l(7,"Dejar de seguir a esta persona"),r(),p(8,"button",7),r(),o(9,"div",8)(10,"div",9),p(11,"i",10),l(12," No ver\xE1s sus publicaciones ni su actividad en el inicio de Reddin\xE1mica, \xBFdeseas continuar? "),r()(),o(13,"div",11)(14,"button",12),h("click",function(){return n.unfollow()}),l(15,"S\xED"),r(),o(16,"button",13),l(17,"No"),r()()()()()),e&2&&(c("ngIf",n.identity&&n.ownProfile),a(),c("ngIf",!n.identity||!n.ownProfile))},dependencies:[L,V,se,Z,le],styles:['#red[_ngcontent-%COMP%]{cursor:pointer}.profile-picture-large-container[_ngcontent-%COMP%]{width:168px;height:168px;margin:0 auto;display:flex;align-items:center;justify-content:center;border-radius:50%;overflow:hidden;border:4px solid white;box-shadow:0 4px 12px #00000026;flex-shrink:0}.profile-picture-large[_ngcontent-%COMP%]{width:168px;height:168px;object-fit:cover;object-position:center;display:block;flex-shrink:0}.profile-picture-large-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{min-width:168px;min-height:168px}.profile-picture-row[_ngcontent-%COMP%]{padding-left:0!important;padding-right:0!important;display:flex;justify-content:center;align-items:center}ul.social-links[_ngcontent-%COMP%]{list-style-type:none}#profileMenu[_ngcontent-%COMP%]{position:sticky;top:62px;width:253px}.div-about-more[_ngcontent-%COMP%]{cursor:pointer;touch-action:manipulation}#div-container[_ngcontent-%COMP%]{display:flex;font-size:20px;line-height:normal;font-size:18px;height:140px;max-height:140px;max-width:500px}#div-aboutP[_ngcontent-%COMP%]{display:-webkit-box;overflow:hidden;-webkit-line-clamp:3;-webkit-box-orient:vertical}#div-social[_ngcontent-%COMP%]{margin-top:1.5%;margin-left:1.5%;margin-right:3%;height:90px;overflow:hidden}.showMore[_ngcontent-%COMP%]{margin:0;padding:0 0 0 10px;background-color:transparent;border-width:0;outline-width:0;font-size:14px;color:#3f8f7b;position:absolute;bottom:15px;right:0;cursor:pointer}@media screen and (max-width: 575.98px){.profile-picture-large-container[_ngcontent-%COMP%]{width:7rem;height:7rem;border:3px solid white}.profile-picture-large[_ngcontent-%COMP%]{width:7rem;height:7rem}.profile-picture-large-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{min-width:7rem;min-height:7rem}}@media screen and (min-width: 576px) and (max-width: 767.98px){.profile-picture-large-container[_ngcontent-%COMP%]{width:8rem;height:8rem;border:3px solid white}.profile-picture-large[_ngcontent-%COMP%]{width:8rem;height:8rem}.profile-picture-large-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{min-width:8rem;min-height:8rem}}@media screen and (min-width: 768px){.profile-picture-large-container[_ngcontent-%COMP%]{width:10.5rem;height:10.5rem;border:4px solid white}.profile-picture-large[_ngcontent-%COMP%]{width:10.5rem;height:10.5rem}.profile-picture-large-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{min-width:10.5rem;min-height:10.5rem}}.profile-about-section[_ngcontent-%COMP%]{line-height:1.6;color:#495057}.profile-about-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:.5rem}.social-networks-section[_ngcontent-%COMP%]{margin-top:1rem}.social-link-item[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.social-link-item[_ngcontent-%COMP%]:hover{background-color:#e9ecef!important;transform:translateY(-1px);box-shadow:0 2px 4px #0000001a}.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#007bff!important;font-size:.9rem}.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#0056b3!important}.comment-thread[_ngcontent-%COMP%]{border-left:3px solid #e9ecef;padding-left:.5rem;margin-left:.5rem}.comment-text[_ngcontent-%COMP%], .reply-text[_ngcontent-%COMP%]{line-height:1.5;word-wrap:break-word;overflow-wrap:break-word}.comment-actions[_ngcontent-%COMP%], .reply-actions[_ngcontent-%COMP%]{border-top:1px solid #dee2e6;padding-top:.5rem;margin-top:.5rem}.comment-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%], .reply-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{font-size:.8rem;padding:.25rem .5rem}.replies-section[_ngcontent-%COMP%]{border-left:2px solid #dee2e6;padding-left:1rem}.interaction-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:20px;font-size:.85rem;padding:.375rem .75rem;transition:all .2s ease-in-out}.interaction-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 2px 4px #0000001a}.sort-options[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{font-size:.75rem;padding:.25rem .5rem}.btn.position-fixed[_ngcontent-%COMP%]{transition:all .3s ease-in-out;box-shadow:0 4px 12px #007bff4d}.btn.position-fixed[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 16px #007bff66}.reply-form[_ngcontent-%COMP%]{background-color:#f8f9fa;border-radius:.5rem;padding:1rem;margin-top:.5rem}.invalid-feedback[_ngcontent-%COMP%], .invalid-feedback-select[_ngcontent-%COMP%]{display:block;background-color:#f8d7da;border:1px solid #f5c6cb;border-radius:.375rem;padding:.5rem;margin-top:.25rem;color:#721c24;font-size:.875rem}.btn-profile-action[_ngcontent-%COMP%]{border-radius:25px;padding:10px 20px;font-weight:600;border:2px solid transparent;transition:all .3s ease-in-out;box-shadow:0 2px 8px #0000001a;min-width:140px}.btn-follow-primary[_ngcontent-%COMP%]{background:linear-gradient(45deg,#007bff,#0056b3);border:2px solid #007bff;color:#fff}.btn-follow-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(45deg,#0056b3,#004085);border-color:#0056b3;transform:translateY(-2px);box-shadow:0 4px 12px #007bff4d;color:#fff}.btn-following[_ngcontent-%COMP%]{background:linear-gradient(45deg,#28a745,#20c997);border:2px solid #28a745;color:#fff}.btn-following[_ngcontent-%COMP%]:hover{background:linear-gradient(45deg,#20c997,#17a2b8);border-color:#20c997;transform:translateY(-2px);box-shadow:0 4px 12px #28a7454d;color:#fff}.btn-unfollow[_ngcontent-%COMP%]{background:linear-gradient(45deg,#dc3545,#c82333)!important;border-color:#dc3545!important;color:#fff!important;transform:translateY(-2px);box-shadow:0 4px 12px #dc35454d}.btn-profile-action[_ngcontent-%COMP%]:active{transform:translateY(0)}.counter-clickable[_ngcontent-%COMP%]{cursor:pointer;padding:15px 10px;border-radius:15px;transition:all .3s ease-in-out;position:relative;overflow:hidden}.counter-clickable[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:#fff0;transition:all .3s ease-in-out;border-radius:15px}.counter-clickable[_ngcontent-%COMP%]:hover:before{background:#ffffff26}.counter-clickable[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 4px 15px #0003}.counter-clickable[_ngcontent-%COMP%]:active{transform:scale(.98)}.counter-number[_ngcontent-%COMP%]{font-size:2.2rem;font-weight:700;margin-bottom:8px;transition:all .3s ease-in-out}.counter-label[_ngcontent-%COMP%]{font-size:1rem;font-weight:500;text-transform:uppercase;letter-spacing:.5px;transition:all .3s ease-in-out}.counter-clickable[_ngcontent-%COMP%]:hover   .counter-number[_ngcontent-%COMP%]{font-size:2.5rem;text-shadow:0 2px 4px rgba(0,0,0,.3)}.counter-clickable[_ngcontent-%COMP%]:hover   .counter-label[_ngcontent-%COMP%]{font-weight:600;text-shadow:0 1px 2px rgba(0,0,0,.3);font-size:1.1rem}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1)}50%{transform:scale(1.02)}to{transform:scale(1)}}.counter-clickable[_ngcontent-%COMP%]:hover{animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_clickEffect{0%{transform:scale(1)}50%{transform:scale(.95)}to{transform:scale(1)}}.counter-clickable[_ngcontent-%COMP%]:active{animation:_ngcontent-%COMP%_clickEffect .2s ease-in-out;transform:scale(.95)}html[_ngcontent-%COMP%]{scroll-behavior:smooth}#content[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.content-focused[_ngcontent-%COMP%]{box-shadow:0 0 20px #007bff4d;border-radius:10px;transition:all .5s ease-in-out}.profile-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2.5rem!important;font-weight:800!important;margin-bottom:10px!important;text-shadow:0 2px 4px rgba(0,0,0,.3)}.profile-header[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:1rem!important;padding:8px 16px!important}.profile-professional-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1rem!important;margin-bottom:8px!important}.profile-professional-info[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:1rem!important}.profile-sidebar[_ngcontent-%COMP%]{position:sticky;top:121px;max-height:calc(100vh - 140px);overflow-y:auto;z-index:98}.profile-content[_ngcontent-%COMP%]{min-height:500px}.profile-about-content[_ngcontent-%COMP%]{max-height:150px;overflow:hidden;transition:max-height .3s ease-in-out}.profile-about-content.expanded[_ngcontent-%COMP%]{max-height:none;overflow:visible}.profile-sidebar[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border:none;box-shadow:0 2px 8px #0000001a;transition:all .3s ease-in-out}.profile-sidebar[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026;transform:translateY(-2px)}.profile-sidebar[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{border-bottom:none;font-weight:600}.profile-sidebar[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem}.profile-sidebar[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:20px;font-size:.85rem;transition:all .3s ease-in-out}.profile-sidebar[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 2px 8px #0003}@media (max-width: 768px){.profile-sidebar[_ngcontent-%COMP%]{position:static;max-height:none;margin-bottom:2rem}.profile-about-content[_ngcontent-%COMP%]{max-height:120px}}@keyframes _ngcontent-%COMP%_expandContent{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.profile-about-content.expanded[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:nth-child(n+4){animation:_ngcontent-%COMP%_expandContent .3s ease-in-out}.social-links-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{transition:all .3s ease;border-radius:8px;padding:12px 16px;text-decoration:none;display:flex;align-items:center;background:linear-gradient(135deg,#007bff,#0056b3);border:1px solid #007bff;color:#fff;font-weight:500}.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#0056b3,#004085);color:#fff;transform:translateY(-2px);box-shadow:0 4px 12px #007bff66;border-color:#0056b3}.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;font-size:.9rem;margin-right:8px;transition:color .3s ease}.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:#fff}.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.9rem;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:#fff}.card[_ngcontent-%COMP%]   .social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{background:linear-gradient(135deg,#007bff,#0056b3);border:2px solid #007bff;padding:14px 18px;border-radius:10px;font-weight:600;color:#fff}.card[_ngcontent-%COMP%]   .social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#0056b3,#004085);border-color:#0056b3;box-shadow:0 6px 16px #007bff66}.card[_ngcontent-%COMP%]   .social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;font-size:1rem}.card[_ngcontent-%COMP%]   .social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff}@media (max-width: 768px){.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{max-width:150px}.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:10px 14px;font-size:.85rem}}.profile-header-card[_ngcontent-%COMP%]{min-height:auto!important;margin-top:40px!important;margin-bottom:20px!important}.container[_ngcontent-%COMP%]{padding-top:50px;margin-top:20px}.profile-picture-container-compact[_ngcontent-%COMP%]{width:168px;height:168px;margin:0 auto;display:flex;align-items:center;justify-content:center;border-radius:50%;overflow:hidden;border:4px solid white;box-shadow:0 4px 12px #00000026;flex-shrink:0}.profile-picture-compact[_ngcontent-%COMP%]{width:168px;height:168px;object-fit:cover;object-position:center;display:block;flex-shrink:0}.btn-profile-action-compact[_ngcontent-%COMP%]{border-radius:20px;padding:8px 16px;font-weight:600;border:2px solid transparent;transition:all .3s ease-in-out;box-shadow:0 2px 8px #0000001a;font-size:.9rem}.profile-info-compact[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.8rem!important;font-weight:700!important;margin-bottom:8px!important;text-shadow:0 2px 4px rgba(0,0,0,.3)}.profile-professional-info-compact[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.95rem!important;margin-bottom:4px!important;opacity:.9}.profile-professional-info-compact[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.9rem!important}.counters-compact[_ngcontent-%COMP%]{padding:0 10px}.counter-compact[_ngcontent-%COMP%]{cursor:pointer;padding:12px 8px;border-radius:12px;transition:all .3s ease-in-out;position:relative;overflow:hidden;background:#ffffff1a;border:1px solid rgba(255,255,255,.2)}.counter-compact[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:#fff0;transition:all .3s ease-in-out;border-radius:12px}.counter-compact[_ngcontent-%COMP%]:hover:before{background:#ffffff26}.counter-compact[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 15px #0003;border-color:#fff6}.counter-compact[_ngcontent-%COMP%]:active{transform:translateY(0)}.counter-number-compact[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;margin-bottom:4px;transition:all .3s ease-in-out;color:#fff}.counter-label-compact[_ngcontent-%COMP%]{font-size:.75rem;font-weight:500;text-transform:uppercase;letter-spacing:.5px;transition:all .3s ease-in-out;color:#ffffffe6;line-height:1.2}.counter-compact[_ngcontent-%COMP%]:hover   .counter-number-compact[_ngcontent-%COMP%]{font-size:1.7rem;text-shadow:0 2px 4px rgba(0,0,0,.3)}.counter-compact[_ngcontent-%COMP%]:hover   .counter-label-compact[_ngcontent-%COMP%]{font-weight:600;text-shadow:0 1px 2px rgba(0,0,0,.3);color:#fff}.role-badge[_ngcontent-%COMP%]{border:2px solid rgba(255,255,255,.3)!important;padding:8px 16px!important;font-size:.9rem!important;font-weight:600!important;border-radius:25px!important;box-shadow:0 2px 8px #0003!important;transition:all .3s ease!important;backdrop-filter:blur(5px)}.role-badge[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #0000004d!important}.role-badge.role-student[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28a745,#20c997)!important;border-color:#28a745!important;color:#fff!important}.role-badge.role-teacher[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6f42c1,#5a2d91)!important;border-color:#6f42c1!important;color:#fff!important}.role-badge.role-expert[_ngcontent-%COMP%]{background:linear-gradient(135deg,#007bff,#0056b3)!important;border-color:#007bff!important;color:#fff!important}.role-badge.role-guest[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fd7e14,#e55a00)!important;border-color:#fd7e14!important;color:#fff!important}.role-badge.role-admin[_ngcontent-%COMP%], .role-badge.role-delegated_admin[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dc3545,#c82333)!important;border-color:#dc3545!important;color:#fff!important}.role-badge[_ngcontent-%COMP%]:not(.role-student):not(.role-teacher):not(.role-expert):not(.role-guest):not(.role-admin):not(.role-delegated_admin){background:linear-gradient(135deg,#17a2b8,#138496)!important;border-color:#17a2b8!important;color:#fff!important}@media (max-width: 992px){.profile-picture-container-compact[_ngcontent-%COMP%], .profile-picture-compact[_ngcontent-%COMP%]{width:140px;height:140px}.profile-info-compact[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem!important}.counter-number-compact[_ngcontent-%COMP%]{font-size:1.3rem}.counter-label-compact[_ngcontent-%COMP%]{font-size:.7rem}.role-badge[_ngcontent-%COMP%]{font-size:.8rem!important;padding:6px 12px!important}}@media (max-width: 768px){.profile-header-card[_ngcontent-%COMP%]   .row.align-items-center[_ngcontent-%COMP%]{text-align:center}.profile-picture-container-compact[_ngcontent-%COMP%]{width:112px;height:112px;margin-bottom:15px}.profile-picture-compact[_ngcontent-%COMP%]{width:112px;height:112px}.profile-info-compact[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.3rem!important;text-align:center}.profile-professional-info-compact[_ngcontent-%COMP%]{text-align:center}.counters-compact[_ngcontent-%COMP%]{margin-top:20px;justify-content:center!important}.counter-compact[_ngcontent-%COMP%]{padding:8px 4px;margin:0 5px}.counter-number-compact[_ngcontent-%COMP%]{font-size:1.2rem}.counter-label-compact[_ngcontent-%COMP%]{font-size:.65rem}.role-badge[_ngcontent-%COMP%]{font-size:.75rem!important;padding:5px 10px!important;margin:0 auto;display:inline-block}.profile-header-card[_ngcontent-%COMP%]   .col-lg-3[_ngcontent-%COMP%], .profile-header-card[_ngcontent-%COMP%]   .col-lg-5[_ngcontent-%COMP%], .profile-header-card[_ngcontent-%COMP%]   .col-lg-4[_ngcontent-%COMP%]{margin-bottom:20px}}.floating-publications-btn[_ngcontent-%COMP%]{right:30px!important;bottom:30px!important;width:65px!important;height:65px!important;z-index:1050!important;background:linear-gradient(135deg,#007bff,#0056b3)!important;border:3px solid #ffffff!important;color:#fff!important;transition:all .3s cubic-bezier(.175,.885,.32,1.275)!important;box-shadow:0 8px 25px #007bff66!important}.floating-publications-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#0056b3,#004085)!important;transform:scale(1.1) translateY(-2px)!important;box-shadow:0 12px 35px #007bff99!important;border-color:#fff!important;color:#fff!important}.floating-publications-btn[_ngcontent-%COMP%]:active{transform:scale(1.05) translateY(0)!important;transition:transform .1s ease!important}.floating-publications-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.3rem!important;transition:all .3s ease!important}.floating-publications-btn[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transform:scale(1.1)!important}@keyframes _ngcontent-%COMP%_floatingPulse{0%{box-shadow:0 8px 25px #007bff66}50%{box-shadow:0 8px 25px #007bff99}to{box-shadow:0 8px 25px #007bff66}}.floating-publications-btn[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_floatingPulse 3s infinite}@media (max-width: 768px){.floating-publications-btn[_ngcontent-%COMP%]{right:20px!important;bottom:20px!important;width:55px!important;height:55px!important}.floating-publications-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem!important}}#menu[_ngcontent-%COMP%]{position:sticky;top:61px;z-index:99;margin-bottom:0;margin-top:0}.profile-menu-nav[_ngcontent-%COMP%]{border-radius:0 0 12px 12px!important;overflow:hidden;background:linear-gradient(135deg,#fff,#f8f9fa)!important;box-shadow:0 6px 20px #0000001a!important;border:1px solid rgba(0,0,0,.05)!important;border-top:none!important;backdrop-filter:blur(10px)}.theme-dark[_ngcontent-%COMP%]   .profile-menu-nav[_ngcontent-%COMP%]{background:#1a1a1a!important;background-image:none!important;box-shadow:0 6px 20px #0006!important;border-color:#333!important}.theme-dark[_ngcontent-%COMP%]   .profile-menu-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:#ecf0f1!important}.theme-dark[_ngcontent-%COMP%]   .profile-menu-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{color:#3498db!important;background:linear-gradient(135deg,#3498db26,#2980b91a)!important}.theme-dark[_ngcontent-%COMP%]   .profile-menu-nav[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:#fff!important;background:linear-gradient(135deg,#3498db,#2980b9)!important}#menu[_ngcontent-%COMP%]   .navbar[_ngcontent-%COMP%]{border-radius:0 0 12px 12px!important;overflow:hidden;box-shadow:0 6px 20px #0000001a!important;border:1px solid rgba(0,0,0,.05)!important;border-top:none!important;backdrop-filter:blur(10px)}#menu[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{width:100%;justify-content:space-evenly}#menu[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]{flex:1;text-align:center}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{position:relative;padding:12px 16px!important;border-radius:10px;margin:6px 3px;font-weight:600;font-size:.95rem;color:#495057!important;text-decoration:none;transition:all .4s cubic-bezier(.175,.885,.32,1.275);background:transparent;overflow:hidden;border:2px solid transparent}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:#007bff1a;transition:left .6s ease;z-index:0}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover:before{left:100%}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:50%;width:0;height:3px;background:linear-gradient(90deg,#007bff,#0056b3);transition:all .4s ease;transform:translate(-50%);border-radius:3px 3px 0 0}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover:after{width:80%}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{color:#007bff!important;background:linear-gradient(135deg,#007bff14,#0056b30d);transform:translateY(-2px);border-color:#007bff33;box-shadow:0 6px 20px #007bff33}#menu[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:#fff!important;background:linear-gradient(135deg,#007bff,#0056b3);transform:translateY(-2px);border-color:#007bff;box-shadow:0 10px 30px #007bff66}#menu[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]:after{width:100%;background:#ffffff4d}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:6px;font-size:1rem;transition:all .3s ease;position:relative;z-index:1}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transform:scale(1.1);color:#007bff}#menu[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transform:scale(1.1);color:#fff}@keyframes _ngcontent-%COMP%_menuPulse{0%{transform:translateY(-2px) scale(1)}50%{transform:translateY(-2px) scale(1.01)}to{transform:translateY(-2px) scale(1)}}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{animation:_ngcontent-%COMP%_menuPulse 3s infinite}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #007bff4d;border-color:#007bff}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:active{transform:translateY(-1px);transition:transform .1s ease}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:relative;z-index:1;transition:all .3s ease}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{font-weight:700;letter-spacing:.5px}@media (max-width: 768px){#menu[_ngcontent-%COMP%]{top:61px}.profile-sidebar[_ngcontent-%COMP%]{top:121px;max-height:calc(100vh - 140px)}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding:10px 12px!important;font-size:.9rem;margin:4px 2px}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.95rem;margin-right:5px}#menu[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{flex-direction:row;justify-content:space-between}#menu[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]{flex:1}}@media (max-width: 576px){#menu[_ngcontent-%COMP%]{top:62px}.profile-sidebar[_ngcontent-%COMP%]{position:static;max-height:none;margin-bottom:2rem}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding:8px 6px!important;font-size:.8rem;margin:3px 1px}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}#menu[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:0;font-size:1.1rem}}']})}}return i})();var At=i=>({"is-invalid":i});function di(i,d){if(i&1&&(o(0,"li"),l(1),r()),i&2){let t=d.$implicit;a(),x(t)}}function mi(i,d){if(i&1){let t=b();o(0,"div",21)(1,"ul"),f(2,di,2,1,"li",22),r(),p(3,"button",23),o(4,"form",10),h("ngSubmit",function(){g(t);let n=s();return _(n.onSubmit())}),l(5," \xA0 "),r()()}if(i&2){let t=s();a(2),c("ngForOf",t.errorMessages),a(2),c("formGroup",t.editForm)}}function pi(i,d){i&1&&(o(0,"div",24),p(1,"i",25),l(2," Se est\xE1 subiendo la foto, por favor evita cerrar la p\xE1gina. "),p(3,"button",23),r())}function fi(i,d){i&1&&(o(0,"span"),l(1,"\xA1Perfil actualizado! Tu nueva foto de perfil se est\xE1 procesando. Ser\xE1s redirigido autom\xE1ticamente..."),r())}function ui(i,d){i&1&&(o(0,"span"),l(1,"Los datos se han actualizado correctamente."),r())}function gi(i,d){if(i&1&&(o(0,"div",26),p(1,"i",25),f(2,fi,2,0,"span",27)(3,ui,2,0,"span",27),p(4,"button",23),r()),i&2){let t=s();a(2),c("ngIf",t.filesToUpload.length>0),a(),c("ngIf",t.filesToUpload.length===0)}}function _i(i,d){i&1&&(o(0,"div",28),l(1," Archivo inv\xE1lido, solo se permite cargar im\xE1genes con extensi\xF3n jpg, png o gif. "),r())}function hi(i,d){i&1&&(o(0,"div",29),p(1,"i",30),l(2," Los datos no pudieron ser actualizados. Int\xE9ntalo de nuevo. "),p(3,"button",23),r())}function vi(i,d){if(i&1&&(o(0,"div",28),l(1),r()),i&2){let t=s();a(),w(" El tama\xF1o de la imagen es demasiado grande. El tama\xF1o m\xE1ximo permitido es ",t.MAX_FILE_SIZE," MB. ")}}function bi(i,d){if(i&1&&(o(0,"div",31)(1,"div",32,0),l(3),r()()),i&2){let t=s();a(),dt("width",t.barWidth),a(2),x(t.barWidth)}}function xi(i,d){i&1&&(o(0,"div"),l(1,"Campo requerido"),r())}function Ci(i,d){if(i&1&&(o(0,"div"),l(1),r()),i&2){let t,e=s(3).$implicit,n=s();a(),w("Debe tener menos de ",(t=n.editForm.get(e.id).errors)==null||t.maxlength==null?null:t.maxlength.requiredLength," caracteres")}}function wi(i,d){if(i&1&&(o(0,"div",38),f(1,xi,2,0,"div",27)(2,Ci,2,1,"div",27),r()),i&2){let t=s(2).$implicit,e=s();a(),c("ngIf",e.editForm.get(t.id).hasError("required")),a(),c("ngIf",e.editForm.get(t.id).hasError("maxlength"))}}function Pi(i,d){if(i&1){let t=b();o(0,"div")(1,"input",36),h("change",function(){g(t);let n=s(2);return _(n.onChanges())}),r(),f(2,wi,3,2,"div",37),r()}if(i&2){let t=s().$implicit,e=s();a(),P("id",t.id),P("formControlName",t.id),c("ngClass",y(4,At,e.editForm.get(t.id).touched&&e.editForm.get(t.id).invalid)),a(),c("ngIf",e.editForm.get(t.id).touched&&e.editForm.get(t.id).invalid)}}function yi(i,d){i&1&&(o(0,"div"),l(1,"Campo requerido"),r())}function Mi(i,d){if(i&1&&(o(0,"div"),l(1),r()),i&2){let t,e=s(3).$implicit,n=s();a(),w("Debe tener menos de ",(t=n.editForm.get(e.id).errors)==null||t.maxlength==null?null:t.maxlength.requiredLength," caracteres")}}function Oi(i,d){if(i&1&&(o(0,"div"),l(1),r()),i&2){let t,e=s(3).$implicit,n=s();a(),D(" Aseg\xFArate de que la descripci\xF3n no sea mayor a ",(t=n.editForm.get(e.id).errors)==null||t.maxLines==null?null:t.maxLines.maxLines," l\xEDneas (actualmente: ",(t=n.editForm.get(e.id).errors)==null||t.maxLines==null?null:t.maxLines.actualLines," l\xEDneas) ")}}function Si(i,d){if(i&1&&(o(0,"div",38),f(1,yi,2,0,"div",27)(2,Mi,2,1,"div",27)(3,Oi,2,2,"div",27),r()),i&2){let t=s(2).$implicit,e=s();a(),c("ngIf",e.editForm.get(t.id).hasError("required")),a(),c("ngIf",e.editForm.get(t.id).hasError("maxlength")),a(),c("ngIf",e.editForm.get(t.id).hasError("maxLines"))}}function Ii(i,d){if(i&1){let t=b();o(0,"div")(1,"textarea",39),h("change",function(){g(t);let n=s(2);return _(n.onChanges())}),l(2,"            "),r(),f(3,Si,4,3,"div",37),r()}if(i&2){let t=s().$implicit,e=s();a(),P("id",t.id),P("formControlName",t.id),P("placeholder",t.placeholder),c("ngClass",y(5,At,e.editForm.get(t.id).touched&&e.editForm.get(t.id).invalid)),a(2),c("ngIf",e.editForm.get(t.id).touched&&e.editForm.get(t.id).invalid)}}function Ei(i,d){i&1&&(o(0,"div",38),l(1," Campo requerido "),r())}function ki(i,d){if(i&1){let t=b();o(0,"div")(1,"ng-select",40),h("change",function(){g(t);let n=s(2);return _(n.onChanges())}),r(),f(2,Ei,2,0,"div",37),r()}if(i&2){let t=s().$implicit,e=s();a(),kt("addTagText","Agregar ",t.label,""),P("formControlName",t.id),P("placeholder",t.label),c("items",e.items[t.id])("addTag",!0)("ngClass",y(8,At,e.editForm.get(t.id).touched&&e.editForm.get(t.id).invalid)),a(),c("ngIf",e.editForm.get(t.id).touched&&e.editForm.get(t.id).invalid)}}function Ti(i,d){if(i&1&&l(0),i&2){let t=d.item;R(" ",t.name,", ",t.state,", ",t.country," ")}}function Fi(i,d){if(i&1){let t=b();o(0,"div")(1,"ng-select",41),h("change",function(n){g(t);let m=s().$implicit,u=s();return u.addCityData(n,m.id),_(u.onChanges())}),f(2,Ti,1,3,"ng-template",42),r()()}if(i&2){let t=s().$implicit,e=s();a(),kt("addTagText","Agregar ",t.label,""),P("formControlName",t.id),P("placeholder",t.label),c("items",e.items[t.id])("addTag",!0)}}function Li(i,d){if(i&1&&p(0,"input",45),i&2){let t=s(3);c("formControl",t.country)}}function Vi(i,d){if(i&1&&(o(0,"div"),p(1,"input",43),f(2,Li,1,1,"input",44),r()),i&2){let t=s().$implicit,e=s();a(),c("formControl",e.state),a(),c("ngIf",t.id=="city"&&e.addCity)}}function Ui(i,d){if(i&1&&(o(0,"div",33)(1,"label",34)(2,"strong"),l(3),r()(),o(4,"div",35),f(5,Pi,3,6,"div",27)(6,Ii,4,7,"div",27)(7,ki,3,10,"div",27)(8,Fi,3,6,"div",27)(9,Vi,3,2,"div",27),r()()),i&2){let t=d.$implicit,e=s();a(),P("for",t.id),a(2),x(t.label),a(2),c("ngIf",t.type==="text"),a(),c("ngIf",t.type==="textarea"),a(),c("ngIf",t.type=="select"&&t.autocomplete&&t.id!="city"),a(),c("ngIf",t.type=="select"&&t.autocomplete&&t.id=="city"),a(),c("ngIf",t.id=="city"&&e.addCity)}}var ye=(()=>{class i{maxLinesValidator(t){return e=>{if(!e.value)return null;let n=e.value.split(`
`).length;return n>t?{maxLines:{actualLines:n,maxLines:t}}:null}}constructor(t,e,n,m,u,C){this._formBuilder=t,this._userService=e,this._uploadService=n,this._bDService=m,this._router=u,this._route=C,this.addCity=!1,this.MAX_FILE_SIZE=20,this.maxSize=20*1024*1024,this.maxSizeError=!1,this.city=new be,this.profession=new ue(""),this.institution=new ge,this.barWidth="0%",this.errorMessages=[],this.subscriptions=new Rt,this.typeError=!1,this.filesToUpload=[],this.title="Editar perfil",this.identity=this._userService.getIdentity(),this.url=U.url,this.user=this._userService.getIdentity(),this.token=this._userService.getToken(),this.fieldsForm=Ut,this.state=new Ft(""),this.country=new Ft(""),this.items={city:[],institution:[],profession:[]}}ngOnInit(){this.loadPage(),this.getAllCities(),this.getAllInstitutions(),this.getAllProfessions(),this.editForm=this._formBuilder.group({name:[this.identity.name,[I.required,I.maxLength(80)]],surname:[this.identity.surname,[I.required,I.maxLength(80)]],about:[this.identity.about,[I.required,I.maxLength(1e3),this.maxLinesValidator(15)]],city:[this.identity.city],profession:[this.identity.profession,I.required],institution:[this.identity.institution,I.required],postgraduate:[this.identity.postgraduate,I.maxLength(1e3)],profileImage:"",contactNumber:[this.identity.contactNumber,[I.pattern("[- +()0-9]+"),I.maxLength(15)]],socialNetworks:this.identity.socialNetworks})}onChanges(){this.editForm.valueChanges.subscribe(t=>{t&&(this.status=null)})}loadPage(){this.identity=this._userService.getIdentity(),this._route.parent.params.subscribe(t=>{let e=t.id;this.getUser(e)})}getUser(t){this._userService.getUser(t).subscribe({next:e=>{e.user?(this.identity=e.user,this.editForm&&this.editForm.patchValue({name:this.identity.name,surname:this.identity.surname,about:this.identity.about,city:this.identity.city,profession:this.identity.profession,institution:this.identity.institution,postgraduate:this.identity.postgraduate,contactNumber:this.identity.contactNumber,socialNetworks:this.identity.socialNetworks})):this.identity=this.identity},error:e=>{console.log(e),this.identity=this.identity}})}onSubmit(){return Nt(this,null,function*(){this.errorMessages=[],console.log("submitting");let t=[];for(let n in this.editForm.controls){let m=this.editForm.get(n);if(m.hasValidator(I.required)&&(m.value===""||m.value===null)){let u=Ut.find(C=>C.id===n);u&&(t.push(n),this.errorMessages.push(`El campo ${u.label} es requerido.`))}}if(this.editForm.invalid){document.scrollingElement.scrollTop=0,this.status="error";return}if(this.filesToUpload[0]){if(["image/jpeg","image/gif","image/png"].includes(this.filesToUpload[0].type))this.typeError=!1;else{window.scroll({top:0,left:0,behavior:"smooth"}),console.log("submitting2ndinvalid"),this.typeError=!0;return}if(this.maxSize<this.filesToUpload[0].size){window.scroll({top:0,left:0,behavior:"smooth"}),console.log("submitting3rdinvalid"),this.typeError=!0,this.maxSizeError=!0;return}else this.maxSizeError=!1}if(this.user.name=this.editForm.value.name,this.user.surname=this.editForm.value.surname,this.user.about=this.editForm.value.about,this.user.postgraduate=this.editForm.value.postgraduate,this.user.socialNetworks=this.editForm.value.socialNetworks,this.user.contactNumber=this.editForm.value.contactNumber,this.editForm.value.city&&(this.user.city=this.editForm.value.city._id),this.editForm.value.profession&&(this.user.profession=this.editForm.value.profession._id),this.editForm.value.institution&&(this.user.institution=this.editForm.value.institution._id),!this.user.city&&this.editForm.value.city){this.editForm.value.city.name?this.city.name=this.editForm.value.city.name:this.city.name=this.editForm.value.city,this.city.state=this.state.value,this.city.country=this.country.value;let n=yield it(this._bDService.addCity(this.city));n.city&&n.city._id?(this.user.city=n.city._id,this.state.reset(),this.country.reset()):console.log(n),localStorage.removeItem("cities"),this.getAllCities()}if(!this.user.profession&&this.editForm.value.profession){this.editForm.value.profession.name?this.profession.name=this.editForm.value.profession.name:this.profession.name=this.editForm.value.profession;let n=yield it(this._bDService.addProfession(this.profession));n.profession&&n.profession._id?this.user.profession=n.profession._id:console.log(n),localStorage.removeItem("professions"),this.getAllProfessions()}if(!this.user.institution&&this.editForm.value.institution){this.editForm.value.institution.name?this.institution.name=this.editForm.value.institution.name:this.institution.name=this.editForm.value.institution;let n=yield it(this._bDService.addInstitution(this.institution));n.institution&&n.institution._id?this.user.institution=n.institution._id:console.log(n),localStorage.removeItem("institutions"),this.getAllInstitutions()}let e=yield it(this._userService.updateUser(this.user)).catch(n=>{this.status="error",console.log(n)});if(e.user&&e.user._id){document.scrollingElement.scrollTop=0;let n=this.identity.city,m=this.identity.profession,u=this.identity.institution;this.identity=e.user,n&&typeof n=="object"&&n.name&&(this.identity.city=n),m&&typeof m=="object"&&m.name&&(this.identity.profession=m),u&&typeof u=="object"&&u.name&&(this.identity.institution=u),this.status="success",localStorage.setItem("identity",JSON.stringify(this.identity)),this._userService.setIdentity(this.identity),this.filesToUpload.length>0&&this._uploadService.makeFileRequest(this.url+"upload-image-user/"+this.identity._id,[],this.filesToUpload,this.token,"image").subscribe({next:C=>{switch(C.type){case Tt.UploadProgress:this.status="warning",this.barWidth=Math.round(C.loaded/C.total*100).toString()+"%";break;case Tt.Response:console.log("User successfully added!",C.body),this.status="success",this.barWidth="0%",C.body&&C.body.user&&C.body.user.picture&&(this.identity.picture=C.body.user.picture,localStorage.setItem("identity",JSON.stringify(this.identity)),this._userService.setIdentity(this.identity),this._userService.profilePictureUpdated.emit(),console.log("Profile picture updated event emitted from EditInfo"),setTimeout(()=>{this._router.navigate(["/perfil",this.identity._id])},1500));break}},error:C=>{this.status="error",this.barWidth="0%",console.log(C)}}),this.getAllCities(),this.getAllInstitutions(),this.getAllProfessions()}else this.status="error"})}ngOnDestroy(){this.subscriptions.unsubscribe()}fileChangeEvent(t){this.filesToUpload=t.target.files}getAllCities(){this.allCities=JSON.parse(localStorage.getItem("cities")),this.allCities||this._bDService.getAllCities().subscribe({next:t=>{t.cities&&(this.allCities=t.cities,localStorage.setItem("cities",JSON.stringify(this.allCities)))},error:t=>console.log(t)}),this.items.city=this.allCities}getAllProfessions(){this.allProfessions=JSON.parse(localStorage.getItem("professions")),this.allProfessions||this._bDService.getAllProfessions().subscribe({next:t=>{t.professions&&(this.allProfessions=t.professions,localStorage.setItem("professions",JSON.stringify(this.allProfessions)))},error:t=>console.log(t)}),this.items.profession=this.allProfessions}getAllInstitutions(){this.allInstitutions=JSON.parse(localStorage.getItem("institutions")),this.allInstitutions||this._bDService.getAllInstitutions().subscribe({next:t=>{t.institutions&&(this.allInstitutions=t.institutions,localStorage.setItem("institutions",JSON.stringify(this.allInstitutions)))},error:t=>console.log(t)}),this.items.institution=this.allInstitutions}addCityData(t,e){t&&!t._id&&e=="city"?this.addCity=!0:this.addCity=!1}static{this.\u0275fac=function(e){return new(e||i)(v(Ct),v(E),v(Pt),v(ce),v(T),v(k))}}static{this.\u0275cmp=F({type:i,selectors:[["editInfo"]],standalone:!1,decls:25,vars:10,consts:[["progress",""],[1,"card"],[1,"card-header"],[1,"m-0","text-primary","fw-bolder"],[1,"card-body"],["class","alert alert-danger alert-dismissible fade show","role","alert",4,"ngIf"],["class","alert alert-warning alert-dismissible fade show text-center","role","alert",4,"ngIf"],["class","alert alert-success alert-dismissible fade show text-center","role","alert",4,"ngIf"],["class","alert alert-danger alert-dismissible fade show text-center",4,"ngIf"],["class","alert alert-danger alert-dismissible fade show text-center","role","alert",4,"ngIf"],["enctype","multipart/form-data",3,"ngSubmit","formGroup"],[1,"mb-3","row","align-items-end"],["for","profileImage",1,"col-3","col-form-label"],[1,"col"],["type","file","name","image","id","profileImage","formControlName","profileImage","enctype","multipart/form-data",1,"form-control",3,"change"],["class","progress",4,"ngIf"],["class","mb-3 row",4,"ngFor","ngForOf"],[1,"mb-3","row","mb-5"],[1,"col-3","offset-9","text-end"],["type","submit",1,"btn","btn-warning"],[2,"height","115px"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[4,"ngFor","ngForOf"],["type","button","data-bs-dismiss","alert","aria-label","Close",1,"btn-close"],["role","alert",1,"alert","alert-warning","alert-dismissible","fade","show","text-center"],[1,"fas","fa-check-circle","icon-message","me-2"],["role","alert",1,"alert","alert-success","alert-dismissible","fade","show","text-center"],[4,"ngIf"],[1,"alert","alert-danger","alert-dismissible","fade","show","text-center"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show","text-center"],[1,"fas","fa-times-circle","icon-message","me-2"],[1,"progress"],["role","progressbar","aria-valuenow","barWidth","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","progress-bar-animated"],[1,"mb-3","row"],[1,"col-3","col-form-label",3,"for"],[1,"col-9"],["type","text",1,"form-control",3,"change","id","formControlName","ngClass"],["class","invalid-feedback-select",4,"ngIf"],[1,"invalid-feedback-select"],["rows","3",1,"form-control",3,"change","id","formControlName","placeholder","ngClass"],["bindLabel","name",3,"change","items","addTag","addTagText","formControlName","placeholder","ngClass"],["bindLabel","name",3,"change","items","addTag","addTagText","formControlName","placeholder"],["ng-option-tmp",""],["type","text","id","state","placeholder","Departamento/Estado/Provincia","autocomplete","off",1,"form-control",3,"formControl"],["type","text","class","form-control","id","country","placeholder","Pa\xEDs","autocomplete","off",3,"formControl",4,"ngIf"],["type","text","id","country","placeholder","Pa\xEDs","autocomplete","off",1,"form-control",3,"formControl"]],template:function(e,n){e&1&&(o(0,"div",1)(1,"div",2)(2,"h3",3),l(3),r()(),o(4,"div",4),f(5,mi,6,2,"div",5)(6,pi,4,0,"div",6)(7,gi,5,2,"div",7)(8,_i,2,0,"div",8)(9,hi,4,0,"div",9)(10,vi,2,1,"div",8),o(11,"form",10),h("ngSubmit",function(){return n.onSubmit()}),o(12,"div",11)(13,"label",12)(14,"strong"),l(15,"Foto de perfil"),r()(),o(16,"div",13)(17,"input",14),h("change",function(u){return n.fileChangeEvent(u),n.onChanges()}),r()()(),f(18,bi,4,3,"div",15)(19,Ui,10,7,"div",16),o(20,"div",17)(21,"div",18)(22,"button",19),l(23," Guardar cambios "),r()()()(),p(24,"div",20),r()()),e&2&&(a(3),x(n.title),a(2),c("ngIf",n.errorMessages.length>0),a(),c("ngIf",n.status==="warning"),a(),c("ngIf",n.status==="success"),a(),c("ngIf",n.typeError),a(),c("ngIf",n.status==="error"),a(),c("ngIf",n.maxSizeError),a(),c("formGroup",n.editForm),a(7),c("ngIf",n.filesToUpload!=null||n.barWidth!="0%"),a(),c("ngForOf",n.fieldsForm))},dependencies:[ut,L,V,vt,_t,X,ht,ie,bt,xt,re,oe],styles:[".card[_ngcontent-%COMP%]{border:none;box-shadow:0 4px 12px #00000014;border-radius:12px}.card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--rd-primary),#1763d6);border-bottom:none}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff!important}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.col-form-label[_ngcontent-%COMP%]{color:var(--rd-text);font-weight:600}.theme-dark[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%], .theme-dark[_ngcontent-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-select-container[_ngcontent-%COMP%]{background-color:#11161a!important;color:var(--rd-text)!important;border-color:#2a2f36!important}.theme-dark[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]::placeholder, .theme-dark[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::placeholder{color:#c1c9d2!important;opacity:1!important}.theme-dark[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .theme-dark[_ngcontent-%COMP%]   .col-form-label[_ngcontent-%COMP%]{color:var(--rd-text)!important}.theme-dark[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{background-color:#1f2933}.theme-dark[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{background-color:var(--rd-primary)}.theme-dark[_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-select-container[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-select-container[_ngcontent-%COMP%]{background-color:#11161a!important;border-color:#2a2f36!important}.theme-dark[_nghost-%COMP%]   .ng-select.ng-select-focused[_ngcontent-%COMP%]   .ng-select-container[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .ng-select.ng-select-focused[_ngcontent-%COMP%]   .ng-select-container[_ngcontent-%COMP%]{border-color:#8ab4ff!important;box-shadow:0 0 0 .2rem #8ab4ff26!important}.theme-dark[_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-placeholder[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-placeholder[_ngcontent-%COMP%]{color:#c1c9d2!important;opacity:1!important}.theme-dark[_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-value-container[_ngcontent-%COMP%]   .ng-value[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-value-container[_ngcontent-%COMP%]   .ng-value[_ngcontent-%COMP%]{color:#f1f5f9!important;background-color:#8ab4ff33!important;border-color:#8ab4ff4d!important}.theme-dark[_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-value-container[_ngcontent-%COMP%]   .ng-value[_ngcontent-%COMP%]   .ng-value-label[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-value-container[_ngcontent-%COMP%]   .ng-value[_ngcontent-%COMP%]   .ng-value-label[_ngcontent-%COMP%]{color:#f1f5f9!important}.theme-dark[_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-arrow-wrapper[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-arrow-wrapper[_ngcontent-%COMP%]{color:#f1f5f9!important}.theme-dark[_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-clear-wrapper[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-clear-wrapper[_ngcontent-%COMP%]{color:#f1f5f9!important}.theme-dark[_nghost-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]{background-color:#1a1f24!important;border-color:#2a2f36!important}.theme-dark[_nghost-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]   .ng-option[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]   .ng-option[_ngcontent-%COMP%]{background-color:#1a1f24!important;color:#f1f5f9!important}.theme-dark[_nghost-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]   .ng-option.ng-option-highlighted[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]   .ng-option.ng-option-highlighted[_ngcontent-%COMP%]{background-color:#8ab4ff33!important;color:#f1f5f9!important}.theme-dark[_nghost-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]   .ng-option.ng-option-selected[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]   .ng-option.ng-option-selected[_ngcontent-%COMP%]{background-color:#8ab4ff4d!important;color:#f1f5f9!important}.theme-dark[_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-select-container[_ngcontent-%COMP%]   .ng-value-container[_ngcontent-%COMP%]   .ng-input[_ngcontent-%COMP%] > input[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-select-container[_ngcontent-%COMP%]   .ng-value-container[_ngcontent-%COMP%]   .ng-input[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{color:#f1f5f9!important;background-color:transparent!important}.theme-dark[_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-placeholder[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .ng-select[_ngcontent-%COMP%]   .ng-placeholder[_ngcontent-%COMP%]{color:#c1c9d2!important;font-weight:400!important;opacity:1!important}.theme-dark[_nghost-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]   .ng-option.ng-option-add[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .ng-dropdown-panel[_ngcontent-%COMP%]   .ng-option.ng-option-add[_ngcontent-%COMP%]{color:#8ab4ff!important;font-style:italic}.theme-dark[_nghost-%COMP%]   .form-control[_ngcontent-%COMP%]:focus, .theme-dark   [_nghost-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{background-color:#11161a!important;border-color:#8ab4ff!important;color:#f1f5f9!important;box-shadow:0 0 0 .2rem #8ab4ff26!important}.btn.btn-warning[_ngcontent-%COMP%]{font-weight:700;border-radius:10px}"]})}}return i})();var Ai=["infoCard"];function Di(i,d){if(i&1&&(o(0,"p",11),l(1),r()),i&2){let t=s(2).$implicit,e=s();P("id",t.id),a(),w(" ",e.identity[t.attr]," ")}}function zi(i,d){if(i&1&&(o(0,"p",11),l(1),r()),i&2){let t=s(2).$implicit,e=s();P("id",t.id),a(),w(" ",e.identity[t.attr].name," ")}}function Ni(i,d){if(i&1&&(o(0,"p",11),l(1),r()),i&2){let t=s(2).$implicit,e=s();P("id",t.id),a(),R(" ",e.identity[t.attr].name,", ",e.identity[t.attr].state,", ",e.identity[t.attr].country," ")}}function Ri(i,d){if(i&1&&(o(0,"p"),l(1),r()),i&2){let t=d.$implicit;a(),x(t)}}function ji(i,d){if(i&1&&(o(0,"div",11),f(1,Ri,2,1,"p",5),r()),i&2){let t=s(2).$implicit,e=s();P("id",t.id),a(),c("ngForOf",e.identity[t.attr].split(`
`))}}function $i(i,d){if(i&1&&(o(0,"div",14)(1,"a",15),p(2,"i",16),o(3,"span",17),l(4),r()()()),i&2){let t=d.$implicit,e=s(4);a(),c("href",e.formatLink(t),A)("title","Visitar "+t.trim()),a(3),x(t.trim())}}function Bi(i,d){if(i&1&&(o(0,"div",11)(1,"div",12),f(2,$i,5,3,"div",13),r()()),i&2){let t=s(2).$implicit,e=s();P("id",t.id),a(2),c("ngForOf",e.getSocialLinks(e.identity[t.attr]))}}function qi(i,d){if(i&1&&(o(0,"div",7)(1,"label",8)(2,"strong"),l(3),r()(),o(4,"div",9),f(5,Di,2,2,"p",10)(6,zi,2,2,"p",10)(7,Ni,2,4,"p",10)(8,ji,2,2,"div",10)(9,Bi,3,2,"div",10),r()()),i&2){let t=s().$implicit;a(),P("for",t.id),a(2),w("",t.label,":"),a(2),c("ngIf",t.type=="text"),a(),c("ngIf",t.type=="select"&&t.autocomplete&&t.id!="city"),a(),c("ngIf",t.type=="select"&&t.autocomplete&&t.id=="city"),a(),c("ngIf",t.type=="textarea"),a(),c("ngIf",t.type=="list")}}function Yi(i,d){if(i&1&&(Wt(0),f(1,qi,10,7,"div",6),Gt()),i&2){let t=d.$implicit,e=s();a(),c("ngIf",e.identity[t.attr])}}var Me=(()=>{class i{constructor(t,e,n){this._userService=t,this._router=e,this._route=n,this.viewer=t.getIdentity(),this.identity=this.viewer,this.title="Informaci\xF3n",this.fieldsForm=Ot}ngOnInit(){this.loadPage()}ngAfterViewInit(){setTimeout(()=>{this.infoCard&&this.infoCard.nativeElement&&this.infoCard.nativeElement.scrollIntoView({behavior:"smooth",block:"start"})},300)}loadPage(){this.viewer=this._userService.getIdentity(),this._route.parent.params.subscribe(t=>{let e=t.id;this.getUser(e)})}getUser(t){this._userService.getUser(t).subscribe(e=>{if(e.user){this.identity=e.user;let n=this.viewer&&this.identity&&this.viewer._id===this.identity._id,m=!!(this.viewer&&this.viewer.actived===!0);n||m?this.fieldsForm=Ot:this.fieldsForm=Ot.filter(u=>u.id==="name"||u.id==="surname")}else this.identity=this.identity,this._router.navigate(["/perfil/"+this.identity._id])},e=>{console.log(e),this.identity=this.identity,this._router.navigate(["/perfil/"+this.identity._id])})}getSocialLinks(t){return t?t.toString().split(";").map(n=>n.trim()).filter(n=>n.length>0):[]}formatLink(t){if(!t)return"";let e=t.trim();return e.startsWith("http://")||e.startsWith("https://")?e:"https://"+e}static{this.\u0275fac=function(e){return new(e||i)(v(E),v(T),v(k))}}static{this.\u0275cmp=F({type:i,selectors:[["info"]],viewQuery:function(e,n){if(e&1&&mt(Ai,5),e&2){let m;pt(m=ft())&&(n.infoCard=m.first)}},standalone:!1,decls:7,vars:2,consts:[["infoCard",""],[1,"card"],[1,"card-header"],[1,"m-0","text-white"],[1,"card-body","profile-info"],[4,"ngFor","ngForOf"],["class","row align-items-start",4,"ngIf"],[1,"row","align-items-start"],[1,"col-md-3","col-12","profile-label",3,"for"],[1,"col-md-9","col-12","profile-value"],[3,"id",4,"ngIf"],[3,"id"],[1,"social-links-container"],["class","social-link-item mb-2",4,"ngFor","ngForOf"],[1,"social-link-item","mb-2"],["target","_blank",1,"btn","btn-outline-primary","btn-sm","d-flex","align-items-center",3,"href","title"],[1,"fas","fa-external-link-alt","me-2"],[1,"text-truncate"]],template:function(e,n){e&1&&(o(0,"div",1,0)(2,"div",2)(3,"h3",3),l(4),r()(),o(5,"div",4),f(6,Yi,2,1,"ng-container",5),r()()),e&2&&(a(4),x(n.title),a(2),c("ngForOf",n.fieldsForm))},dependencies:[L,V],styles:[".social-links-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-top:8px}.social-link-item[_ngcontent-%COMP%]{width:100%}.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;padding:14px 18px;background:linear-gradient(135deg,#007bff,#0056b3);border:2px solid #007bff;border-radius:10px;text-decoration:none;color:#fff;font-weight:600;transition:all .3s ease;width:100%;box-sizing:border-box}.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#0056b3,#004085);color:#fff;border-color:#0056b3;transform:translateY(-2px);box-shadow:0 6px 16px #007bff66}.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;font-size:1.1rem;margin-right:12px;transition:color .3s ease;flex-shrink:0}.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:#fff}.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.95rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1;color:#fff}.card[_ngcontent-%COMP%]{border:none;box-shadow:0 4px 12px #0000001a;border-radius:12px;overflow:hidden}.card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--rd-primary) 0%,#1763d6 100%);border-bottom:none;padding:1.25rem}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff;margin:0;font-size:1.5rem;font-weight:700}.card-body[_ngcontent-%COMP%]{padding:1.5rem}.row[_ngcontent-%COMP%]{margin-bottom:1.25rem;padding-bottom:.75rem;border-bottom:1px solid rgba(0,0,0,.06)}.row[_ngcontent-%COMP%]:last-child{border-bottom:none;margin-bottom:0}.row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:var(--rd-text);margin-bottom:.5rem;display:flex;align-items:center}.row[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--rd-text);opacity:.9;line-height:1.6}.theme-dark[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border-color:#2a2f36!important}.theme-dark[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0d47a1,#1565c0)}.theme-dark[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{border-bottom-color:#2a2f36}.theme-dark[_ngcontent-%COMP%]   .profile-info[_ngcontent-%COMP%]   .btn-outline-primary[_ngcontent-%COMP%]{color:var(--rd-text);border-color:#2a2f36}.theme-dark[_ngcontent-%COMP%]   .profile-info[_ngcontent-%COMP%]   .btn-outline-primary[_ngcontent-%COMP%]:hover{background:#22303a;border-color:#3a4754}.profile-label[_ngcontent-%COMP%], .profile-value[_ngcontent-%COMP%]{color:var(--rd-text)}@media (max-width: 768px){.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:12px 16px;font-size:.9rem}.social-link-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.85rem}.card-body[_ngcontent-%COMP%]{padding:1rem}.row[_ngcontent-%COMP%]{margin-bottom:1rem}}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.social-link-item[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .3s ease-in-out}.social-link-item[_ngcontent-%COMP%]:nth-child(1){animation-delay:.1s}.social-link-item[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.social-link-item[_ngcontent-%COMP%]:nth-child(3){animation-delay:.3s}.social-link-item[_ngcontent-%COMP%]:nth-child(4){animation-delay:.4s}.social-link-item[_ngcontent-%COMP%]:nth-child(5){animation-delay:.5s}"]})}}return i})();var It=(()=>{class i{constructor(t){this._http=t,this.url=U.url}getPublicLessons(t,e=1,n){let m=new Q({"Content-Type":"application/json"}),u=new URLSearchParams;u.set("page",e.toString()),n?.role&&n.role!=="all"&&u.set("role",n.role),n?.area&&u.set("area",n.area);let C=u.toString(),j=C?`${this.url}users/${t}/lessons/public?${C}`:`${this.url}users/${t}/lessons/public`;return this._http.get(j,{headers:m}).pipe(B(M=>this.transformBackendResponse(M)),q(M=>(console.error("Error fetching public lessons:",M),$(this.getEmptyPublicLessonsResponse()))))}getLessonsStats(t){let e=new Q({"Content-Type":"application/json"});return this._http.get(`${this.url}users/${t}/lessons/stats`,{headers:e}).pipe(B(n=>n),q(n=>(console.error("Error fetching lessons stats:",n),$(this.getEmptyStats()))))}updatePrivacySettings(t){let e=new Q({"Content-Type":"application/json"});return this._http.put(`${this.url}users/lessons/privacy`,t,{headers:e}).pipe(B(()=>{}),q(n=>(console.error("Error updating privacy settings:",n),$(void 0))))}toggleLessonVisibility(t,e){let n=new Q({"Content-Type":"application/json"}),m={visible:e};return this._http.put(`${this.url}lessons/${t}/visibility`,m,{headers:n}).pipe(B(()=>{}),q(u=>(console.error("Error toggling lesson visibility:",u),$(void 0))))}hasPublicLessons(t){return this.getPublicLessons(t,1).pipe(B(e=>e.totalCount>0),q(()=>$(!1)))}getPrivacySettings(){let t=new Q({"Content-Type":"application/json"});return this._http.get(`${this.url}users/lessons/privacy`,{headers:t}).pipe(B(e=>e),q(e=>(console.error("Error fetching privacy settings:",e),$({showLessonsInProfile:!0,hiddenLessonIds:[],allowCollaborationRequests:!0}))))}transformBackendResponse(t){let n=(t.lessons||[]).map(m=>({id:m._id,title:m.title,description:m.resume||m.description||"",knowledgeAreas:m.knowledge_area||[],userRole:m.userRole||"author",completionDate:new Date(m.completionDate||m.updated_at||m.created_at),rating:m.score||0,views:m.views||0,thumbnailUrl:m.image||void 0,state:m.state,level:Array.isArray(m.level)?m.level.join(", "):m.level||""}));return{lessons:n,stats:this.getEmptyStats(),totalCount:t.totalCount||n.length,hasMore:t.hasMore||!1,page:t.page||1,totalPages:t.totalPages||1}}determineUserRole(t,e){return t.user&&t.user._id===e,"author"}calculateStatsFromLessons(t){let e=t.filter(M=>M.state==="completed"),n={};e.forEach(M=>{M.knowledge_area&&M.knowledge_area.length>0&&M.knowledge_area.forEach(W=>{let zt=W.name||W;n[zt]=(n[zt]||0)+1})});let m=Object.entries(n).map(([M,W])=>({name:M,count:W})),u=e.reduce((M,W)=>M+(W.score||0),0),C=e.length>0?u/e.length:0,j=[{month:"Enero",completedCount:Math.floor(e.length*.3)},{month:"Febrero",completedCount:Math.floor(e.length*.4)},{month:"Marzo",completedCount:Math.floor(e.length*.3)}];return{totalCompleted:e.length,totalAsAuthor:e.length,totalAsCollaborator:0,totalAsReviewer:0,averageRating:C,knowledgeAreas:m,monthlyActivity:j}}getEmptyPublicLessonsResponse(){return{lessons:[],stats:this.getEmptyStats(),totalCount:0,hasMore:!1,page:1,totalPages:0}}getEmptyStats(){return{totalCompleted:0,totalAsAuthor:0,totalAsCollaborator:0,totalAsReviewer:0,averageRating:0,knowledgeAreas:[],monthlyActivity:[]}}static{this.\u0275fac=function(e){return new(e||i)(G(Kt))}}static{this.\u0275prov=st({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Wi=i=>["/inicio/lecciones/",i];function Gi(i,d){if(i&1){let t=b();o(0,"button",9),h("click",function(){g(t);let n=s();return _(n.toggleConfig())}),p(1,"i",10),l(2," Config "),r()}if(i&2){let t=s();S("active",t.showConfig)}}function Ji(i,d){if(i&1){let t=b();o(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14)(4,"input",15),Xt("ngModelChange",function(n){g(t);let m=s();return Qt(m.privacySettings.showLessonsInProfile,n)||(m.privacySettings.showLessonsInProfile=n),_(n)}),h("change",function(){g(t);let n=s();return _(n.updatePrivacySettings())}),r(),o(5,"label",16),l(6," Mostrar mis lecciones en mi perfil "),r()()()()()}if(i&2){let t=s();a(4),Jt("ngModel",t.privacySettings.showLessonsInProfile)}}function Qi(i,d){i&1&&(o(0,"div",17)(1,"div",18)(2,"div",19)(3,"span",20),l(4,"Cargando..."),r()(),o(5,"p",21),l(6,"Cargando lecciones y estad\xEDsticas..."),r()()())}function Xi(i,d){i&1&&(o(0,"div",17)(1,"div",22)(2,"div",23),p(3,"i",24),l(4," Hubo un error al cargar las lecciones. Por favor, intenta de nuevo. "),r()()())}function Zi(i,d){if(i&1){let t=b();o(0,"div",17)(1,"div",18),p(2,"i",25),o(3,"h4",26),l(4,"Lecciones ocultas"),r(),o(5,"p",21),l(6,"Has deshabilitado la visualizaci\xF3n de lecciones en tu perfil."),r(),o(7,"button",27),h("click",function(){g(t);let n=s(2);return _(n.toggleConfig())}),p(8,"i",28),l(9," Configurar visibilidad "),r()()()}}function Ki(i,d){if(i&1){let t=b();o(0,"div",17)(1,"div",18),p(2,"i",29),o(3,"h4",26),l(4,"Configura la visibilidad de tus lecciones"),r(),o(5,"p",21),l(6," Tienes lecciones completadas, pero ninguna est\xE1 configurada como p\xFAblica. "),r(),o(7,"button",27),h("click",function(){g(t);let n=s(2);return _(n.toggleConfig())}),p(8,"i",28),l(9," Configurar visibilidad "),r()()()}}function tn(i,d){if(i&1&&(o(0,"div",17)(1,"div",18),p(2,"i",30),o(3,"h4",26),l(4,"Sin lecciones p\xFAblicas"),r(),o(5,"p",21),l(6),r()()()),i&2){let t=s(2);a(6),w(" ",t.ownProfile==null?null:t.ownProfile.name," no ha compartido lecciones p\xFAblicamente. ")}}function en(i,d){i&1&&(o(0,"span"),l(1,"A\xFAn no has completado ninguna lecci\xF3n."),r())}function nn(i,d){i&1&&(o(0,"span"),l(1,"Este usuario no ha completado lecciones a\xFAn."),r())}function on(i,d){if(i&1&&(o(0,"div",17)(1,"div",18),p(2,"i",31),o(3,"h4",26),l(4,"Sin lecciones completadas"),r(),o(5,"p",21),f(6,en,2,0,"span",8)(7,nn,2,0,"span",8),r()()()),i&2){let t=s(2);a(6),c("ngIf",t.isOwner),a(),c("ngIf",!t.isOwner)}}function rn(i,d){if(i&1&&(o(0,"div"),f(1,Zi,10,0,"div",7)(2,Ki,10,0,"div",7)(3,tn,7,1,"div",7)(4,on,8,2,"div",7),r()),i&2){let t=s();a(),c("ngIf",t.status==="disabled_by_owner"),a(),c("ngIf",t.status==="no_public_lessons_owner"),a(),c("ngIf",t.status==="no_public_lessons_visitor"),a(),c("ngIf",t.status==="empty")}}function an(i,d){if(i&1&&(o(0,"span"),l(1),r()),i&2){let t=d.$implicit,e=s(4);N("badge bg-",e.getAreaBadgeClass(t)," px-3 py-2"),a(),D(" ",t.name," (",t.count,") ")}}function sn(i,d){if(i&1&&(o(0,"div",59)(1,"h6",39),l(2,"\xC1reas de Especializaci\xF3n:"),r(),o(3,"div",60),f(4,an,2,5,"span",61),r()()),i&2){let t=s(3);a(4),c("ngForOf",t.stats.knowledgeAreas)}}function ln(i,d){if(i&1&&(o(0,"div",33)(1,"div",43)(2,"h5",44),p(3,"i",45),l(4," Estad\xEDsticas "),r()(),o(5,"div",22)(6,"div",46)(7,"div",47)(8,"div",48)(9,"div",49),p(10,"i",50),r(),o(11,"h4",51),l(12),r(),o(13,"small",21),l(14,"Lecciones"),r()()(),o(15,"div",47)(16,"div",48)(17,"div",52),p(18,"i",53),r(),o(19,"h4",51),l(20),r(),o(21,"small",21),l(22,"\xC1reas"),r()()(),o(23,"div",47)(24,"div",48)(25,"div",54),p(26,"i",55),r(),o(27,"h4",51),l(28),r(),o(29,"small",21),l(30,"Como Autor"),r()()(),o(31,"div",47)(32,"div",48)(33,"div",56),p(34,"i",57),r(),o(35,"h4",51),l(36),r(),o(37,"small",21),l(38,"Rating"),r()()()(),f(39,sn,5,1,"div",58),r()()),i&2){let t=s(2);a(12),x(t.stats.totalCompleted),a(8),x(t.stats.knowledgeAreas.length),a(8),x(t.stats.totalAsAuthor),a(8),x(t.stats.averageRating.toFixed(1)),a(3),c("ngIf",t.stats.knowledgeAreas.length>0)}}function cn(i,d){if(i&1){let t=b();o(0,"button",62),h("click",function(){let n=g(t).$implicit,m=s(2);return _(m.setRoleFilter(n.value))}),o(1,"span",63),l(2),r(),l(3),r()}if(i&2){let t=d.$implicit,e=s(2);S("btn-primary",e.selectedRole===t.value)("btn-outline-secondary",e.selectedRole!==t.value),a(2),x(t.icon),a(),w(" ",t.label," ")}}function dn(i,d){if(i&1){let t=b();o(0,"button",64),h("click",function(){g(t);let n=s(2);return _(n.clearFilters())}),p(1,"i",65),l(2," Limpiar "),r()}}function mn(i,d){if(i&1&&(o(0,"span",85),l(1),r()),i&2){let t=s().$implicit,e=s(2);a(),D(" ",e.getRatingStars(t.rating)," ",t.rating.toFixed(1)," ")}}function pn(i,d){if(i&1&&(o(0,"p",86),l(1),r()),i&2){let t=s().$implicit,e=s(2);a(),w(" ",e.truncateDescription(t.description,150)," ")}}function fn(i,d){if(i&1&&(o(0,"span"),l(1),r()),i&2){let t=d.$implicit,e=s(4);N("badge bg-",e.getAreaBadgeClass(t)," text-dark"),a(),w(" ",e.getAreaName(t)," ")}}function un(i,d){if(i&1&&(o(0,"div",87),f(1,fn,2,4,"span",61),r()),i&2){let t=s().$implicit;a(),c("ngForOf",t.knowledgeAreas)}}function gn(i,d){if(i&1){let t=b();o(0,"button",88),h("click",function(){g(t);let n=s().$implicit,m=s(2);return _(m.toggleLessonVisibility(n.id))}),p(1,"i",89),o(2,"span"),l(3),r()()}if(i&2){let t=s().$implicit,e=s(2);S("btn-outline-warning",!e.isLessonHidden(t.id))("btn-warning",e.isLessonHidden(t.id)),c("title",e.isLessonHidden(t.id)?"Mostrar en perfil":"Ocultar del perfil"),a(),S("fa-eye",e.isLessonHidden(t.id))("fa-eye-slash",!e.isLessonHidden(t.id)),a(2),x(e.isLessonHidden(t.id)?"Mostrar":"Ocultar")}}function _n(i,d){i&1&&(o(0,"div",90),p(1,"i",91),o(2,"small"),l(3,"Esta lecci\xF3n est\xE1 oculta de tu perfil p\xFAblico"),r()())}function hn(i,d){if(i&1){let t=b();o(0,"div",66)(1,"div",67)(2,"div",22)(3,"div",68)(4,"div",69)(5,"div",70)(6,"h5",71)(7,"a",72),l(8),r()(),o(9,"div",73),p(10,"i",74),l(11),r()(),o(12,"div",75)(13,"small",21),p(14,"i",76),l(15),r(),o(16,"span"),l(17),r(),f(18,mn,2,2,"span",77),r(),f(19,pn,2,1,"p",78)(20,un,2,1,"div",79),r(),o(21,"div",80)(22,"div",81)(23,"button",82),h("click",function(){let n=g(t).$implicit,m=s(2);return _(m.goToLesson(n.id))}),p(24,"i",74),l(25," Ver m\xE1s "),r(),f(26,gn,4,10,"button",83),r()()(),f(27,_n,4,0,"div",84),r()()()}if(i&2){let t=d.$implicit,e=s(2);a(),S("border-warning",e.isOwner&&e.isLessonHidden(t.id)),a(6),c("routerLink",y(15,Wi,t.id)),a(),w(" ",t.title," "),a(3),w(" ",e.formatViews(t.views)," "),a(4),w(" Completada: ",e.formatDate(t.completionDate)," "),a(),N("badge bg-",e.getRoleBadgeClass(t.userRole),""),a(),w(" ",e.getRoleLabel(t.userRole)," "),a(),c("ngIf",t.rating>0),a(),c("ngIf",t.description),a(),c("ngIf",t.knowledgeAreas&&t.knowledgeAreas.length>0),a(6),c("ngIf",e.isOwner),a(),c("ngIf",e.isOwner&&e.isLessonHidden(t.id))}}function vn(i,d){if(i&1){let t=b();o(0,"div",92)(1,"button",93),h("click",function(){g(t);let n=s(2);return _(n.viewMore())}),p(2,"i",94),l(3," Ver m\xE1s lecciones "),r()()}}function bn(i,d){i&1&&(o(0,"div",92)(1,"small",21),p(2,"i",95),l(3," Has visto todas las lecciones disponibles "),r()())}function xn(i,d){if(i&1&&(o(0,"div"),f(1,ln,40,5,"div",32),o(2,"div",33)(3,"div",22)(4,"div",34)(5,"span",35)(6,"strong"),l(7,"Filtrar por:"),r()(),f(8,cn,4,6,"button",36)(9,dn,3,0,"button",37),r()()(),o(10,"div",38)(11,"div",39)(12,"small",21),p(13,"i",40),l(14),r()(),f(15,hn,28,17,"div",41)(16,vn,4,0,"div",42)(17,bn,4,0,"div",42),r()()),i&2){let t=s();a(),c("ngIf",t.stats),a(7),c("ngForOf",t.availableRoles),a(),c("ngIf",t.selectedRole!=="all"),a(5),R(" ",t.total," lecci\xF3n",t.total!==1?"es":""," encontrada",t.total!==1?"s":""," "),a(),c("ngForOf",t.lessons),a(),c("ngIf",!t.noMore&&t.page<t.pages),a(),c("ngIf",t.noMore&&t.lessons.length>0)}}var Oe=(()=>{class i{constructor(t,e,n,m,u){this._userService=t,this._lessonService=e,this._userLessonsService=n,this._route=m,this._router=u,this.lessons=[],this.stats=null,this.loading=!0,this.status="",this.isOwner=!1,this.showConfig=!1,this.hasPublicLessons=!1,this.activeFilters={},this.availableRoles=[{value:"all",label:"Todas",icon:"\u{1F4DA}"},{value:"author",label:"Como Autor",icon:"\u{1F468}\u200D\u{1F3EB}"},{value:"collaborator",label:"Colaborador",icon:"\u{1F91D}"},{value:"reviewer",label:"Revisor",icon:"\u{1F50D}"}],this.selectedRole="all",this.privacySettings={showLessonsInProfile:!0,hiddenLessonIds:[],allowCollaborationRequests:!0},this.page=1,this.pages=0,this.total=0,this.noMore=!1,this.unsubscribe$=new at,this.title="Lecciones",this.identity=this._userService.getIdentity(),this.token=this._userService.getToken(),this.url=U.url}ngOnInit(){this.loadPage()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}loadPage(){this._route.parent?.params.pipe(O(this.unsubscribe$)).subscribe(t=>{let e=t.id;e&&this.getUser(e)})}getUser(t){this._userService.getUser(t).pipe(O(this.unsubscribe$)).subscribe({next:e=>{e.user?(this.ownProfile=e.user,this.isOwner=this.identity._id===this.ownProfile._id,this.loadLessonsData()):(this.status="error",this.loading=!1)},error:e=>{console.error("Error fetching user:",e),this.status="error",this.loading=!1}})}loadLessonsData(){this.loading=!0;let t={lessons:this._userLessonsService.getPublicLessons(this.ownProfile._id,this.page,this.activeFilters),stats:this._userLessonsService.getLessonsStats(this.ownProfile._id)};this.isOwner&&(t.privacy=this._userLessonsService.getPrivacySettings()),jt(t).pipe(O(this.unsubscribe$)).subscribe({next:e=>{this.lessons=e.lessons.lessons,this.stats=e.stats,this.total=e.lessons.totalCount,this.pages=e.lessons.totalPages,this.hasPublicLessons=e.lessons.totalCount>0,this.noMore=!e.lessons.hasMore,e.privacy&&(this.privacySettings=e.privacy),this.determineStatus(),this.loading=!1,console.log("Lessons data loaded:",{lessons:this.lessons.length,stats:this.stats,isOwner:this.isOwner,privacy:this.privacySettings})},error:e=>{console.error("Error loading lessons data:",e),this.status="error",this.loading=!1,this.lessons=[],this.stats=null}})}determineStatus(){!this.privacySettings.showLessonsInProfile&&this.isOwner?this.status="disabled_by_owner":!this.hasPublicLessons&&this.isOwner?this.status="no_public_lessons_owner":!this.hasPublicLessons&&!this.isOwner?this.status="no_public_lessons_visitor":this.hasPublicLessons?this.status="success":this.status="empty"}setRoleFilter(t){this.selectedRole=t,this.activeFilters.role=t==="all"?void 0:t,this.page=1,this.loadLessonsData()}clearFilters(){this.selectedRole="all",this.activeFilters={},this.page=1,this.loadLessonsData()}toggleConfig(){this.showConfig=!this.showConfig}updatePrivacySettings(){this._userLessonsService.updatePrivacySettings(this.privacySettings).pipe(O(this.unsubscribe$)).subscribe({next:()=>{console.log("Privacy settings updated"),this.loadLessonsData()},error:t=>{console.error("Error updating privacy settings:",t)}})}toggleLessonVisibility(t){let e=this.privacySettings.hiddenLessonIds.includes(t);e?this.privacySettings.hiddenLessonIds=this.privacySettings.hiddenLessonIds.filter(n=>n!==t):this.privacySettings.hiddenLessonIds.push(t),this._userLessonsService.toggleLessonVisibility(t,!e).pipe(O(this.unsubscribe$)).subscribe({next:()=>{console.log(`Lesson ${t} visibility toggled`),setTimeout(()=>{this.loadLessonsData()},2500)},error:n=>{console.error("Error toggling lesson visibility:",n)}})}isLessonHidden(t){return this.privacySettings.hiddenLessonIds.includes(t)}viewMore(){!this.noMore&&this.page<this.pages&&(this.page+=1,this.loadMoreLessons())}loadMoreLessons(){this._userLessonsService.getPublicLessons(this.ownProfile._id,this.page,this.activeFilters).pipe(O(this.unsubscribe$)).subscribe({next:t=>{t.lessons&&t.lessons.length>0?(this.lessons=this.lessons.concat(t.lessons),this.noMore=!t.hasMore):this.noMore=!0},error:t=>{console.error("Error fetching more lessons:",t),this.noMore=!0}})}getRoleBadgeClass(t){return{author:"primary",collaborator:"success",reviewer:"info"}[t]||"secondary"}getRoleLabel(t){return{author:"Autor",collaborator:"Colaborador",reviewer:"Revisor"}[t]||t}getAreaBadgeClass(t){let e=this.hashCode(t.name||t),n=["primary","success","warning","info","secondary"];return n[Math.abs(e)%n.length]}getAreaName(t){return t.name||t}getRatingStars(t){let e=Math.floor(t),n=t%1!==0,m="\u2B50".repeat(e);return n&&(m+="\u2B50"),m||"\u2606\u2606\u2606\u2606\u2606"}formatViews(t){return t>=1e3?(t/1e3).toFixed(1)+"k":t.toString()}formatDate(t){return new Date(t).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})}truncateDescription(t,e=150){return t?t.length>e?t.substring(0,e)+"...":t:""}hashCode(t){let e=0;for(let n=0;n<t.length;n++){let m=t.charCodeAt(n);e=(e<<5)-e+m,e=e&e}return e}goToLesson(t){this._router.navigate(["/inicio/leccion",t])}static{this.\u0275fac=function(e){return new(e||i)(v(E),v(pe),v(It),v(k),v(T))}}static{this.\u0275cmp=F({type:i,selectors:[["lessons"]],standalone:!1,decls:12,vars:7,consts:[[1,"lessons-container"],[1,"lessons-header","card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"m-0","text-primary"],[1,"fas","fa-book","me-2"],["class","btn btn-outline-secondary btn-sm",3,"active","click",4,"ngIf"],["class","card-body border-top",4,"ngIf"],["class","card",4,"ngIf"],[4,"ngIf"],[1,"btn","btn-outline-secondary","btn-sm",3,"click"],[1,"fas","fa-cog","me-1"],[1,"card-body","border-top"],[1,"row"],[1,"col-md-6"],[1,"form-check"],["type","checkbox","id","showLessonsCheck",1,"form-check-input",3,"ngModelChange","change","ngModel"],["for","showLessonsCheck",1,"form-check-label"],[1,"card"],[1,"card-body","text-center","py-5"],["role","status",1,"spinner-border","text-primary","mb-3"],[1,"visually-hidden"],[1,"text-muted"],[1,"card-body"],[1,"alert","alert-danger","mb-0"],[1,"fas","fa-exclamation-triangle","me-2"],[1,"fas","fa-eye-slash","text-muted",2,"font-size","3rem"],[1,"text-muted","mt-3"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-cog","me-2"],[1,"fas","fa-book-open","text-muted",2,"font-size","3rem"],[1,"fas","fa-user-lock","text-muted",2,"font-size","3rem"],[1,"fas","fa-graduation-cap","text-muted",2,"font-size","3rem"],["class","card mb-4",4,"ngIf"],[1,"card","mb-4"],[1,"d-flex","flex-wrap","gap-2","align-items-center"],[1,"me-3"],["class","btn btn-sm",3,"btn-primary","btn-outline-secondary","click",4,"ngFor","ngForOf"],["class","btn btn-sm btn-outline-danger",3,"click",4,"ngIf"],[1,"lessons-list"],[1,"mb-3"],[1,"fas","fa-list","me-1"],["class","lesson-card mb-3",4,"ngFor","ngForOf"],["class","text-center mt-4",4,"ngIf"],[1,"card-header"],[1,"m-0"],[1,"fas","fa-chart-bar","me-2"],[1,"row","text-center"],[1,"col-6","col-md-3","mb-3"],[1,"stat-card","p-3","border","rounded"],[1,"stat-icon","text-primary","mb-2"],[1,"fas","fa-book",2,"font-size","2rem"],[1,"mb-1"],[1,"stat-icon","text-success","mb-2"],[1,"fas","fa-bullseye",2,"font-size","2rem"],[1,"stat-icon","text-warning","mb-2"],[1,"fas","fa-user-graduate",2,"font-size","2rem"],[1,"stat-icon","text-info","mb-2"],[1,"fas","fa-star",2,"font-size","2rem"],["class","mt-4",4,"ngIf"],[1,"mt-4"],[1,"d-flex","flex-wrap","gap-2"],[3,"class",4,"ngFor","ngForOf"],[1,"btn","btn-sm",3,"click"],[1,"me-1"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"fas","fa-times","me-1"],[1,"lesson-card","mb-3"],[1,"card","h-100"],[1,"row","align-items-start"],[1,"col"],[1,"d-flex","justify-content-between","align-items-start","mb-2"],[1,"card-title","mb-0"],[1,"text-decoration-none",3,"routerLink"],[1,"text-muted","small"],[1,"fas","fa-eye","me-1"],[1,"d-flex","flex-wrap","gap-2","align-items-center","mb-2"],[1,"fas","fa-calendar","me-1"],["class","text-warning small",4,"ngIf"],["class","card-text text-muted mb-3",4,"ngIf"],["class","d-flex flex-wrap gap-1 mb-2",4,"ngIf"],[1,"col-auto"],[1,"d-flex","flex-column","gap-2"],[1,"btn","btn-outline-primary","btn-sm",3,"click"],["class","btn btn-sm",3,"btn-outline-warning","btn-warning","title","click",4,"ngIf"],["class","alert alert-warning alert-sm mt-2 mb-0",4,"ngIf"],[1,"text-warning","small"],[1,"card-text","text-muted","mb-3"],[1,"d-flex","flex-wrap","gap-1","mb-2"],[1,"btn","btn-sm",3,"click","title"],[1,"fas","me-1"],[1,"alert","alert-warning","alert-sm","mt-2","mb-0"],[1,"fas","fa-eye-slash","me-2"],[1,"text-center","mt-4"],[1,"btn","btn-primary","px-4",3,"click"],[1,"fas","fa-plus","me-2"],[1,"fas","fa-check","me-1"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),p(4,"i",4),l(5),r(),f(6,Gi,3,2,"button",5),r(),f(7,Ji,7,1,"div",6),r(),f(8,Qi,7,0,"div",7)(9,Xi,5,0,"div",7)(10,rn,5,4,"div",8)(11,xn,18,9,"div",8),r()),e&2&&(a(5),w(" ",n.title," "),a(),c("ngIf",n.isOwner),a(),c("ngIf",n.isOwner&&n.showConfig),a(),c("ngIf",n.loading),a(),c("ngIf",!n.loading&&n.status==="error"),a(),c("ngIf",!n.loading&&n.status!=="error"&&n.status!=="success"),a(),c("ngIf",!n.loading&&n.status==="success"))},dependencies:[L,V,te,X,ee,Z],encapsulation:2})}}return i})();var Se=(()=>{class i{constructor(t){this.el=t,this.infiniteScrollDistance=2,this.infiniteScrollThrottle=50,this.scrolled=new $t,this.observer=null,this.throttleTimer=null}ngAfterViewInit(){this.observer=new IntersectionObserver(t=>{t.forEach(e=>{e.isIntersecting&&this.throttleEmit()})},{root:null,rootMargin:`${this.infiniteScrollDistance*100}px`,threshold:.1}),this.observer.observe(this.el.nativeElement)}ngOnDestroy(){this.observer&&(this.observer.unobserve(this.el.nativeElement),this.observer.disconnect()),this.throttleTimer&&clearTimeout(this.throttleTimer)}throttleEmit(){this.throttleTimer&&clearTimeout(this.throttleTimer),this.throttleTimer=setTimeout(()=>{this.scrolled.emit()},this.infiniteScrollThrottle)}static{this.\u0275fac=function(e){return new(e||i)(v(Bt))}}static{this.\u0275dir=qt({type:i,selectors:[["","appInfiniteScroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollThrottle:"infiniteScrollThrottle"},outputs:{scrolled:"scrolled"}})}}return i})();var Ie=i=>["/perfil",i];function wn(i,d){i&1&&p(0,"img",36)}function Pn(i,d){if(i&1&&p(0,"img",37),i&2){let t=s().$implicit,e=s(2);P("src",e.url+"get-image-user/"+t.user.picture,A)}}function yn(i,d){if(i&1){let t=b();o(0,"button",41),h("click",function(){g(t);let n=s(2).$implicit,m=s(2);return _(m.followUser(n.user._id))}),p(1,"i",42),l(2," Seguir "),r()}}function Mn(i,d){i&1&&(o(0,"span"),p(1,"i",45),l(2," Dejar de seguir "),r())}function On(i,d){i&1&&(o(0,"span"),p(1,"i",46),l(2," Siguiendo "),r())}function Sn(i,d){if(i&1){let t=b();o(0,"button",43),h("mouseenter",function(){g(t);let n=s(2).$implicit,m=s(2);return _(m.mouseEnter(n.user._id))})("mouseleave",function(){g(t);let n=s(4);return _(n.mouseLeave())})("click",function(){g(t);let n=s(2).$implicit,m=s(2);return _(m.getU(n.user._id))}),f(1,Mn,3,0,"span",44)(2,On,3,0,"ng-template",null,2,H),r()}if(i&2){let t=Y(3),e=s(2).$implicit,n=s(2);S("btn-danger",e.user._id==n.followUserOver),a(),c("ngIf",e.user._id==n.followUserOver)("ngIfElse",t)}}function In(i,d){if(i&1&&(o(0,"div",38),f(1,yn,3,0,"button",39)(2,Sn,4,4,"button",40),r()),i&2){let t=s().$implicit,e=s(2);a(),c("ngIf",e.followingUsersId.indexOf(t.user._id)<0),a(),c("ngIf",e.followingUsersId.indexOf(t.user._id)>=0)}}function En(i,d){if(i&1&&(o(0,"div")(1,"div",3)(2,"div",6)(3,"div",28)(4,"div",29)(5,"div",30),f(6,wn,1,0,"img",31)(7,Pn,1,1,"img",32),r()(),o(8,"div",33)(9,"a",34)(10,"h5"),l(11),r()(),o(12,"span"),l(13),r()(),f(14,In,3,2,"div",35),r()()()()),i&2){let t=d.$implicit,e=s(2);a(6),c("ngIf",!t.user.picture),a(),c("ngIf",t.user.picture),a(2),c("routerLink",y(10,Ie,t.user._id)),a(2),D("",t.user.name," ",t.user.surname,""),a(),N("badge ",e.labelProfile[t.user.role].class,""),a(),x(e.labelProfile[t.user.role].label),a(),c("ngIf",t.user._id!=e.identity._id)}}function kn(i,d){i&1&&(o(0,"div",6)(1,"div",47)(2,"div",48)(3,"span",49),l(4,"Loading..."),r()()()())}function Tn(i,d){if(i&1){let t=b();o(0,"div",24)(1,"div",25),h("scrolled",function(){g(t);let n=s();return _(n.onScrolld())}),f(2,En,15,12,"div",26)(3,kn,5,0,"div",27),r()()}if(i&2){let t=s();a(),c("infiniteScrollDistance",2)("infiniteScrollThrottle",50),a(),c("ngForOf",t.followers),a(),c("ngIf",t.loading)}}function Fn(i,d){i&1&&(o(0,"div",24)(1,"div",3)(2,"div",6)(3,"h4",51),l(4," El usuario no tiene seguidores. "),p(5,"i",52),r()()()())}function Ln(i,d){if(i&1&&f(0,Fn,6,0,"div",50),i&2){let t=s();c("ngIf",t.activeButton=="followers")}}function Vn(i,d){i&1&&p(0,"img",36)}function Un(i,d){if(i&1&&p(0,"img",37),i&2){let t=s().$implicit,e=s(2);P("src",e.url+"get-image-user/"+t.followed.picture,A)}}function An(i,d){if(i&1){let t=b();o(0,"button",41),h("click",function(){g(t);let n=s(2).$implicit,m=s(2);return _(m.followUser(n.followed._id))}),p(1,"i",42),l(2," Seguir "),r()}}function Dn(i,d){i&1&&(o(0,"span"),p(1,"i",45),l(2," Dejar de seguir "),r())}function zn(i,d){i&1&&(o(0,"span"),p(1,"i",46),l(2," Siguiendo "),r())}function Nn(i,d){if(i&1){let t=b();o(0,"button",43),h("mouseenter",function(){g(t);let n=s(2).$implicit,m=s(2);return _(m.mouseEnter(n.followed._id))})("mouseleave",function(){g(t);let n=s(4);return _(n.mouseLeave())})("click",function(){g(t);let n=s(2).$implicit,m=s(2);return _(m.getU(n.followed._id))}),f(1,Dn,3,0,"span",44)(2,zn,3,0,"ng-template",null,2,H),r()}if(i&2){let t=Y(3),e=s(2).$implicit,n=s(2);S("btn-danger",e.followed._id==n.followUserOver),a(),c("ngIf",e.followed._id==n.followUserOver)("ngIfElse",t)}}function Rn(i,d){if(i&1&&(o(0,"div",38),f(1,An,3,0,"button",39)(2,Nn,4,4,"button",40),r()),i&2){let t=s().$implicit,e=s(2);a(),c("ngIf",e.followingUsersId.indexOf(t.followed._id)<0),a(),c("ngIf",e.followingUsersId.indexOf(t.followed._id)>=0)}}function jn(i,d){if(i&1&&(o(0,"div")(1,"div",3)(2,"div",6)(3,"div",28)(4,"div",29)(5,"div",30),f(6,Vn,1,0,"img",31)(7,Un,1,1,"img",32),r()(),o(8,"div",33)(9,"a",34)(10,"h5"),l(11),r()(),o(12,"span"),l(13),r()(),f(14,Rn,3,2,"div",35),r()()()()),i&2){let t=d.$implicit,e=s(2);a(6),c("ngIf",!t.followed.picture),a(),c("ngIf",t.followed.picture),a(2),c("routerLink",y(10,Ie,t.followed._id)),a(2),D("",t.followed.name," ",t.followed.surname,""),a(),N("badge ",e.labelProfile[t.followed.role].class,""),a(),x(e.labelProfile[t.followed.role].label),a(),c("ngIf",t.followed._id!=e.identity._id)}}function $n(i,d){i&1&&(o(0,"div",6)(1,"div",47)(2,"div",48)(3,"span",49),l(4,"Loading..."),r()()()())}function Bn(i,d){if(i&1){let t=b();o(0,"div",24)(1,"div",25),h("scrolled",function(){g(t);let n=s();return _(n.onScrolld())}),f(2,jn,15,12,"div",26)(3,$n,5,0,"div",27),r()()}if(i&2){let t=s();a(),c("infiniteScrollDistance",2)("infiniteScrollThrottle",50),a(),c("ngForOf",t.following),a(),c("ngIf",t.loading)}}function qn(i,d){i&1&&(o(0,"div",24)(1,"div",3)(2,"div",6)(3,"h4",51),l(4," El usuario no esta siguiendo a ning\xFAn otro usuario. "),p(5,"i",52),r()()()())}function Yn(i,d){if(i&1&&f(0,qn,6,0,"div",50),i&2){let t=s();c("ngIf",t.activeButton=="following")}}var Dt=(()=>{class i{constructor(t,e,n,m){this._userService=t,this._followService=e,this._route=n,this._router=m,this.ownProfile=new K,this.labelProfile=St,this.loading=!1,this.followers=[],this.followingUsersId=[],this.following=[],this.throttle=0,this.distance=2,this.title="Red",this.identity=this._userService.getIdentity(),this.token=this._userService.getToken(),this.url=U.url,this.activeButton="followers",this.followingPage=1,this._route.parent.params.subscribe({next:u=>{let C=u.id;this.ownProfile._id=C}})}ngOnInit(){this.actualPage(),this.loadPage(),this._route.queryParams.subscribe({next:t=>{let e=t.tab;e==="following"?(this.activeButton="following",this.setActiveButton("following")):e==="followers"?(this.activeButton="followers",this.setActiveButton("followers")):(this.activeButton="followers",this.setActiveButton("followers"))}})}setActiveButton(t){this.activeButton=t,this.activeButton=="followers"?this.getFollowerUsers(this.page||1):this.getFollowingUsers(this.page||1)}loadPage(){this._route.parent.params.subscribe({next:t=>{let e=t.id;this.getUser(e)}}),this._route.params.subscribe({next:t=>{t.reload&&this._router.navigate(["perfil",this.ownProfile._id,"red"])}})}actualPage(){this._route.parent.params.subscribe({next:t=>{let e=+t.page;this.page=e,e?(this.nextPage=e+1,this.prevPage=e-1,this.prevPage<=0&&(this.prevPage=1)):(this.page=1,this.nextPage=this.page+1)}})}getUser(t){this._userService.getUser(t).subscribe({next:e=>{e.user?(this.ownProfile=e.user,this.followersPage=1):(this.status="error",this.ownProfile=this.identity)},error:e=>{console.log(e),this.ownProfile=this.identity}})}getFollowingUsers(t){this._followService.getFollowingUsers(this.token,this.ownProfile._id,t).subscribe({next:e=>{if(e)if(t==1)this.status="success",this.following=e.follows,this.followingPages=e.totalPages||e.pages,this.followingTotal=e.total;else for(let n in e.follows)this.following.push(e.follows[n]);else this.status="error"},error:e=>{console.log(e)}})}getFollowerUsers(t){this._followService.getFollowersUsers(this.token,this.ownProfile._id,t).subscribe({next:e=>{if(e)if(t==1)this.status="success",this.followers=e.follows,this.followersPages=e.totalPages||e.pages,this.followersTotal=e.total,this.followingUsersId=e.following;else for(let n in e.follows)this.followers.push(e.follows[n]);else this.status="error"},error:e=>{console.log(e)}})}mouseEnter(t){this.followUserOver=t}mouseLeave(){this.followUserOver=0}followUser(t){let e=new ve;e.user=this.identity._id,e.followed=t,this._followService.addFollow(this.token,e).subscribe({next:n=>{n&&(this.getFollowerUsers(this.page),this.getFollowingUsers(this.page))},error:n=>{console.log(n)}})}getU(t){this.TempU=t}unfollow(){this.unfollowUser(this.TempU),this.TempU=""}onScrolld(){this.activeButton=="followers"?(this.followersPage+=1,this.followersPage<=this.followersPages&&(this.loading=!0,this.getFollowerUsers(this.followersPage),this.loading=!1)):(this.followingPage+=1,this.followingPage<=this.followingPages&&(this.loading=!0,this.getFollowingUsers(this.followingPage),this.loading=!1))}onScroll(){}unfollowUser(t){this._followService.removeFollow(this.token,t).subscribe({next:e=>{e&&(this.getFollowerUsers(this.page),this.getFollowingUsers(this.page))},error:e=>{console.log(e)}})}static{this.\u0275fac=function(e){return new(e||i)(v(E),v(yt),v(k),v(T))}}static{this.\u0275cmp=F({type:i,selectors:[["follows"]],standalone:!1,decls:36,vars:5,consts:[["noFollowers",""],["noFollowing",""],["following",""],[1,"card"],[1,"card-header"],[1,"m-0","text-primary","fw-bolder"],[1,"card-body"],[1,"row"],[1,"col-6","pe-1"],[1,"btn","w-100","btn-info",3,"click"],[1,"col-6","ps-1"],["class","mt-3",4,"ngIf","ngIfElse"],["id","unfollowU","tabindex","-1","role","dialog","aria-labelledby","unfollowUsuario","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","unfollowUsr",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],["role","alert",1,"alert","alert-warning","mb-0"],[1,"fas","fa-exclamation-triangle","icon-message","me-2"],[1,"modal-footer"],["data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"],["data-bs-dismiss","modal",1,"btn","btn-primary","text-white"],[1,"mt-3"],["appInfiniteScroll","",3,"scrolled","infiniteScrollDistance","infiniteScrollThrottle"],[4,"ngFor","ngForOf"],["class","card-body",4,"ngIf"],[1,"row","align-items-center"],[1,"col-2"],[1,"picture","rounded-circle","border-4","overflow-hidden",2,"width","80px","height","80px"],["class","img-fluid","src","assets/images/user-default.png",4,"ngIf"],["class","img-fluid",3,"src",4,"ngIf"],[1,"col"],[1,"text-primary",3,"routerLink"],["class","col text-center",4,"ngIf"],["src","assets/images/user-default.png",1,"img-fluid"],[1,"img-fluid",3,"src"],[1,"col","text-center"],["type","button","class","btn btn-outline-primary btn-sm",3,"click",4,"ngIf"],["type","button","class","btn btn-primary btn-sm","data-bs-toggle","modal","data-bs-target","#unfollowU",3,"btn-danger","mouseenter","mouseleave","click",4,"ngIf"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"fas","fa-plus-square","me-2"],["type","button","data-bs-toggle","modal","data-bs-target","#unfollowU",1,"btn","btn-primary","btn-sm",3,"mouseenter","mouseleave","click"],[4,"ngIf","ngIfElse"],[1,"fas","fa-minus-square","me-2"],[1,"fas","fa-check-square","me-2"],[1,"text-muted","text-center"],["role","status",1,"spinner-border",2,"width","3rem","height","3rem"],[1,"visually-hidden"],["class","mt-3",4,"ngIf"],[1,"text-muted"],[1,"fas","fa-frown-open","icon-message"]],template:function(e,n){if(e&1){let m=b();o(0,"div",3)(1,"div",4)(2,"h3",5),l(3),r()(),o(4,"div",6)(5,"div",7)(6,"div",8)(7,"button",9),h("click",function(){return g(m),_(n.setActiveButton("followers"))}),o(8,"h5"),l(9," Seguidores "),r()()(),o(10,"div",10)(11,"button",9),h("click",function(){return g(m),_(n.setActiveButton("following"))}),o(12,"h5"),l(13," Siguiendo "),r()()()(),f(14,Tn,4,4,"div",11)(15,Ln,1,1,"ng-template",null,0,H)(17,Bn,4,4,"div",11)(18,Yn,1,1,"ng-template",null,1,H),r()(),o(20,"div",12)(21,"div",13)(22,"div",14)(23,"div",15)(24,"h5",16),l(25,"Dejar de seguir a esta persona"),r(),p(26,"button",17),r(),o(27,"div",18)(28,"div",19),p(29,"i",20),l(30," No ver\xE1s sus publicaciones ni su actividad en el inicio de Reddin\xE1mica, \xBFdeseas continuar? "),r()(),o(31,"div",21)(32,"button",22),h("click",function(){return g(m),_(n.unfollow())}),l(33,"S\xED"),r(),o(34,"button",23),l(35,"No"),r()()()()()}if(e&2){let m=Y(16),u=Y(19);a(3),x(n.title),a(11),c("ngIf",n.followers&&n.activeButton=="followers"&&n.followers.length>0)("ngIfElse",m),a(3),c("ngIf",n.following&&n.activeButton=="following"&&n.following.length>0)("ngIfElse",u)}},dependencies:[L,V,Z,Se],encapsulation:2})}}return i})();var Et=(()=>{class i{constructor(t,e,n){this._router=t,this._route=e,this._userService=n}canActivate(){let t=this._userService.getIdentity(),e=this._router.url.split("/");return this.id=e[2],t&&this.id&&t._id==this.id?!0:(this._router.navigate(["/perfil",t._id]),!1)}static{this.\u0275fac=function(e){return new(e||i)(G(T),G(k),G(E))}}static{this.\u0275prov=st({token:i,factory:i.\u0275fac})}}return i})();var Hn=["publicationsContainer"],Wn=i=>({"is-invalid":i});function Gn(i,d){if(i&1&&(o(0,"div",53),p(1,"i",54),l(2),r()),i&2){let t=s(2);a(2),w(" ",t.deletedMsg," ")}}function Jn(i,d){if(i&1&&(o(0,"div",55),p(1,"i",54),l(2),r()),i&2){let t=s(2);a(2),w(" ",t.warningMsg," ")}}function Qn(i,d){i&1&&p(0,"img",56)}function Xn(i,d){if(i&1&&p(0,"img",57),i&2){let t=s(2);P("src",t.url+"get-image-user/"+t.identity.picture,A)}}function Zn(i,d){if(i&1&&(o(0,"div",58)(1,"div",59,1),l(3),r()()),i&2){let t=s(2);a(),dt("width",t.barWidth),a(2),x(t.barWidth)}}function Kn(i,d){i&1&&(o(0,"div"),l(1," Es necesario escribir algo o cargar una imagen para poder crear la publicaci\xF3n. "),r())}function to(i,d){i&1&&(o(0,"div"),l(1," Archivo inv\xE1lido, solo se permite cargar im\xE1genes con extensi\xF3n jpg, png o gif. "),r())}function eo(i,d){if(i&1&&(o(0,"div"),l(1),r()),i&2){let t=s(3);a(),w(" El archivo es demasiado grande, el tama\xF1o maximo permitido es de ",t.MAX_FILE_SIZE,"MB. ")}}function io(i,d){if(i&1&&(o(0,"div"),l(1),r()),i&2){let t,e=s(3);a(),w(" La publicaci\xF3n es demasiado larga, supera las 100 l\xEDneas (actualmente: ",(t=e.postForm.get("textPost"))==null||t.errors==null||t.errors.maxLines==null?null:t.errors.maxLines.actualLines," l\xEDneas) ")}}function no(i,d){if(i&1&&(o(0,"div",60),f(1,Kn,2,0,"div",61)(2,to,2,0,"div",61)(3,eo,2,1,"div",61)(4,io,2,1,"div",61),r()),i&2){let t,e=s(2);a(),c("ngIf",e.formError),a(),c("ngIf",e.typeError),a(),c("ngIf",e.maxSizeError),a(),c("ngIf",(t=e.postForm.get("textPost"))==null?null:t.hasError("maxLines"))}}function oo(i,d){if(i&1&&(o(0,"small",62),p(1,"i",63),l(2),r()),i&2){let t=s(2);a(2),w(" ",t.filesToUpload[0].name," ")}}function ro(i,d){i&1&&(o(0,"div",64),p(1,"i",54),l(2," Hubo un error creando la publicaci\xF3n. Intentalo de nuevo. "),r())}function ao(i,d){i&1&&(o(0,"div",65),p(1,"i",66),l(2," La publicaci\xF3n se ha creado correctamente. "),r())}function so(i,d){if(i&1){let t=b();o(0,"div",24,0)(2,"form",25),h("ngSubmit",function(){g(t);let n=s();return _(n.onSubmit())}),o(3,"div",26)(4,"label",27)(5,"strong"),l(6,"Crear publicaci\xF3n: "),r()()(),f(7,Gn,3,1,"div",28)(8,Jn,3,1,"div",29),o(9,"div",30)(10,"div",31)(11,"div",32)(12,"a",33)(13,"div",34),f(14,Qn,1,0,"img",35)(15,Xn,1,1,"img",36),r()()(),o(16,"div",37)(17,"textarea",38),h("input",function(){g(t);let n=s();return _(n.onChanges())}),r(),f(18,Zn,4,3,"div",39)(19,no,5,4,"div",40)(20,oo,3,1,"small",41),r()(),o(21,"div",42)(22,"div",43)(23,"div",44),f(24,ro,3,0,"div",45)(25,ao,3,0,"div",46),r(),o(26,"div",47)(27,"label",48),p(28,"i",49),o(29,"input",50),h("change",function(n){g(t);let m=s();return _(m.fileChangeEvent(n))})("click",function(){g(t);let n=s();return _(n.setUpload())}),r()()(),o(30,"div",51)(31,"button",52),l(32,"Publicar"),r()()()()()()()}if(i&2){let t,e,n=s();a(2),c("formGroup",n.postForm),a(5),c("ngIf",n.status==="deleted"),a(),c("ngIf",n.status==="warning"),a(6),c("ngIf",!n.identity.picture),a(),c("ngIf",n.identity.picture),a(2),c("ngClass",y(12,Wn,n.submitted&&(n.formError||n.typeError||n.maxSizeError||((t=n.postForm.get("textPost"))==null?null:t.hasError("maxLines"))))),a(),c("ngIf",n.filesToUpload!=null||n.barWidth!="0%"),a(),c("ngIf",n.submitted&&(n.formError||n.typeError||n.maxSizeError||((e=n.postForm.get("textPost"))==null?null:e.hasError("maxLines")))),a(),c("ngIf",n.filesToUpload.length>0),a(4),c("ngIf",n.status==="error"),a(),c("ngIf",n.status==="success"),a(6),c("disabled",n.submitted)}}function lo(i,d){i&1&&(o(0,"div",30)(1,"h4",62),l(2," No hay publicaciones que mostrar. Comparte lo que quieras con los miembros de RedDin\xE1mica. "),p(3,"i",67),r()())}function co(i,d){if(i&1&&(o(0,"div",30,0)(2,"h4",62),l(3),p(4,"i",67),r()()),i&2){let t=s();a(3),w(" Parece que ",t.ownProfile.name," no ha publicado nada a\xFAn. ")}}function mo(i,d){if(i&1){let t=b();o(0,"div")(1,"app-publication-card",68),h("onDelete",function(n){g(t);let m=s();return _(m.setDelete(n))})("onDeleteComment",function(n){g(t);let m=s();return _(m.setDeleteComment(n))})("onError",function(n){g(t);let m=s();return _(m.setErrorMessage(n))}),r()()}if(i&2){let t=d.$implicit,e=d.first,n=s();a(),c("publication",t)("identity",n.identity)("showDeleteButton",n.identity._id==n.ownProfile._id),Yt("id",e?"publicationsContainer":null)}}function po(i,d){if(i&1){let t=b();o(0,"button",72),h("click",function(){g(t);let n=s(2);return _(n.viewMore())}),l(1,"Ver m\xE1s publicaciones"),r()}}function fo(i,d){i&1&&(o(0,"span"),l(1,"Has visto todas tus publicaciones"),r())}function uo(i,d){if(i&1&&(o(0,"span"),l(1),r()),i&2){let t=s(3);a(),w("Has visto todas las publicaciones de ",t.ownProfile.name,"")}}function go(i,d){if(i&1&&(o(0,"div",73),p(1,"i",74),f(2,fo,2,0,"span",61)(3,uo,2,1,"span",61),r()),i&2){let t=s(2);a(2),c("ngIf",t.identity._id==t.ownProfile._id),a(),c("ngIf",t.identity._id!=t.ownProfile._id)}}function _o(i,d){if(i&1&&(o(0,"div",69),f(1,po,2,0,"button",70)(2,go,4,2,"div",71),r()),i&2){let t=s();a(),c("ngIf",!t.noMore),a(),c("ngIf",t.noMore&&t.publications.length>0)}}var rt=(()=>{class i{constructor(t,e,n,m,u,C){this._userService=t,this._publicationService=e,this._commentService=n,this._uploadService=m,this._route=u,this._router=C,this.ownProfile=new K,this.publications=[],this.noMore=!1,this.MAX_FILE_SIZE=20,this.maxSize=20*1024*1024,this.maxSizeError=!1,this.deletedMsg="Se ha eliminado la publicaci\xF3n",this.warningMsg="Se estan subiendo los archivos, por favor espera mientras finaliza y evita cerrar esta ventana.",this.barWidth="0%",this.unsubscribe$=new at,this.filesToUpload=[],this.formError=!1,this.typeError=!1,this.title="Publicaciones",this.identity=this._userService.getIdentity(),this.token=this._userService.getToken(),this.url=U.url,this.page=1,this.itemsPerPage=5,this.publication=new Vt("",this.identity._id),this.filesToUpload=[];let j=new Ct;this.postForm=j.group({textPost:["",[I.required,this.maxLinesValidator(10)]],filePost:[""]})}get f(){return this.postForm.controls}ngOnInit(){this._route.parent?.params.pipe(O(this.unsubscribe$)).subscribe(t=>{let e=t.id;e&&(this.resetPagination(),this.loadUserData(e))})}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}ngAfterViewInit(){this._route.queryParams.pipe(O(this.unsubscribe$)).subscribe(t=>{t.scrollTo==="top"&&setTimeout(()=>{let e=this.publicationsContainer?.nativeElement;if(e)e.scrollIntoView({behavior:"smooth",block:"start"});else{let n=document.getElementById("publicationsContainer");n&&n.scrollIntoView({behavior:"smooth",block:"start"})}this._router.navigate([],{relativeTo:this._route,queryParams:{},replaceUrl:!0})},300)})}loadUserData(t){this.getUser(t)}onChanges(){this.postForm.valueChanges.subscribe(t=>{t.textPost&&t.textPost.length>0&&(this.formError=!1)})}getUser(t){this._userService.getUser(t).pipe(O(this.unsubscribe$)).subscribe(e=>{e.user?(this.ownProfile=e.user,this.getUserPublications(this.page)):this.status="error"},e=>{console.log(e),this._router.navigate(["/home"])})}getUserPublications(t,e=!1){this._publicationService.getUserPublications(this.token,this.ownProfile._id,t,10,5).pipe(O(this.unsubscribe$)).subscribe(n=>{n.publications?(this.total=n.totalItems,this.pages=n.totalPages,this.itemsPerPage=n.itemsPerPage,this.noMore=this.page>=this.pages||n.publications.length===0||this.page>1&&n.publications.length<this.itemsPerPage,e?n.publications.length>0&&(this.publications=this.publications.concat(n.publications)):this.publications=n.publications,t>this.pages&&this._router.navigate(["/home"]),console.log(`User publications - Page ${this.page}/${this.pages}, Publications: ${n.publications.length}, NoMore: ${this.noMore}`)):(this.status="error",this.noMore=!0)},n=>{var m=n;console.log(m),m!=null&&(this.status="error",this.noMore=!0)})}setUpload(){}fileChangeEvent(t){if(this.filesToUpload=t.target.files,this.formError=!1,this.typeError=!1,this.maxSizeError=!1,this.filesToUpload&&this.filesToUpload.length>0){for(let e of this.filesToUpload)if(!this.isValidFileType(e)){this.typeError=!0,this.filesToUpload=[],t.target.value="";return}}}onSubmit(){this.submitted=!0,this.formError=!1,this.typeError=!1,this.maxSizeError=!1;let t=this.postForm.value.textPost,e=this.filesToUpload&&this.filesToUpload.length>0;if((!t||t.trim().length===0)&&!e){this.formError=!0,this.submitted=!1;return}if(e)for(let n of this.filesToUpload){if(!this.isValidFileType(n)){this.typeError=!0,this.submitted=!1;return}if(n.size>this.maxSize){this.maxSizeError=!0,this.submitted=!1;return}}this.publication=new Vt(t||"",this.identity._id),this.savePublication()}savePublication(){this._publicationService.addPost(this.token,this.publication).pipe(O(this.unsubscribe$)).subscribe(t=>{if(t.publication){let e=t.publication._id;this.filesToUpload&&this.filesToUpload.length>0?this.uploadFiles(e):this.onPublicationSuccess()}else this.status="error",this.submitted=!1},t=>{console.error("Error saving publication:",t),this.status="error",this.submitted=!1})}uploadFiles(t){this._uploadService.makeFileRequest(this.url+"upload-file-post/"+t,[],this.filesToUpload,this.token,"image").subscribe(e=>{this.onPublicationSuccess()},e=>{console.error("Error uploading file:",e),this.status="error",this.submitted=!1})}onPublicationSuccess(){this.postForm.reset(),this.getUserPublications(1),this.status="success",this.filesToUpload=[],this.submitted=!1}setDelete(t){this.tempPublicationId=t;let e=document.getElementById("delete");e&&new window.bootstrap.Modal(e).show()}deletePost(){this._publicationService.removePost(this.token,this.tempPublicationId).pipe(O(this.unsubscribe$)).subscribe(t=>{let e=this.publications.findIndex(n=>n&&n._id===(t?.publication?._id||this.tempPublicationId));e!==-1?this.publications.splice(e,1):this.getUserPublications(1),this.tempPublicationId=null},t=>{console.log(t)})}setDeleteComment(t){this.tempCommentId=t;let e=document.getElementById("deleteComment");e&&new window.bootstrap.Modal(e).show()}deleteComment(){this.tempCommentId&&this._commentService.removeComment(this.token,this.tempCommentId).pipe(O(this.unsubscribe$)).subscribe({next:()=>{this.removeCommentFromPublications(this.tempCommentId),this.tempCommentId=null},error:t=>{console.error("Error al eliminar comentario/respuesta:",t),this.getUserPublications(1),this.tempCommentId=null}})}removeCommentFromPublications(t){if(!(!this.publications||!Array.isArray(this.publications))){for(let e of this.publications)if(e?.comments&&Array.isArray(e.comments)&&this.removeCommentFromList(e.comments,t))return}}removeCommentFromList(t,e){if(!Array.isArray(t)||!e)return!1;let n=t.findIndex(m=>m&&m._id===e);if(n!==-1)return t.splice(n,1),!0;for(let m of t)if(m?.replies&&Array.isArray(m.replies)){let u=m.replies.findIndex(C=>C&&C._id===e);if(u!==-1)return m.replies.splice(u,1),!0}return!1}setErrorMessage(t){console.error("Error from publication-card:",t)}viewMore(){if(this.noMore||this.page>=this.pages){console.log("No more publications to load");return}this.page+=1,this.page>=this.pages&&(this.noMore=!0),this.getUserPublications(this.page,!0)}maxLinesValidator(t){return e=>{let n=e.value;return n&&n.split(`
`).length>t?{maxLines:{actualLines:n.split(`
`).length}}:null}}checkNoMorePublications(t,e,n,m){let u=t>=e,C=n===0,j=t>1&&n<m,M=e>0&&t>e;return u||C||j||M}resetPagination(){this.page=1,this.noMore=!1,this.publications=[],this.total=0,this.pages=0}isValidFileType(t){if(!["image/jpeg","image/jpg","image/png","image/gif"].includes(t.type.toLowerCase()))return!1;let n=t.name.toLowerCase();return[".jpg",".jpeg",".png",".gif"].some(C=>n.endsWith(C))}static{this.\u0275fac=function(e){return new(e||i)(v(E),v(de),v(me),v(Pt),v(k),v(T))}}static{this.\u0275cmp=F({type:i,selectors:[["app-publications"]],viewQuery:function(e,n){if(e&1&&mt(Hn,5),e&2){let m;pt(m=ft())&&(n.publicationsContainer=m.first)}},decls:37,vars:5,consts:[["publicationsContainer",""],["progress",""],["id","new-post","class","card mb-3",4,"ngIf"],["class","card-body",4,"ngIf"],[4,"ngFor","ngForOf"],["class","text-center",4,"ngIf"],["id","delete","tabindex","-1","role","dialog","aria-labelledby","delete","aria-hidden","true","data-bs-backdrop","static","data-bs-keyboard","false",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],["id","deleteTitle",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["role","alert",1,"alert","alert-warning","mb-0"],[1,"fas","fa-exclamation-triangle","icon-message","me-2"],[1,"modal-footer"],["data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"],["data-bs-dismiss","modal",1,"btn","btn-primary","text-white",3,"click"],["id","deleteComment","tabindex","-1","role","dialog","aria-labelledby","deleteCommentTitle","aria-hidden","true","data-bs-backdrop","static","data-bs-keyboard","false",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],["id","deleteCommentTitle",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],["data-bs-dismiss","modal",1,"btn","btn-primary","text-white"],["id","new-post",1,"card","mb-3"],["enctype","multipart/form-data",3,"ngSubmit","formGroup"],[1,"card-header"],["for","textPost",1,"card-title","m-0",2,"font-size","1.5em"],["class","alert alert-primary fade show text-center","role","alert",4,"ngIfSuccessMessage","ngIf"],["class","alert alert-warning fade show text-center","role","alert",4,"ngIfSuccessMessage","ngIf"],[1,"card-body"],[1,"mb-3","row","mb-0","justify-content-center"],[1,"col-2","align-items-center"],[1,"nav-link","d-flex"],[1,"flex-shrink-0","rounded-circle","border-1","overflow-hidden","me-2",2,"width","55px","height","55px"],["class","img-fluid","src","assets/images/user-default.png",4,"ngIf"],["class","img-fluid",3,"src",4,"ngIf"],[1,"col-10","ps-0"],["formControlName","textPost","id","textPost","rows","3",1,"form-control",3,"input","ngClass"],["class","progress",4,"ngIf"],["class","invalid-feedback",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"text-end","py-1","px-0","bg-transparent"],[1,"mb-3","row","mb-0","d-flex","align-items-center"],[1,"col-9"],["class","alert alert-danger fade show text-center m-0","role","alert",4,"ngIfSuccessMessage","ngIf"],["class","alert alert-success fade show text-center m-0","role","alert",4,"ngIfSuccessMessage","ngIf"],[1,"col-1","bg-transparent"],[1,"m-0",2,"font-size","2.2em"],[1,"fas","fa-image","text-success",2,"cursor","pointer"],["formControlName","filePost","type","file","name","image",1,"form-control",2,"display","none",3,"change","click"],[1,"col","bg-transparent"],["type","submit",1,"btn","btn-success","w-100",3,"disabled"],["role","alert",1,"alert","alert-primary","fade","show","text-center"],[1,"fas","fa-times-circle","icon-message","me-2"],["role","alert",1,"alert","alert-warning","fade","show","text-center"],["src","assets/images/user-default.png",1,"img-fluid"],[1,"img-fluid",3,"src"],[1,"progress"],["role","progressbar","aria-valuenow","barWidth","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","progress-bar-animated"],[1,"invalid-feedback"],[4,"ngIf"],[1,"text-muted"],[1,"fas","fa-paperclip"],["role","alert",1,"alert","alert-danger","fade","show","text-center","m-0"],["role","alert",1,"alert","alert-success","fade","show","text-center","m-0"],[1,"fas","fa-check-circle","icon-message","me-2"],[1,"fas","fa-laugh","icon-message"],[3,"onDelete","onDeleteComment","onError","publication","identity","showDeleteButton"],[1,"text-center"],["class","btn btn-primary",3,"click",4,"ngIf"],["class","text-muted mt-3",4,"ngIf"],[1,"btn","btn-primary",3,"click"],[1,"text-muted","mt-3"],[1,"fas","fa-check-circle","me-2"]],template:function(e,n){e&1&&(f(0,so,33,14,"div",2)(1,lo,4,0,"div",3)(2,co,5,1,"div",3)(3,mo,2,4,"div",4)(4,_o,3,2,"div",5),o(5,"div",6)(6,"div",7),h("click",function(u){return u.stopPropagation()}),o(7,"div",8),h("click",function(u){return u.stopPropagation()}),o(8,"div",9)(9,"h5",10),l(10,"Eliminar publicaci\xF3n"),r(),o(11,"button",11),h("click",function(u){return u.stopPropagation()}),r()(),o(12,"div",12)(13,"div",13),p(14,"i",14),l(15," \xBFEsta seguro que desea eliminar la publicaci\xF3n? "),r()(),o(16,"div",15)(17,"button",16),h("click",function(u){return u.stopPropagation(),n.deletePost()}),l(18,"S\xED"),r(),o(19,"button",17),h("click",function(u){return u.stopPropagation()}),l(20,"No"),r()()()()(),o(21,"div",18)(22,"div",19)(23,"div",20)(24,"div",9)(25,"h5",21),l(26,"Eliminar comentario"),r(),p(27,"button",22),r(),o(28,"div",12)(29,"div",13),p(30,"i",14),l(31," \xBFEst\xE1 seguro que desea eliminar el comentario/respuesta? "),r()(),o(32,"div",15)(33,"button",16),h("click",function(){return n.deleteComment()}),l(34,"S\xED"),r(),o(35,"button",23),l(36,"No"),r()()()()()),e&2&&(c("ngIf",n.identity._id==n.ownProfile._id),a(),c("ngIf",n.identity._id==n.ownProfile._id&&n.publications.length==0),a(),c("ngIf",n.identity._id!=n.ownProfile._id&&n.publications.length==0),a(),c("ngForOf",n.publications),a(),c("ngIf",n.publications&&n.publications.length>0))},dependencies:[gt,ut,L,V,wt,vt,_t,X,ht,bt,xt,Mt],encapsulation:2})}}return i})();var ho=[{path:":id",component:we,canActivate:[fe],children:[{path:"",redirectTo:"publicaciones",pathMatch:"full"},{path:"publicaciones",component:rt},{path:"editar",component:ye,canActivate:[Et]},{path:"info",component:Me},{path:"lecciones",component:Oe},{path:"posts",component:rt},{path:"red",component:Dt},{path:"red/:reload",component:Dt},{path:"**",redirectTo:"publicaciones"}]}],Ee=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=ct({type:i})}static{this.\u0275inj=lt({imports:[Lt.forChild(ho),Lt]})}}return i})();var Wr=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=ct({type:i})}static{this.\u0275inj=lt({providers:[Et,It],imports:[gt,ne,wt,Ee,ae,_e,he,Mt,rt]})}}return i})();export{Wr as ProfileModule};
