import{a as U}from"./chunk-YM3PCZES.js";import{a as Ce}from"./chunk-ZTCIQEDA.js";import{a as $}from"./chunk-TLWJFQ3M.js";import{d as xe}from"./chunk-WESTYKRX.js";import{a as Y}from"./chunk-H2O7B6BZ.js";import{a as D}from"./chunk-M6MDGVAZ.js";import{B as V,c as F,e as j,l as A,n as ce,s as de,t as le,u as ue,v as pe,w as me,y as ge}from"./chunk-GWDAXWU7.js";import{$b as _e,Ba as ee,Da as d,Ea as te,Fa as z,Ha as L,Hb as q,Ib as G,Jb as E,Na as i,Oa as o,Ob as ae,Pa as l,Qa as ne,Ra as oe,Rb as R,Ta as f,Ua as h,Va as c,a as Q,aa as Z,ba as m,bc as he,ca as g,db as re,eb as a,ec as fe,fb as x,ga as N,gb as b,hb as T,ib as ie,jb as M,kb as P,lb as O,na as S,pa as s,sa as v,sb as B,ta as I,ub as W,vb as se,ya as _}from"./chunk-3BHHYQXT.js";function we(t,u){if(t&1&&l(0,"img",19),t&2){let e=c().$implicit,r=c(3);d("src",r.url+"get-image-user/"+e.picture,S)}}function ye(t,u){t&1&&l(0,"i",20)}function Se(t,u){if(t&1){let e=f();i(0,"button",14),h("click",function(){let n=m(e).$implicit,p=c(3);return g(p.selectUserToAdd(n))}),_(1,we,1,1,"img",15)(2,ye,1,0,"i",16),i(3,"div",17)(4,"span"),a(5),o(),i(6,"small",18),a(7),o()()()}if(t&2){let e=u.$implicit;s(),d("ngIf",e.picture),s(),d("ngIf",!e.picture),s(3),x(e.name),s(2),T("",e.email," \xB7 ",e.role,"")}}function Ie(t,u){if(t&1&&(i(0,"div",12),_(1,Se,8,5,"button",13),o()),t&2){let e=c(2);s(),d("ngForOf",e.filteredUsers)}}function Te(t,u){if(t&1){let e=f();i(0,"div",5)(1,"div",6)(2,"span",7),l(3,"i",8),o(),i(4,"input",9),O("ngModelChange",function(n){m(e);let p=c();return P(p.newStudentEmail,n)||(p.newStudentEmail=n),g(n)}),h("input",function(){m(e);let n=c();return g(n.onSearchTermChange())}),o(),i(5,"button",10),h("click",function(){m(e);let n=c();return g(n.addOrInvite())}),a(6," Agregar "),o()(),_(7,Ie,2,1,"div",11),o()}if(t&2){let e=c();s(4),M("ngModel",e.newStudentEmail),s(3),d("ngIf",e.showSuggestions)}}function Ge(t,u){if(t&1){let e=f();i(0,"div",25)(1,"div",26)(2,"span",7),l(3,"i",8),o(),i(4,"input",27),O("ngModelChange",function(n){m(e);let p=c(2);return P(p.newStudentEmail,n)||(p.newStudentEmail=n),g(n)}),h("input",function(){m(e);let n=c(2);return g(n.onSearchTermChange())}),o(),i(5,"button",10),h("click",function(){m(e);let n=c(2);return g(n.addOrInvite())}),a(6,"Agregar"),o()()()}if(t&2){let e=c(2);s(4),M("ngModel",e.newStudentEmail)}}function Ee(t,u){if(t&1&&(i(0,"div",21)(1,"div",22),l(2,"i",23),o(),i(3,"h4"),a(4,"No hay estudiantes"),o(),i(5,"p"),a(6,"Este grupo a\xFAn no tiene estudiantes asignados."),o(),_(7,Ge,7,1,"div",24),o()),t&2){let e=c();s(7),d("ngIf",e.isTeacher())}}function Re(t,u){if(t&1){let e=f();i(0,"button",38),h("click",function(){m(e);let n=c(2);return g(n.clearFilter())}),l(1,"i",39),o()}}function Ve(t,u){if(t&1&&l(0,"img",47),t&2){let e=c().$implicit,r=c(2);d("src",r.url+"get-image-user/"+e.picture,S)("alt",e.name)}}function De(t,u){t&1&&l(0,"i",20)}function Ue(t,u){t&1&&(i(0,"span",52),a(1,"Salir"),o())}function Le(t,u){if(t&1){let e=f();i(0,"div",48)(1,"button",49),h("click",function(){m(e);let n=c().$implicit,p=c(2);return g(p.removeStudent(n._id))}),l(2,"i",50),_(3,Ue,2,0,"span",51),o()()}if(t&2){let e=c().$implicit,r=c(2);s(),d("ngClass",r.isCurrentUser(e._id)?"btn-outline-warning":"btn-outline-danger")("title",r.isCurrentUser(e._id)?"Abandonar grupo":"Remover estudiante"),s(),d("ngClass",r.isCurrentUser(e._id)?"fas fa-sign-out-alt":"fas fa-user-minus"),s(),d("ngIf",r.isCurrentUser(e._id))}}function Fe(t,u){if(t&1&&(i(0,"div",40)(1,"div",41)(2,"div",42),_(3,Ve,1,2,"img",43)(4,De,1,0,"i",16),o(),_(5,Le,4,4,"div",44),o(),i(6,"div",45)(7,"h5"),a(8),o(),i(9,"p"),a(10),o(),i(11,"div",46)(12,"small"),a(13),o(),i(14,"small"),a(15),o()()()()),t&2){let e=u.$implicit,r=c(2);s(3),d("ngIf",e.picture),s(),d("ngIf",!e.picture),s(),d("ngIf",r.canRemoveStudent(e._id)),s(3),x(e.name),s(2),x(e.email),s(3),b("Lecciones: ",e.lessonsCount||0,""),s(2),b("Promedio: ",e.averageGrade||"N/A","")}}function je(t,u){if(t&1){let e=f();i(0,"div",53)(1,"div",22),l(2,"i",30),o(),i(3,"h5"),a(4,"No se encontraron resultados"),o(),i(5,"p"),a(6),o(),i(7,"button",54),h("click",function(){m(e);let n=c(2);return g(n.clearFilter())}),l(8,"i",55),a(9,"Limpiar b\xFAsqueda "),o()()}if(t&2){let e=c(2);s(6),b('No hay estudiantes que coincidan con "',e.searchFilter,'"')}}function Ae(t,u){if(t&1){let e=f();i(0,"div")(1,"div",28)(2,"div",29)(3,"span",7),l(4,"i",30),o(),i(5,"input",31),O("ngModelChange",function(n){m(e);let p=c();return P(p.searchFilter,n)||(p.searchFilter=n),g(n)}),h("input",function(){m(e);let n=c();return g(n.onFilterChange())}),o(),_(6,Re,2,0,"button",32),o(),i(7,"small",33),l(8,"i",34),a(9),o()(),i(10,"div",35),_(11,Fe,16,7,"div",36)(12,je,10,1,"div",37),o()()}if(t&2){let e=c();s(5),M("ngModel",e.searchFilter),s(),d("ngIf",e.searchFilter),s(3),T(" Mostrando ",e.filteredStudents.length," de ",e.students.length," estudiante(s) "),s(2),d("ngForOf",e.filteredStudents),s(),d("ngIf",e.filteredStudents.length===0&&e.searchFilter)}}var ve=(()=>{class t{constructor(e,r){this.userService=e,this.academicGroupService=r,this.groupId="",this.students=[],this.userRole="student",this.currentUserRole="",this.teacherId="",this.currentUserId="",this.studentsUpdated=new N,this.url=D.url,this.newStudentEmail="",this.allUsers=[],this.filteredUsers=[],this.showSuggestions=!1,this.selectedUser=null,this.searchSeq=0,this.searchFilter="",this.filteredStudents=[]}ngOnInit(){this.filteredStudents=[...this.students]}ngOnChanges(){this.applyFilter()}onFilterChange(){this.applyFilter()}applyFilter(){let e=(this.searchFilter||"").toLowerCase().trim();if(!e){this.filteredStudents=[...this.students];return}this.filteredStudents=this.students.filter(r=>{let n=(r.name||"").toLowerCase(),p=(r.surname||"").toLowerCase(),C=(r.email||"").toLowerCase();return`${n} ${p}`.trim().includes(e)||n.includes(e)||p.includes(e)||C.includes(e)})}clearFilter(){this.searchFilter="",this.applyFilter()}isTeacher(){return this.teacherId===this.currentUserId||this.userRole==="teacher"||["admin","delegated_admin","lesson_manager"].includes(this.currentUserRole)}isCurrentUser(e){return this.currentUserId===e}canRemoveStudent(e){return this.isTeacher()||this.isCurrentUser(e)}canAddStudents(){return this.isTeacher()}canRemoveStudents(){return this.isTeacher()}onSearchTermChange(){console.log("[GroupStudents] onSearchTermChange input",{raw:this.newStudentEmail}),this.selectedUser=null;let e=(this.newStudentEmail||"").toLowerCase().trim();if(console.log("[GroupStudents] normalized term",{term:e}),!e){console.log("[GroupStudents] empty term -> clear suggestions"),this.filteredUsers=[],this.showSuggestions=!1;return}let r=++this.searchSeq,n=e;this.filteredUsers=[],this.showSuggestions=!1,console.log("[GroupStudents] search start",{seq:r,term:n}),this.userService.searchUsers(e,8).subscribe({next:p=>{let C=(this.newStudentEmail||"").toLowerCase().trim(),w=C===n,y=Array.isArray(p?.users)?p.users.length:0;if(console.log("[GroupStudents] search response",{seq:r,expectedTerm:n,currentTerm:C,stillCurrent:w,usersLen:y,res:p}),!w){console.log("[GroupStudents] stale response ignored",{seq:r});return}let K=(p?.users||[]).map(k=>({_id:k._id,name:`${k.name||""} ${k.surname||""}`.trim(),email:k.email,role:k.role,picture:k.picture})),Oe=new Set((this.students||[]).map(k=>k._id||k.id));this.filteredUsers=K.filter(k=>!Oe.has(k._id)),this.showSuggestions=this.filteredUsers.length>0,console.log("[GroupStudents] suggestions updated",{seq:r,count:this.filteredUsers.length})},error:p=>{let C=(this.newStudentEmail||"").toLowerCase().trim(),w=C===n;console.error("[GroupStudents] search error",{seq:r,expectedTerm:n,currentTerm:C,stillCurrent:w,err:p}),w&&(this.filteredUsers=[],this.showSuggestions=!1)}})}selectUserToAdd(e){this.selectedUser=e,this.newStudentEmail=`${e.name} <${e.email}>`,this.filteredUsers=[],this.showSuggestions=!1}addOrInvite(){if(this.selectedUser?._id){this.academicGroupService.addStudentToGroup(this.groupId,this.selectedUser._id).subscribe({next:()=>{this.studentsUpdated.emit(),this.newStudentEmail="",this.selectedUser=null,this.filteredUsers=[],this.showSuggestions=!1,alert("Estudiante agregado exitosamente")},error:e=>{console.error("Error agregando estudiante:",e),alert(e.error?.message||"No se pudo agregar al estudiante")}});return}this.inviteStudentByEmail()}inviteStudentByEmail(){let e=(this.newStudentEmail||"").trim();if(!e||!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(e)){alert("Ingresa un correo v\xE1lido");return}this.academicGroupService.inviteStudentByEmail(this.groupId,e).subscribe({next:()=>{this.studentsUpdated.emit(),this.newStudentEmail="",this.selectedUser=null,this.filteredUsers=[],this.showSuggestions=!1,alert("Estudiante agregado/invitado")},error:r=>{console.error("Error invitando/agregando estudiante:",r),alert(r.error?.message||"No se pudo agregar/invitar al estudiante")}})}removeStudent(e){let r=this.isCurrentUser(e);confirm(r?"\xBFEst\xE1s seguro de que quieres abandonar este grupo?":"\xBFEst\xE1s seguro de que quieres remover a este estudiante del grupo?")&&this.academicGroupService.removeStudentFromGroup(this.groupId,e).subscribe({next:()=>{this.studentsUpdated.emit(),alert(r?"Has abandonado el grupo exitosamente":"Estudiante removido exitosamente")},error:p=>{console.error("Error removing student:",p),alert(p.error?.message||"Error al remover el estudiante")}})}static{this.\u0275fac=function(r){return new(r||t)(v(Y),v(U))}}static{this.\u0275cmp=I({type:t,selectors:[["app-group-students"]],inputs:{groupId:"groupId",students:"students",userRole:"userRole",currentUserRole:"currentUserRole",teacherId:"teacherId",currentUserId:"currentUserId"},outputs:{studentsUpdated:"studentsUpdated"},features:[Z],decls:6,vars:3,consts:[[1,"tab-header","d-flex","align-items-center","justify-content-between"],[1,"m-0"],["class","d-flex align-items-center gap-2 position-relative","style","max-width: 560px;",4,"ngIf"],["class","empty-state",4,"ngIf"],[4,"ngIf"],[1,"d-flex","align-items-center","gap-2","position-relative",2,"max-width","560px"],[1,"input-group","w-100"],[1,"input-group-text"],[1,"fas","fa-user-plus"],["name","newStudentEmail","type","text","placeholder","Agregar participantes por nombre o correo",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"btn","btn-success",3,"click"],["class","list-group position-absolute w-100","style","top: 110%; z-index: 10;",4,"ngIf"],[1,"list-group","position-absolute","w-100",2,"top","110%","z-index","10"],["type","button","class","list-group-item list-group-item-action d-flex align-items-center",3,"click",4,"ngFor","ngForOf"],["type","button",1,"list-group-item","list-group-item-action","d-flex","align-items-center",3,"click"],["alt","Avatar",3,"src",4,"ngIf"],["class","fas fa-user-circle",4,"ngIf"],[1,"d-flex","flex-column","text-start"],[1,"text-muted"],["alt","Avatar",3,"src"],[1,"fas","fa-user-circle"],[1,"empty-state"],[1,"empty-icon"],[1,"fas","fa-users"],["class","d-flex align-items-center justify-content-center mt-2",4,"ngIf"],[1,"d-flex","align-items-center","justify-content-center","mt-2"],[1,"input-group",2,"max-width","560px"],["name","newStudentEmailEmpty","type","text","placeholder","Agregar participantes por nombre o correo",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"search-filter-container","mb-4"],[1,"input-group"],[1,"fas","fa-search"],["type","text","placeholder","Buscar estudiante por nombre o email...","aria-label","Buscar estudiante",1,"form-control",3,"ngModelChange","input","ngModel"],["class","btn btn-outline-secondary","type","button",3,"click",4,"ngIf"],[1,"text-muted","mt-2","d-block"],[1,"fas","fa-info-circle"],[1,"students-grid"],["class","student-card",4,"ngFor","ngForOf"],["class","empty-filter-state",4,"ngIf"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-times"],[1,"student-card"],[1,"student-header"],[1,"student-avatar"],[3,"src","alt",4,"ngIf"],["class","student-actions",4,"ngIf"],[1,"student-info"],[1,"student-stats"],[3,"src","alt"],[1,"student-actions"],[1,"btn","btn-sm",3,"click","ngClass","title"],[3,"ngClass"],["class","ms-1",4,"ngIf"],[1,"ms-1"],[1,"empty-filter-state"],[1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"fas","fa-times","me-2"]],template:function(r,n){r&1&&(i(0,"div",0)(1,"h3",1),a(2,"Estudiantes del Grupo"),o(),_(3,Te,8,2,"div",2),o(),_(4,Ee,8,1,"div",3)(5,Ae,13,6,"div",4)),r&2&&(s(3),d("ngIf",n.isTeacher()),s(),d("ngIf",n.students.length===0),s(),d("ngIf",n.students.length>0))},dependencies:[R,q,G,E,V,F,j,A],styles:['.list-group[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;box-shadow:0 4px 12px #00000026;border-radius:8px;background:#fff}.list-group-item[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease;border:none;border-bottom:1px solid #e9ecef;padding:10px 15px}.list-group-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.list-group-item[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;transform:translate(5px)}.list-group-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px!important;height:32px!important;border-radius:50%;object-fit:cover;margin-right:10px;flex-shrink:0;border:2px solid #e9ecef}.list-group-item[_ngcontent-%COMP%]   .fa-user-circle[_ngcontent-%COMP%]{font-size:2rem!important;margin-right:10px;color:#6c757d;flex-shrink:0}.list-group-item[_ngcontent-%COMP%]   .d-flex.flex-column[_ngcontent-%COMP%]{min-width:0;flex:1}.list-group-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500;color:#2c3e50;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.list-group-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.85rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.list-group[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.list-group[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}.list-group[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:10px}.list-group[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}.students-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-top:20px}.student-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f8f9fa);border:2px solid #e9ecef;border-radius:12px;padding:20px;transition:all .3s ease;box-shadow:0 2px 8px #00000014;display:flex;flex-direction:column;gap:15px;position:relative;overflow:hidden}.student-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#667eea,#764ba2);transform:scaleX(0);transition:transform .3s ease}.student-card[_ngcontent-%COMP%]:hover{border-color:#667eea;box-shadow:0 8px 24px #667eea33;transform:translateY(-5px)}.student-card[_ngcontent-%COMP%]:hover:before{transform:scaleX(1)}.student-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.student-avatar[_ngcontent-%COMP%]{width:60px!important;height:60px!important;display:flex;align-items:center;justify-content:center;border-radius:50%;overflow:hidden;background:linear-gradient(135deg,#667eea,#764ba2);border:3px solid #fff;flex-shrink:0;box-shadow:0 4px 12px #667eea4d;transition:all .3s ease}.student-card[_ngcontent-%COMP%]:hover   .student-avatar[_ngcontent-%COMP%]{transform:scale(1.1);box-shadow:0 6px 16px #667eea66}.student-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%!important;height:100%!important;object-fit:cover;border-radius:50%}.student-avatar[_ngcontent-%COMP%]   .fa-user-circle[_ngcontent-%COMP%]{font-size:3rem!important;color:#fff}.student-info[_ngcontent-%COMP%]{text-align:center;padding:10px 0}.student-info[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 0 8px;color:#2c3e50;font-weight:600;font-size:1.1rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.student-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 12px;color:#6c757d;font-size:.9rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.student-stats[_ngcontent-%COMP%]{display:flex;justify-content:space-around;padding-top:12px;border-top:2px solid #e9ecef;gap:10px}.student-stats[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;color:#495057;font-weight:500;padding:8px;background:#f8f9fa;border-radius:8px;flex:1}.student-stats[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:4px;color:#667eea}.student-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:10px}.student-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px;font-weight:600;transition:all .3s ease}.student-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.search-filter-container[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa,#e9ecef);padding:20px;border-radius:12px;border:2px solid #dee2e6;box-shadow:0 2px 8px #0000000d}.search-filter-container[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{box-shadow:0 2px 8px #0000001a;border-radius:8px;overflow:hidden}.search-filter-container[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{background:#fff;border:none;padding:12px 15px}.search-filter-container[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border:none;padding:12px 15px;font-size:.95rem}.search-filter-container[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{box-shadow:none;outline:none}.search-filter-container[_ngcontent-%COMP%]   .btn-outline-secondary[_ngcontent-%COMP%]{border:none;background:#fff;color:#6c757d;transition:all .3s ease}.search-filter-container[_ngcontent-%COMP%]   .btn-outline-secondary[_ngcontent-%COMP%]:hover{background:#dc3545;color:#fff}.search-filter-container[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.85rem}.empty-filter-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border-radius:12px;border:2px dashed #dee2e6;margin-top:20px}.empty-filter-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:3rem;color:#dee2e6;margin-bottom:15px}.empty-filter-state[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:#495057;margin-bottom:10px;font-weight:600}.empty-filter-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d;margin-bottom:20px}@media (max-width: 1200px){.students-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 768px){.students-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.search-filter-container[_ngcontent-%COMP%]{padding:15px}}.theme-dark[_nghost-%COMP%]   .list-group[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .list-group[_ngcontent-%COMP%]{background:#1a1f24;box-shadow:0 4px 12px #0000004d}.theme-dark[_nghost-%COMP%]   .student-card[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .student-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#111821,#0f1420);border-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .student-card[_ngcontent-%COMP%]:hover, .theme-dark   [_nghost-%COMP%]   .student-card[_ngcontent-%COMP%]:hover{border-color:#667eea}.theme-dark[_nghost-%COMP%]   .student-avatar[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .student-avatar[_ngcontent-%COMP%]{border-color:#1a1f24}.theme-dark[_nghost-%COMP%]   .student-info[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .student-info[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .student-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .student-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--rd-muted)}.theme-dark[_nghost-%COMP%]   .student-stats[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .student-stats[_ngcontent-%COMP%]{border-top-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .student-stats[_ngcontent-%COMP%]   small[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .student-stats[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{background:#0b1020;color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .search-filter-container[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .search-filter-container[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0f1420,#111821);border-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .search-filter-container[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .search-filter-container[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%], .theme-dark[_nghost-%COMP%]   .search-filter-container[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .search-filter-container[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background:#1a1f24;color:var(--rd-text);border-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .search-filter-container[_ngcontent-%COMP%]   .btn-outline-secondary[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .search-filter-container[_ngcontent-%COMP%]   .btn-outline-secondary[_ngcontent-%COMP%]{background:#1a1f24;color:var(--rd-muted)}.theme-dark[_nghost-%COMP%]   .empty-filter-state[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .empty-filter-state[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0f1420,#111821);border-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .empty-filter-state[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .empty-filter-state[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .empty-filter-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .empty-filter-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--rd-muted)}.theme-dark[_nghost-%COMP%]   .list-group-item[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .list-group-item[_ngcontent-%COMP%]{background:#111821;border-bottom-color:#2a2f36;color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .list-group-item[_ngcontent-%COMP%]:hover, .theme-dark   [_nghost-%COMP%]   .list-group-item[_ngcontent-%COMP%]:hover{background:#1a1f24}.theme-dark[_nghost-%COMP%]   .list-group-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .list-group-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .list-group-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .list-group-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .list-group-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .list-group-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:var(--rd-muted)}']})}}return t})();function Ne(t,u){if(t&1){let e=f();i(0,"button",7),h("click",function(){m(e);let n=c();return g(n.openResourcesModal())}),l(1,"i",8),a(2," Importar Recursos "),o()}}function Be(t,u){if(t&1){let e=f();i(0,"button",13),h("click",function(){m(e);let n=c(2);return g(n.openResourcesModal())}),l(1,"i",8),a(2," Importar Recursos "),o()}}function We(t,u){if(t&1&&(i(0,"div",9)(1,"div",10),l(2,"i",11),o(),i(3,"h4"),a(4,"Sin recursos"),o(),i(5,"p"),a(6,"Importa recursos desde el repositorio."),o(),_(7,Be,3,0,"button",12),o()),t&2){let e=c();s(7),d("ngIf",e.isGroupTeacher())}}function qe(t,u){t&1&&l(0,"img",36)}function Ye(t,u){if(t&1&&l(0,"img",37),t&2){let e=c().$implicit,r=c(2);d("src",r.url+"get-image-user/"+e.author.picture,S)}}function $e(t,u){if(t&1){let e=f();ne(0),i(1,"button",38),h("click",function(){m(e);let n=c().$implicit,p=c(2);return p.goToUrl(n.url),g(p.increaseDownloads(n))}),l(2,"i",39),a(3," Abrir "),o(),oe()}}function He(t,u){if(t&1){let e=f();i(0,"a",40),h("click",function(){m(e);let n=c().$implicit,p=c(2);return g(p.increaseDownloads(n))}),l(1,"i",24),a(2," Descargar "),o()}if(t&2){let e=c().$implicit,r=c(2);d("title","Descargar: "+e.file)("href",r.url+"get-resource/"+e.file,S)}}function Xe(t,u){if(t&1){let e=f();i(0,"button",41),h("click",function(){m(e);let n=c().$implicit,p=c(2);return g(p.removeResourceFromGroup(n._id))}),l(1,"i",42),a(2," Remover "),o()}}function Je(t,u){if(t&1&&(i(0,"div",15)(1,"div",16)(2,"div",17)(3,"div",18)(4,"div",19)(5,"div",20),l(6,"i",21),o(),i(7,"div",22)(8,"button",23),l(9,"i",24),a(10),o()()(),i(11,"div",25)(12,"h5",26)(13,"strong"),a(14),o()(),i(15,"p"),a(16),o(),i(17,"p")(18,"strong"),a(19,"Subido por:"),o()(),i(20,"div",18)(21,"div",27)(22,"div",28),_(23,qe,1,0,"img",29)(24,Ye,1,1,"img",30),o()(),i(25,"div",31)(26,"h6",32)(27,"strong"),a(28),o()()()()(),i(29,"div",33),_(30,$e,4,0,"ng-container",34)(31,He,3,2,"ng-template",null,0,se)(33,Xe,3,0,"button",35),o()()()()()),t&2){let e=u.$implicit,r=re(32),n=c(2);s(5),L("text-center p-2 rounded-lg border border-light ",n.iconResource[e.type]==null?null:n.iconResource[e.type].class,""),s(),L("text-white fas ",n.iconResource[e.type]==null?null:n.iconResource[e.type].icon,""),s(4),b(" ",e.downloads||0," "),s(4),x(e.name),s(2),x(e.description),s(7),d("ngIf",!(e.author!=null&&e.author.picture)),s(),d("ngIf",e.author==null?null:e.author.picture),s(4),T("",e.author==null?null:e.author.name," ",e.author==null?null:e.author.surname,""),s(2),d("ngIf",e.type=="link")("ngIfElse",r),s(3),d("ngIf",n.isGroupTeacher())}}function Ke(t,u){if(t&1&&(i(0,"div"),_(1,Je,34,16,"div",14),o()),t&2){let e=c();s(),d("ngForOf",e.groupResources)}}function Qe(t,u){t&1&&(i(0,"div",55)(1,"div",56)(2,"span",57),a(3,"Cargando recursos..."),o()(),i(4,"p",58),a(5,"Cargando recursos disponibles..."),o()())}function Ze(t,u){t&1&&(i(0,"div",69),l(1,"i",70),i(2,"p",71),a(3,"No hay recursos disponibles para importar"),o()())}function et(t,u){t&1&&l(0,"i",82)}function tt(t,u){t&1&&l(0,"i",83)}function nt(t,u){if(t&1){let e=f();i(0,"div",72),h("click",function(){let n=m(e).$implicit,p=c(3);return g(p.toggleResourceSelection(n))}),i(1,"div",73)(2,"div"),l(3,"i"),o(),i(4,"div",74)(5,"h6",75),a(6),o(),i(7,"p",76),a(8),o(),i(9,"div",77)(10,"span"),l(11,"i",78),a(12),o(),i(13,"span"),l(14,"i",24),a(15),o()()(),i(16,"div",79),_(17,et,1,0,"i",80)(18,tt,1,0,"i",81),o()()()}if(t&2){let e=u.$implicit,r=c(3);z("selected",r.isResourceSelected(e)),s(2),L("resource-icon-small ",r.iconResource[e.type]==null?null:r.iconResource[e.type].class," me-3"),s(),L("fas ",r.iconResource[e.type]==null?null:r.iconResource[e.type].icon,""),s(3),x(e.name),s(2),x(e.description),s(4),b(" ",e.author==null?null:e.author.name,""),s(3),b(" ",e.downloads||0,""),s(2),d("ngIf",r.isResourceSelected(e)),s(),d("ngIf",!r.isResourceSelected(e))}}function ot(t,u){t&1&&(i(0,"div",69),l(1,"i",84),i(2,"p",71),a(3,"Haz clic en los recursos de la izquierda para seleccionarlos"),o()())}function rt(t,u){if(t&1){let e=f();i(0,"div",85)(1,"div",73)(2,"div"),l(3,"i"),o(),i(4,"div",74)(5,"h6",75),a(6),o(),i(7,"p",76),a(8),o(),i(9,"div",77)(10,"span"),l(11,"i",78),a(12),o(),i(13,"span"),l(14,"i",24),a(15),o()()(),i(16,"button",86),h("click",function(){let n=m(e).$implicit,p=c(3);return g(p.removeFromSelection(n))}),l(17,"i",42),o()()()}if(t&2){let e=u.$implicit,r=c(3);s(2),L("resource-icon-small ",r.iconResource[e.type]==null?null:r.iconResource[e.type].class," me-3"),s(),L("fas ",r.iconResource[e.type]==null?null:r.iconResource[e.type].icon,""),s(3),x(e.name),s(2),x(e.description),s(4),b(" ",e.author==null?null:e.author.name,""),s(3),b(" ",e.downloads||0,"")}}function it(t,u){if(t&1&&(i(0,"div",59)(1,"div",60)(2,"div",61)(3,"h5"),l(4,"i",62),a(5),o()(),i(6,"div",63),_(7,Ze,4,0,"div",64)(8,nt,19,14,"div",65),o()(),i(9,"div",66)(10,"div",61)(11,"h5"),l(12,"i",67),a(13),o()(),i(14,"div",63),_(15,ot,4,0,"div",64)(16,rt,18,10,"div",68),o()()()),t&2){let e=c(2);s(5),b("Recursos Disponibles (",e.availableResources.length,")"),s(2),d("ngIf",e.availableResources.length===0),s(),d("ngForOf",e.availableResources),s(5),b("Recursos Seleccionados (",e.selectedResourcesToAdd.length,")"),s(2),d("ngIf",e.selectedResourcesToAdd.length===0),s(),d("ngForOf",e.selectedResourcesToAdd)}}function st(t,u){t&1&&l(0,"span",87)}function at(t,u){t&1&&l(0,"i",88)}function ct(t,u){if(t&1){let e=f();i(0,"div",43),h("click",function(){m(e);let n=c();return g(n.closeResourcesModal())}),i(1,"div",44),h("click",function(n){return m(e),g(n.stopPropagation())}),i(2,"div",45)(3,"h3",2),a(4,"Importar Recursos al Grupo"),o(),i(5,"button",46),h("click",function(){m(e);let n=c();return g(n.closeResourcesModal())}),l(6,"i",42),o()(),i(7,"div",47),_(8,Qe,6,0,"div",48)(9,it,17,6,"div",49),o(),i(10,"div",50)(11,"button",51),h("click",function(){m(e);let n=c();return g(n.closeResourcesModal())}),l(12,"i",42),a(13," Cancelar "),o(),i(14,"button",52),h("click",function(){m(e);let n=c();return g(n.importSelectedResources())}),_(15,st,1,0,"span",53)(16,at,1,0,"i",54),a(17),o()()()()}if(t&2){let e=c();s(8),d("ngIf",e.loadingResources),s(),d("ngIf",!e.loadingResources),s(5),d("disabled",e.selectedResourcesToAdd.length===0||e.addingResource),s(),d("ngIf",e.addingResource),s(),d("ngIf",!e.addingResource),s(),b(" Importar (",e.selectedResourcesToAdd.length,") ")}}var Me=(()=>{class t{constructor(e,r){this.resourceService=e,this.academicGroupService=r,this.groupId="",this.groupResources=[],this.userRole="student",this.token="",this.teacherId="",this.currentUserId="",this.resourcesUpdated=new N,this.url=D.url,this.iconResource=xe,this.showResourcesModal=!1,this.availableResources=[],this.selectedResourcesToAdd=[],this.loadingResources=!1,this.addingResource=!1}ngOnInit(){}getGroupTeacherId(){let e=this.teacherId;return e?typeof e=="object"&&e._id?String(e._id):String(e):""}isGroupTeacher(){return this.getGroupTeacherId()===String(this.currentUserId||"")}openResourcesModal(){this.isGroupTeacher()&&(this.showResourcesModal=!0,this.selectedResourcesToAdd=[],this.loadAvailableResources(),document.body.style.overflow="hidden")}closeResourcesModal(){this.showResourcesModal=!1,this.selectedResourcesToAdd=[],document.body.style.overflow="auto"}loadAvailableResources(){this.loadingResources=!0,this.resourceService.getAllResources(this.token,"",!0).subscribe({next:e=>{let r=e.resources||[],n=new Set(this.groupResources.map(p=>p._id));this.availableResources=r.filter(p=>p.accepted&&p.visible&&!n.has(p._id)),this.loadingResources=!1},error:()=>{this.loadingResources=!1}})}toggleResourceSelection(e){let r=this.selectedResourcesToAdd.findIndex(n=>n._id===e._id);r>=0?this.selectedResourcesToAdd.splice(r,1):this.selectedResourcesToAdd.push(e)}isResourceSelected(e){return this.selectedResourcesToAdd.some(r=>r._id===e._id)}removeFromSelection(e){let r=this.selectedResourcesToAdd.findIndex(n=>n._id===e._id);r>=0&&this.selectedResourcesToAdd.splice(r,1)}importSelectedResources(){if(this.selectedResourcesToAdd.length===0){alert("Selecciona al menos un recurso para importar");return}this.addingResource=!0;let e=0,r=this.selectedResourcesToAdd.length;this.selectedResourcesToAdd.forEach(n=>{this.academicGroupService.addGroupResource(this.groupId,n._id).subscribe({next:()=>{e++,e===r&&(this.addingResource=!1,this.resourcesUpdated.emit(),this.closeResourcesModal(),alert(`${r} recurso(s) importado(s) exitosamente`))},error:()=>{e++,e===r&&(this.addingResource=!1,this.resourcesUpdated.emit(),this.closeResourcesModal(),alert("Algunos recursos no pudieron ser importados"))}})})}removeResourceFromGroup(e){confirm("\xBFRemover este recurso del grupo?")&&this.academicGroupService.removeGroupResource(this.groupId,e).subscribe({next:()=>this.resourcesUpdated.emit(),error:()=>{}})}goToUrl(e){e.includes("http://")||e.includes("https://")?window.open(e,"_blank"):window.open(`http://${e}`,"_blank")}increaseDownloads(e){e.downloads=(e.downloads||0)+1,this.resourceService.editResource(this.token,e).subscribe({next:()=>this.resourcesUpdated.emit(),error:r=>console.error("Error incrementando descargas:",r)})}static{this.\u0275fac=function(r){return new(r||t)(v($),v(U))}}static{this.\u0275cmp=I({type:t,selectors:[["app-group-resources"]],inputs:{groupId:"groupId",groupResources:"groupResources",userRole:"userRole",token:"token",teacherId:"teacherId",currentUserId:"currentUserId"},outputs:{resourcesUpdated:"resourcesUpdated"},decls:7,vars:4,consts:[["getResource",""],[1,"tab-header","d-flex","align-items-center","justify-content-between"],[1,"m-0"],["class","btn btn-success",3,"click",4,"ngIf"],["class","empty-state",4,"ngIf"],[4,"ngIf"],["class","resources-modal-overlay",3,"click",4,"ngIf"],[1,"btn","btn-success",3,"click"],[1,"fas","fa-plus"],[1,"empty-state"],[1,"empty-icon"],[1,"fas","fa-folder-open"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"click"],["class","resource-item-card mb-3",4,"ngFor","ngForOf"],[1,"resource-item-card","mb-3"],[1,"card"],[1,"card-body"],[1,"row"],[1,"col-auto"],[2,"width","80px","height","80px","overflow","hidden"],[2,"font-size","62px"],[1,"mt-2"],["disabled","","title","Descargas",1,"btn","w-100","btn-sm"],[1,"fas","fa-download"],[1,"col"],[1,"mt-0","text-truncate"],[1,"col-auto","pe-0"],[1,"flex-shrink-0","rounded-circle","border-1","overflow-hidden",2,"width","40px","height","40px","background-color","aqua"],["class","img-fluid","src","assets/images/user-default.png",4,"ngIf"],["class","img-fluid",3,"src",4,"ngIf"],[1,"col","rounded","px-2"],[1,"mb-1"],[1,"col-auto","d-flex","flex-column","justify-content-center","gap-2"],[4,"ngIf","ngIfElse"],["class","btn btn-sm btn-outline-danger",3,"click",4,"ngIf"],["src","assets/images/user-default.png",1,"img-fluid"],[1,"img-fluid",3,"src"],["title","Ir al enlace",1,"btn","btn-secondary",3,"click"],[1,"fas","fa-hand-pointer"],["target","_blank",1,"btn","btn-secondary",3,"click","title","href"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"fas","fa-times"],[1,"resources-modal-overlay",3,"click"],[1,"resources-modal-container",3,"click"],[1,"resources-modal-header"],[1,"btn-close-modal",3,"click"],[1,"resources-modal-body"],["class","text-center py-5",4,"ngIf"],["class","row h-100",4,"ngIf"],[1,"resources-modal-footer"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-success",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","fas fa-download me-2",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"mt-3","text-muted"],[1,"row","h-100"],[1,"col-md-6","resources-column"],[1,"column-header"],[1,"fas","fa-folder-open","me-2"],[1,"resources-list"],["class","empty-state-small",4,"ngIf"],["class","resource-item",3,"selected","click",4,"ngFor","ngForOf"],[1,"col-md-6","resources-column","selection-column"],[1,"fas","fa-check-square","me-2"],["class","resource-item selected-item",4,"ngFor","ngForOf"],[1,"empty-state-small"],[1,"fas","fa-inbox","fa-3x","text-muted","mb-3"],[1,"text-muted"],[1,"resource-item",3,"click"],[1,"d-flex","align-items-start"],[1,"flex-grow-1"],[1,"mb-1","resource-name"],[1,"mb-1","text-muted","small","resource-description"],[1,"d-flex","align-items-center","gap-3","text-muted","small"],[1,"fas","fa-user"],[1,"resource-check"],["class","fas fa-check-circle text-success",4,"ngIf"],["class","far fa-circle",4,"ngIf"],[1,"fas","fa-check-circle","text-success"],[1,"far","fa-circle"],[1,"fas","fa-hand-pointer","fa-3x","text-muted","mb-3"],[1,"resource-item","selected-item"],[1,"btn-remove-selection",3,"click"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-download","me-2"]],template:function(r,n){r&1&&(i(0,"div",1)(1,"h3",2),a(2,"Recursos del Grupo"),o(),_(3,Ne,3,0,"button",3),o(),_(4,We,8,1,"div",4)(5,Ke,2,1,"div",5)(6,ct,18,6,"div",6)),r&2&&(s(3),d("ngIf",n.isGroupTeacher()),s(),d("ngIf",n.groupResources.length===0),s(),d("ngIf",n.groupResources.length>0),s(),d("ngIf",n.showResourcesModal))},dependencies:[R,G,E,V],styles:[".resources-modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#000000b3;display:flex;justify-content:center;align-items:center;z-index:9999;padding:20px;animation:_ngcontent-%COMP%_fadeIn .2s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.resources-modal-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;width:100%;max-width:1200px;height:85vh;display:flex;flex-direction:column;box-shadow:0 10px 40px #0000004d;animation:_ngcontent-%COMP%_slideUp .3s ease}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(50px);opacity:0}to{transform:translateY(0);opacity:1}}.resources-modal-header[_ngcontent-%COMP%]{padding:20px 30px;border-bottom:1px solid #e9ecef;display:flex;justify-content:space-between;align-items:center;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:12px 12px 0 0}.resources-modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600}.btn-close-modal[_ngcontent-%COMP%]{background:#fff3;border:none;color:#fff;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;font-size:1.2rem}.btn-close-modal[_ngcontent-%COMP%]:hover{background:#ffffff4d;transform:rotate(90deg)}.resources-modal-body[_ngcontent-%COMP%]{flex:1;overflow:hidden;padding:0}.resources-column[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;padding:20px;border-right:1px solid #e9ecef}.resources-column.selection-column[_ngcontent-%COMP%]{border-right:none;background:#f8f9fa}.column-header[_ngcontent-%COMP%]{padding-bottom:15px;border-bottom:2px solid #e9ecef;margin-bottom:15px}.column-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;color:#2c3e50;font-weight:600;font-size:1.1rem}.resources-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding-right:10px}.resources-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.resources-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}.resources-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:10px}.resources-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}.resource-item[_ngcontent-%COMP%]{padding:15px;margin-bottom:10px;border:2px solid #e9ecef;border-radius:8px;cursor:pointer;transition:all .2s ease;background:#fff}.resource-item[_ngcontent-%COMP%]:hover{border-color:#667eea;box-shadow:0 2px 8px #667eea33;transform:translate(5px)}.resource-item.selected[_ngcontent-%COMP%]{border-color:#28a745;background:#f0fff4}.resource-item.selected-item[_ngcontent-%COMP%]{background:#fff;border-color:#28a745;cursor:default}.resource-item.selected-item[_ngcontent-%COMP%]:hover{transform:none}.resource-icon-small[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.5rem;flex-shrink:0}.resource-name[_ngcontent-%COMP%]{color:#2c3e50;font-weight:600;font-size:.95rem;line-height:1.4}.resource-description[_ngcontent-%COMP%]{font-size:.85rem;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}.resource-check[_ngcontent-%COMP%]{font-size:1.5rem;flex-shrink:0;margin-left:10px}.btn-remove-selection[_ngcontent-%COMP%]{background:#dc3545;border:none;color:#fff;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;flex-shrink:0;margin-left:10px}.btn-remove-selection[_ngcontent-%COMP%]:hover{background:#c82333;transform:scale(1.1)}.empty-state-small[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center}.resources-modal-footer[_ngcontent-%COMP%]{padding:20px 30px;border-top:1px solid #e9ecef;display:flex;justify-content:flex-end;gap:10px;background:#f8f9fa;border-radius:0 0 12px 12px}.resources-modal-footer[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:10px 24px;font-weight:600;border-radius:6px;transition:all .3s ease}.resources-modal-footer[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background:#6c757d;border-color:#6c757d;color:#fff}.resources-modal-footer[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover{background:#5a6268;border-color:#545b62}.resources-modal-footer[_ngcontent-%COMP%]   .btn-success[_ngcontent-%COMP%]{background:#28a745;border-color:#28a745;color:#fff}.resources-modal-footer[_ngcontent-%COMP%]   .btn-success[_ngcontent-%COMP%]:hover:not(:disabled){background:#218838;border-color:#1e7e34;transform:translateY(-2px);box-shadow:0 4px 12px #28a7454d}.resources-modal-footer[_ngcontent-%COMP%]   .btn-success[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.theme-dark[_nghost-%COMP%]   .resources-modal-container[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resources-modal-container[_ngcontent-%COMP%]{background:#1a1f24;color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .resources-modal-header[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resources-modal-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#111a22,#1a1f24)}.theme-dark[_nghost-%COMP%]   .column-header[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .column-header[_ngcontent-%COMP%]{border-bottom-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .column-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .column-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .resources-column[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resources-column[_ngcontent-%COMP%]{border-right-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .resources-column.selection-column[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resources-column.selection-column[_ngcontent-%COMP%]{background:#0f1420}.theme-dark[_nghost-%COMP%]   .resource-item[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resource-item[_ngcontent-%COMP%]{background:#111821;border-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .resource-item[_ngcontent-%COMP%]:hover, .theme-dark   [_nghost-%COMP%]   .resource-item[_ngcontent-%COMP%]:hover{border-color:#667eea;background:#1a1f24}.theme-dark[_nghost-%COMP%]   .resource-item.selected[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resource-item.selected[_ngcontent-%COMP%], .theme-dark[_nghost-%COMP%]   .resource-item.selected-item[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resource-item.selected-item[_ngcontent-%COMP%]{background:#0d1f15;border-color:#28a745}.theme-dark[_nghost-%COMP%]   .resource-name[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resource-name[_ngcontent-%COMP%]{color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .resources-modal-footer[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resources-modal-footer[_ngcontent-%COMP%]{background:#0f1420;border-top-color:#2a2f36}@media (max-width: 768px){.resources-modal-container[_ngcontent-%COMP%]{height:95vh;max-width:100%;margin:0;border-radius:0}.resources-modal-header[_ngcontent-%COMP%]{padding:15px 20px;border-radius:0}.resources-modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.2rem}.resources-modal-body[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{flex-direction:column}.resources-column[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #e9ecef;max-height:40vh}.resources-column.selection-column[_ngcontent-%COMP%]{border-bottom:none}.resources-modal-footer[_ngcontent-%COMP%]{padding:15px}.resource-item[_ngcontent-%COMP%]:hover{transform:none}}"]})}}return t})();function dt(t,u){if(t&1){let e=f();i(0,"button",28),h("click",function(){m(e);let n=c(2);return g(n.openNewThreadModal())}),l(1,"i",29),a(2,"Nueva Conversaci\xF3n "),o()}}function lt(t,u){t&1&&(i(0,"div",30)(1,"div",31)(2,"span",32),a(3,"Cargando..."),o()(),i(4,"p",33),a(5,"Cargando conversaciones..."),o()())}function ut(t,u){if(t&1){let e=f();i(0,"button",38),h("click",function(){m(e);let n=c(3);return g(n.openNewThreadModal())}),l(1,"i",29),a(2,"Crear Primera Conversaci\xF3n "),o()}}function pt(t,u){if(t&1&&(i(0,"div",34)(1,"div",35),l(2,"i",36),o(),i(3,"h4"),a(4,"No hay conversaciones"),o(),i(5,"p"),a(6,"Inicia una nueva conversaci\xF3n con tu grupo."),o(),_(7,ut,3,0,"button",37),o()),t&2){let e=c(2);s(7),d("ngIf",e.canPostInForum)}}function mt(t,u){t&1&&l(0,"i",56)}function gt(t,u){t&1&&l(0,"i",57)}function _t(t,u){if(t&1&&(i(0,"p",58),a(1),o()),t&2){let e=c().$implicit;s(),x(e.description)}}function ht(t,u){if(t&1){let e=f();i(0,"button",65),h("click",function(n){m(e);let p=c(2).$implicit;return c(3).deleteThread(p._id),g(n.stopPropagation())}),l(1,"i",66),o()}}function ft(t,u){if(t&1){let e=f();i(0,"div",59)(1,"button",60),h("click",function(n){m(e);let p=c().$implicit;return c(3).togglePinThread(p),g(n.stopPropagation())}),l(2,"i",61),o(),i(3,"button",62),h("click",function(n){m(e);let p=c().$implicit;return c(3).toggleLockThread(p),g(n.stopPropagation())}),l(4,"i",63),o(),_(5,ht,2,0,"button",64),o()}if(t&2){let e=c().$implicit;s(),d("title",e.isPinned?"Desfijar":"Fijar"),s(2),d("title",e.isLocked?"Desbloquear":"Bloquear"),s(2),d("ngIf",!e.isPinned||e.title!=="Conversaci\xF3n General")}}function xt(t,u){if(t&1){let e=f();i(0,"div",41),h("click",function(){let n=m(e).$implicit,p=c(3);return g(p.selectThread(n))}),i(1,"div",42)(2,"div",43),_(3,mt,1,0,"i",44)(4,gt,1,0,"i",45),l(5,"i",46),o(),i(6,"div",47)(7,"h5",48),a(8),o(),_(9,_t,2,1,"p",49),i(10,"div",50)(11,"span",51),l(12,"i",52),a(13),o(),i(14,"span",53),l(15,"i",36),a(16),o(),i(17,"span",53),l(18,"i",54),a(19),B(20,"date"),o()()(),_(21,ft,6,3,"div",55),o()()}if(t&2){let e=u.$implicit,r=c(3);s(3),d("ngIf",e.isPinned),s(),d("ngIf",e.isLocked),s(4),x(e.title),s(),d("ngIf",e.description),s(4),T(" ",e.author==null?null:e.author.name," ",e.author==null?null:e.author.surname," "),s(3),b(" ",r.getThreadMessagesCount(e)," mensajes "),s(3),b(" ",W(20,9,r.getThreadLastUpdate(e),"short")," "),s(2),d("ngIf",r.isGroupTeacher())}}function Ct(t,u){if(t&1&&(i(0,"div",39),_(1,xt,22,12,"div",40),o()),t&2){let e=c(2);s(),d("ngForOf",e.discussionThreads)}}function bt(t,u){if(t&1&&(i(0,"div")(1,"div",21)(2,"h3",22),l(3,"i",23),a(4,"Foro del Grupo "),o(),_(5,dt,3,0,"button",24),o(),_(6,lt,6,0,"div",25)(7,pt,8,1,"div",26)(8,Ct,2,1,"div",27),o()),t&2){let e=c();s(5),d("ngIf",e.canPostInForum),s(),d("ngIf",e.loadingThreads),s(),d("ngIf",!e.loadingThreads&&e.discussionThreads.length===0),s(),d("ngIf",!e.loadingThreads&&e.discussionThreads.length>0)}}function vt(t,u){t&1&&l(0,"i",81)}function Mt(t,u){t&1&&l(0,"i",82)}function Pt(t,u){if(t&1&&(i(0,"p",12),a(1),o()),t&2){let e=c(2);s(),x(e.selectedThread.description)}}function Ot(t,u){if(t&1){let e=f();i(0,"button",65),h("click",function(){m(e);let n=c(3);return g(n.deleteThread(n.selectedThread._id))}),l(1,"i",66),a(2," Eliminar "),o()}}function kt(t,u){if(t&1){let e=f();i(0,"div",83)(1,"button",60),h("click",function(){m(e);let n=c(2);return g(n.togglePinThread(n.selectedThread))}),l(2,"i",61),a(3),o(),i(4,"button",62),h("click",function(){m(e);let n=c(2);return g(n.toggleLockThread(n.selectedThread))}),l(5,"i",63),a(6),o(),_(7,Ot,3,0,"button",64),o()}if(t&2){let e=c(2);s(),d("title",e.selectedThread.isPinned?"Desfijar":"Fijar"),s(2),b(" ",e.selectedThread.isPinned?"Desfijar":"Fijar"," "),s(),d("title",e.selectedThread.isLocked?"Desbloquear":"Bloquear"),s(2),b(" ",e.selectedThread.isLocked?"Desbloquear":"Bloquear"," "),s(),d("ngIf",!e.selectedThread.isPinned||e.selectedThread.title!=="Conversaci\xF3n General")}}function wt(t,u){t&1&&l(0,"span",88)}function yt(t,u){t&1&&l(0,"i",89)}function St(t,u){if(t&1){let e=f();i(0,"div",84)(1,"textarea",85),O("ngModelChange",function(n){m(e);let p=c(2);return P(p.newMessageText,n)||(p.newMessageText=n),g(n)}),o(),i(2,"button",86),h("click",function(){m(e);let n=c(2);return g(n.addMessageToSelectedThread())}),_(3,wt,1,0,"span",18)(4,yt,1,0,"i",87),a(5," Enviar "),o()()}if(t&2){let e=c(2);s(),M("ngModel",e.newMessageText),s(),d("disabled",e.addingMessage||!(e.newMessageText!=null&&e.newMessageText.trim())),s(),d("ngIf",e.addingMessage),s(),d("ngIf",!e.addingMessage)}}function It(t,u){t&1&&(i(0,"div",90),l(1,"i",91),a(2," Esta conversaci\xF3n est\xE1 bloqueada. Solo el profesor puede publicar mensajes. "),o())}function Tt(t,u){t&1&&(i(0,"div",92)(1,"p",12),a(2,"No hay mensajes todav\xEDa. \xA1S\xE9 el primero en participar!"),o()())}function Gt(t,u){if(t&1&&l(0,"img",102),t&2){let e=c().$implicit,r=c(2);d("src",r.url+"get-image-user/"+e.author.picture,S)}}function Et(t,u){t&1&&l(0,"i",103)}function Rt(t,u){t&1&&l(0,"span",107)}function Vt(t,u){t&1&&l(0,"i",66)}function Dt(t,u){if(t&1){let e=f();i(0,"button",104),h("click",function(){m(e);let n=c().$implicit,p=c(2);return g(p.deleteMessage(n._id))}),_(1,Rt,1,0,"span",105)(2,Vt,1,0,"i",106),o()}if(t&2){let e=c().$implicit,r=c(2);d("disabled",r.deletingMessageId===e._id),s(),d("ngIf",r.deletingMessageId===e._id),s(),d("ngIf",r.deletingMessageId!==e._id)}}function Ut(t,u){if(t&1&&(i(0,"div",93)(1,"div",94),_(2,Gt,1,1,"img",95)(3,Et,1,0,"i",96),o(),i(4,"div",97)(5,"div",98)(6,"strong"),a(7),o(),i(8,"small",99),a(9),B(10,"date"),o(),_(11,Dt,3,3,"button",100),o(),i(12,"p",101),a(13),o()()()),t&2){let e=u.$implicit,r=c(2);s(2),d("ngIf",e.author==null?null:e.author.picture),s(),d("ngIf",!(e.author!=null&&e.author.picture)),s(4),T("",e.author==null?null:e.author.name," ",e.author==null?null:e.author.surname,""),s(2),x(W(10,7,e.createdAt,"short")),s(2),d("ngIf",r.isOwnMessage(e)),s(2),x(e.content)}}function Lt(t,u){if(t&1){let e=f();i(0,"div")(1,"div",67)(2,"button",68),h("click",function(){m(e);let n=c();return g(n.backToThreadsList())}),l(3,"i",69),a(4,"Volver al foro "),o(),i(5,"div",70)(6,"div")(7,"h3",71),_(8,vt,1,0,"i",72)(9,Mt,1,0,"i",73),a(10),o(),_(11,Pt,2,1,"p",74),i(12,"small",12),a(13),B(14,"date"),o()(),_(15,kt,8,5,"div",75),o()(),_(16,St,6,4,"div",76)(17,It,3,0,"div",77),i(18,"div",78),_(19,Tt,3,0,"div",79)(20,Ut,14,10,"div",80),o()()}if(t&2){let e=c();s(8),d("ngIf",e.selectedThread.isPinned),s(),d("ngIf",e.selectedThread.isLocked),s(),b(" ",e.selectedThread.title," "),s(),d("ngIf",e.selectedThread.description),s(2),ie(" Creado por ",e.selectedThread.author==null?null:e.selectedThread.author.name," ",e.selectedThread.author==null?null:e.selectedThread.author.surname," el ",W(14,12,e.selectedThread.createdAt,"medium")," "),s(2),d("ngIf",e.isGroupTeacher()),s(),d("ngIf",e.canPostInForum&&(!e.selectedThread.isLocked||e.userRole==="teacher")),s(),d("ngIf",e.selectedThread.isLocked&&e.userRole!=="teacher"),s(2),d("ngIf",e.selectedThread.messages.length===0),s(),d("ngForOf",e.selectedThread.messages)}}function Ft(t,u){t&1&&l(0,"span",88)}function jt(t,u){t&1&&l(0,"i",108)}function At(t,u){if(t&1&&l(0,"div",109),t&2){let e=c();z("show",e.showNewThreadModal)}}var Pe=(()=>{class t{constructor(e){this.academicGroupService=e,this.groupId="",this.userRole="student",this.currentUserId="",this.canPostInForum=!1,this.teacherId="",this.url=D.url,this.discussionThreads=[],this.selectedThread=null,this.loadingThreads=!1,this.showThreadsList=!0,this.showNewThreadModal=!1,this.newThreadTitle="",this.newThreadDescription="",this.creatingThread=!1,this.newMessageText="",this.addingMessage=!1,this.deletingMessageId=null}ngOnInit(){this.loadDiscussionThreads()}loadDiscussionThreads(){this.groupId&&(this.loadingThreads=!0,this.academicGroupService.getDiscussionThreads(this.groupId).subscribe({next:e=>{this.discussionThreads=e.data||[],this.loadingThreads=!1},error:()=>{this.loadingThreads=!1}}))}openNewThreadModal(){this.showNewThreadModal=!0,this.newThreadTitle="",this.newThreadDescription="",document.body.style.overflow="hidden"}closeNewThreadModal(){this.showNewThreadModal=!1,this.newThreadTitle="",this.newThreadDescription="",document.body.style.overflow="auto"}createNewThread(){let e=(this.newThreadTitle||"").trim(),r=(this.newThreadDescription||"").trim();if(!e){alert("El t\xEDtulo es requerido");return}this.creatingThread=!0,this.academicGroupService.createDiscussionThread(this.groupId,e,r).subscribe({next:n=>{if(this.discussionThreads=n.data||[],this.closeNewThreadModal(),this.creatingThread=!1,this.discussionThreads.length>0){let p=this.discussionThreads.find(C=>C.title===e);p&&this.selectThread(p)}},error:()=>{this.creatingThread=!1,alert("Error al crear el thread")}})}selectThread(e){this.selectedThread=null,this.showThreadsList=!1,this.academicGroupService.getDiscussionThread(this.groupId,e._id).subscribe({next:r=>{this.selectedThread=r.data,this.newMessageText=""},error:()=>{alert("Error al cargar el thread"),this.showThreadsList=!0}})}backToThreadsList(){this.selectedThread=null,this.showThreadsList=!0,this.newMessageText="",this.loadDiscussionThreads()}addMessageToSelectedThread(){if(!this.selectedThread)return;let e=(this.newMessageText||"").trim();if(e){if(this.selectedThread.isLocked&&this.userRole!=="teacher"){alert("Este thread est\xE1 bloqueado y solo el profesor puede publicar");return}this.addingMessage=!0,this.academicGroupService.addMessageToThread(this.groupId,this.selectedThread._id,e).subscribe({next:r=>{this.selectedThread=r.data,this.newMessageText="",this.addingMessage=!1},error:()=>{this.addingMessage=!1,alert("Error al enviar el mensaje")}})}}deleteMessage(e){if(!this.selectedThread)return;let r=(this.selectedThread.messages||[]).find(n=>String(n._id)===String(e));if(r){if(!this.isOwnMessage(r)){alert("Solo puedes eliminar tus propios mensajes");return}confirm("\xBFEliminar este mensaje?")&&(this.deletingMessageId=e,this.academicGroupService.deleteMessageFromThread(this.groupId,this.selectedThread._id,e).subscribe({next:()=>{this.deletingMessageId=null,this.selectThread(this.selectedThread)},error:()=>{this.deletingMessageId=null,alert("Error al eliminar el mensaje")}}))}}isOwnMessage(e){let r=typeof e?.author=="object"?e.author?._id:e?.author;return String(r||"")===String(this.currentUserId||"")}deleteThread(e){confirm("\xBFEliminar este thread completo? Esta acci\xF3n no se puede deshacer.")&&this.academicGroupService.deleteDiscussionThread(this.groupId,e).subscribe({next:()=>{this.selectedThread&&this.selectedThread._id===e?this.backToThreadsList():this.loadDiscussionThreads()},error:r=>{alert(r.error?.message||"Error al eliminar el thread")}})}togglePinThread(e){this.academicGroupService.togglePinThread(this.groupId,e._id).subscribe({next:r=>{e.isPinned=r.data.isPinned,this.loadDiscussionThreads()},error:()=>{alert("Error al fijar/desfijar el thread")}})}toggleLockThread(e){this.academicGroupService.toggleLockThread(this.groupId,e._id).subscribe({next:r=>{e.isLocked=r.data.isLocked,this.selectedThread&&this.selectedThread._id===e._id&&(this.selectedThread.isLocked=r.data.isLocked)},error:()=>{alert("Error al bloquear/desbloquear el thread")}})}getThreadMessagesCount(e){return e.messages?e.messages.length:0}getThreadLastUpdate(e){return new Date(e.updatedAt||e.createdAt)}getGroupTeacherId(){let e=this.teacherId;return e?typeof e=="object"&&e._id?String(e._id):String(e):""}isGroupTeacher(){return this.getGroupTeacherId()===String(this.currentUserId||"")}static{this.\u0275fac=function(r){return new(r||t)(v(U))}}static{this.\u0275cmp=I({type:t,selectors:[["app-group-discussion"]],inputs:{groupId:"groupId",userRole:"userRole",currentUserId:"currentUserId",canPostInForum:"canPostInForum",teacherId:"teacherId"},decls:32,vars:13,consts:[[4,"ngIf"],["tabindex","-1","role","dialog","aria-labelledby","newThreadModalLabel",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered",3,"click"],[1,"modal-content"],[1,"modal-header"],["id","newThreadModalLabel",1,"modal-title"],[1,"fas","fa-plus-circle","me-2"],["type","button","aria-label","Cerrar",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mb-3"],[1,"form-label","fw-bold"],["type","text","placeholder","Ej: Dudas sobre materiales, recursos, etc.","maxlength","150",1,"form-control",3,"ngModelChange","ngModel"],[1,"text-muted"],["rows","4","placeholder","Describe brevemente de qu\xE9 trata esta conversaci\xF3n...","maxlength","500",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"fas","fa-times","me-2"],["type","button",1,"btn","btn-success",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","fas fa-check me-2",4,"ngIf"],["class","modal-backdrop fade",3,"show",4,"ngIf"],[1,"tab-header","d-flex","align-items-center","justify-content-between","mb-3"],[1,"m-0"],[1,"fas","fa-comments","me-2"],["class","btn btn-success",3,"click",4,"ngIf"],["class","text-center py-5",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","threads-list",4,"ngIf"],[1,"btn","btn-success",3,"click"],[1,"fas","fa-plus","me-2"],[1,"text-center","py-5"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"mt-3","text-muted"],[1,"empty-state"],[1,"empty-icon"],[1,"fas","fa-comments"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"click"],[1,"threads-list"],["class","thread-item",3,"click",4,"ngFor","ngForOf"],[1,"thread-item",3,"click"],[1,"thread-header-row"],[1,"thread-icons"],["class","fas fa-thumbtack text-warning me-2","title","Fijado",4,"ngIf"],["class","fas fa-lock text-danger me-2","title","Bloqueado",4,"ngIf"],[1,"fas","fa-comment-dots","text-primary"],[1,"thread-info","flex-grow-1"],[1,"thread-title","mb-1"],["class","thread-description text-muted mb-1",4,"ngIf"],[1,"thread-meta"],[1,"text-muted","small"],[1,"fas","fa-user"],[1,"text-muted","small","ms-3"],[1,"fas","fa-clock"],["class","thread-actions",4,"ngIf"],["title","Fijado",1,"fas","fa-thumbtack","text-warning","me-2"],["title","Bloqueado",1,"fas","fa-lock","text-danger","me-2"],[1,"thread-description","text-muted","mb-1"],[1,"thread-actions"],[1,"btn","btn-sm","btn-outline-primary","me-1",3,"click","title"],[1,"fas","fa-thumbtack"],[1,"btn","btn-sm","btn-outline-warning","me-1",3,"click","title"],[1,"fas","fa-lock"],["class","btn btn-sm btn-outline-danger","title","Eliminar",3,"click",4,"ngIf"],["title","Eliminar",1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"fas","fa-trash"],[1,"thread-view-header","mb-3"],[1,"btn","btn-outline-secondary","mb-3",3,"click"],[1,"fas","fa-arrow-left","me-2"],[1,"d-flex","justify-content-between","align-items-start"],[1,"mb-1"],["class","fas fa-thumbtack text-warning me-2",4,"ngIf"],["class","fas fa-lock text-danger me-2",4,"ngIf"],["class","text-muted",4,"ngIf"],["class","thread-actions-toolbar",4,"ngIf"],["class","new-message-form mb-4",4,"ngIf"],["class","alert alert-warning",4,"ngIf"],[1,"messages-container"],["class","empty-state-small",4,"ngIf"],["class","message-item",4,"ngFor","ngForOf"],[1,"fas","fa-thumbtack","text-warning","me-2"],[1,"fas","fa-lock","text-danger","me-2"],[1,"thread-actions-toolbar"],[1,"new-message-form","mb-4"],["rows","3","placeholder","Escribe tu mensaje...",1,"form-control","mb-2",3,"ngModelChange","ngModel"],[1,"btn","btn-primary",3,"click","disabled"],["class","fas fa-paper-plane me-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-paper-plane","me-2"],[1,"alert","alert-warning"],[1,"fas","fa-lock","me-2"],[1,"empty-state-small"],[1,"message-item"],[1,"message-avatar"],["class","rounded-circle","style","width: 40px; height: 40px; object-fit: cover;",3,"src",4,"ngIf"],["class","fas fa-user-circle","style","font-size: 2.5rem; color: #6c757d;",4,"ngIf"],[1,"message-content"],[1,"message-header"],[1,"text-muted","ms-2"],["class","btn btn-sm btn-outline-danger ms-auto",3,"disabled","click",4,"ngIf"],[1,"message-text"],[1,"rounded-circle",2,"width","40px","height","40px","object-fit","cover",3,"src"],[1,"fas","fa-user-circle",2,"font-size","2.5rem","color","#6c757d"],[1,"btn","btn-sm","btn-outline-danger","ms-auto",3,"click","disabled"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],["class","fas fa-trash",4,"ngIf"],[1,"spinner-border","spinner-border-sm","me-1"],[1,"fas","fa-check","me-2"],[1,"modal-backdrop","fade"]],template:function(r,n){r&1&&(_(0,bt,9,4,"div",0)(1,Lt,21,15,"div",0),i(2,"div",1)(3,"div",2),h("click",function(C){return C.stopPropagation()}),i(4,"div",3)(5,"div",4)(6,"h5",5),l(7,"i",6),a(8,"Nueva Conversaci\xF3n "),o(),i(9,"button",7),h("click",function(){return n.closeNewThreadModal()}),o()(),i(10,"div",8)(11,"div",9)(12,"label",10),a(13,"T\xEDtulo de la conversaci\xF3n *"),o(),i(14,"input",11),O("ngModelChange",function(C){return P(n.newThreadTitle,C)||(n.newThreadTitle=C),C}),o(),i(15,"small",12),a(16,"M\xE1ximo 150 caracteres"),o()(),i(17,"div",9)(18,"label",10),a(19,"Descripci\xF3n (opcional)"),o(),i(20,"textarea",13),O("ngModelChange",function(C){return P(n.newThreadDescription,C)||(n.newThreadDescription=C),C}),o(),i(21,"small",12),a(22,"M\xE1ximo 500 caracteres"),o()()(),i(23,"div",14)(24,"button",15),h("click",function(){return n.closeNewThreadModal()}),l(25,"i",16),a(26,"Cancelar "),o(),i(27,"button",17),h("click",function(){return n.createNewThread()}),_(28,Ft,1,0,"span",18)(29,jt,1,0,"i",19),a(30," Crear Conversaci\xF3n "),o()()()()(),_(31,At,1,2,"div",20)),r&2&&(d("ngIf",n.showThreadsList),s(),d("ngIf",!n.showThreadsList&&n.selectedThread),s(),te("display",n.showNewThreadModal?"block":"none"),z("show",n.showNewThreadModal),ee("aria-hidden",!n.showNewThreadModal),s(12),M("ngModel",n.newThreadTitle),s(6),M("ngModel",n.newThreadDescription),s(7),d("disabled",n.creatingThread||!(n.newThreadTitle!=null&&n.newThreadTitle.trim())),s(),d("ngIf",n.creatingThread),s(),d("ngIf",!n.creatingThread),s(2),d("ngIf",n.showNewThreadModal))},dependencies:[R,G,E,ae,V,F,j,ge,A],styles:['.thread-item[_ngcontent-%COMP%]{cursor:pointer;transition:all .3s ease}.thread-title[_ngcontent-%COMP%]{cursor:pointer;transition:color .2s ease}.thread-item[_ngcontent-%COMP%]:hover   .thread-title[_ngcontent-%COMP%]{color:#667eea;text-decoration:underline}.message-item[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa,#fff);border-left:4px solid #667eea;box-shadow:0 2px 8px #00000014;padding:20px;border-radius:12px;margin-bottom:16px;transition:all .3s ease}.message-item[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #0000001f;transform:translateY(-2px)}.message-content[_ngcontent-%COMP%]{background:#fff;padding:15px;border-radius:8px;box-shadow:inset 0 1px 3px #0000000d}.message-header[_ngcontent-%COMP%]{padding-bottom:10px;margin-bottom:10px;border-bottom:2px solid #e9ecef}.message-text[_ngcontent-%COMP%]{white-space:pre-wrap;word-wrap:break-word;line-height:1.7;color:#2c3e50;font-size:.95rem;margin:0;background:#f8f9fa;padding:12px;border-radius:6px;border-left:3px solid #dee2e6}.message-avatar[_ngcontent-%COMP%]{position:relative}.message-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .message-avatar[_ngcontent-%COMP%]   .fa-user-circle[_ngcontent-%COMP%]{box-shadow:0 2px 8px #0000001a}.new-message-form[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa,#e9ecef);padding:25px;border-radius:12px;border:2px solid #dee2e6;box-shadow:0 4px 12px #00000014}.new-message-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{border:2px solid #dee2e6;border-radius:8px;transition:all .3s ease;font-size:.95rem;line-height:1.6}.new-message-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:#667eea;box-shadow:0 0 0 .2rem #667eea40;outline:none}.new-message-form[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border:none;padding:10px 25px;font-weight:600;border-radius:8px;transition:all .3s ease;box-shadow:0 4px 12px #667eea4d}.new-message-form[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 16px #667eea66}.new-message-form[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.messages-container[_ngcontent-%COMP%]{padding:10px 0}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px;margin:10px 0}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:linear-gradient(180deg,#667eea,#764ba2);border-radius:10px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,#5568d3,#65408b)}.thread-item[_ngcontent-%COMP%]{position:relative;overflow:hidden}.thread-item[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:0;height:100%;width:4px;background:linear-gradient(180deg,#667eea,#764ba2);transform:scaleY(0);transition:transform .3s ease}.thread-item[_ngcontent-%COMP%]:hover:before{transform:scaleY(1)}.theme-dark[_nghost-%COMP%]   .message-item[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .message-item[_ngcontent-%COMP%]{background:linear-gradient(135deg,#111821,#1a1f24);border-left-color:#667eea;box-shadow:0 2px 8px #0000004d}.theme-dark[_nghost-%COMP%]   .message-content[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .message-content[_ngcontent-%COMP%]{background:#0f1420;box-shadow:inset 0 1px 3px #0000004d}.theme-dark[_nghost-%COMP%]   .message-header[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .message-header[_ngcontent-%COMP%]{border-bottom-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .message-text[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .message-text[_ngcontent-%COMP%]{color:var(--rd-text);background:#111821;border-left-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .new-message-form[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .new-message-form[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0f1420,#111821);border-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .new-message-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .new-message-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{background:#1a1f24;color:var(--rd-text);border-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .new-message-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .theme-dark   [_nghost-%COMP%]   .new-message-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:#667eea;box-shadow:0 0 0 .2rem #667eea40}.theme-dark[_nghost-%COMP%]   .thread-item[_ngcontent-%COMP%]:hover   .thread-title[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .thread-item[_ngcontent-%COMP%]:hover   .thread-title[_ngcontent-%COMP%]{color:#667eea}@keyframes _ngcontent-%COMP%_slideInLeft{0%{opacity:0;transform:translate(-20px)}to{opacity:1;transform:translate(0)}}.message-item[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInLeft .3s ease}.empty-state-small[_ngcontent-%COMP%]{padding:40px 20px;text-align:center;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border-radius:12px;border:2px dashed #dee2e6}.theme-dark[_nghost-%COMP%]   .empty-state-small[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .empty-state-small[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0f1420,#111821);border-color:#2a2f36}@media (max-width: 768px){.message-item[_ngcontent-%COMP%]{padding:15px}.message-content[_ngcontent-%COMP%]{padding:12px}.new-message-form[_ngcontent-%COMP%]{padding:20px}.message-text[_ngcontent-%COMP%]{font-size:.9rem}}']})}}return t})();function zt(t,u){t&1&&(i(0,"div",4)(1,"div",5)(2,"span",6),a(3,"Cargando..."),o()()())}function Nt(t,u){if(t&1&&(i(0,"div",7),a(1),o()),t&2){let e=c();s(),b(" ",e.error," ")}}function Bt(t,u){if(t&1){let e=f();i(0,"div",47)(1,"button",48),h("click",function(){m(e);let n=c(3);return g(n.editGroup())}),l(2,"i",49),a(3," Editar "),o(),i(4,"button",50),h("click",function(){m(e);let n=c(3);return g(n.deleteGroup())}),l(5,"i",51),a(6," Eliminar "),o()()}}function Wt(t,u){if(t&1&&(i(0,"div",38)(1,"div",39)(2,"h1"),a(3),o(),i(4,"p",40),a(5),o(),i(6,"div",41)(7,"span",42),a(8),o(),i(9,"span",43),a(10),o(),i(11,"span",44),a(12),o(),i(13,"span",45),a(14),o()()(),_(15,Bt,7,0,"div",46),o()),t&2){let e=c(2);s(3),x(e.group.name),s(2),x(e.group.description),s(3),x(e.getAcademicLevelLabel(e.group.academicLevel)),s(2),x(e.group.grade),s(2),x(e.group.academicYear),s(),d("ngClass",e.group.isActive?"bg-success":"bg-danger"),s(),b(" ",e.group.isActive?"Activo":"Inactivo"," "),s(),d("ngIf",e.canEditGroup())}}function qt(t,u){if(t&1&&(i(0,"option",72),a(1),o()),t&2){let e=u.$implicit;d("value",e),s(),x(e)}}function Yt(t,u){t&1&&l(0,"span",73)}function $t(t,u){t&1&&l(0,"i",74)}function Ht(t,u){if(t&1){let e=f();i(0,"div",38)(1,"div",52)(2,"h3",53),a(3,"Editar Grupo"),o(),i(4,"div",53)(5,"label",54),a(6,"Nombre del Grupo *"),o(),i(7,"input",55),O("ngModelChange",function(n){m(e);let p=c(2);return P(p.editedGroup.name,n)||(p.editedGroup.name=n),g(n)}),o()(),i(8,"div",53)(9,"label",54),a(10,"Descripci\xF3n *"),o(),i(11,"textarea",56),O("ngModelChange",function(n){m(e);let p=c(2);return P(p.editedGroup.description,n)||(p.editedGroup.description=n),g(n)}),o()(),i(12,"div",57)(13,"div",58)(14,"label",54),a(15,"Nivel Acad\xE9mico *"),o(),i(16,"select",59),O("ngModelChange",function(n){m(e);let p=c(2);return P(p.editedGroup.academicLevel,n)||(p.editedGroup.academicLevel=n),g(n)}),h("change",function(){m(e);let n=c(2);return g(n.loadValidGrades(n.editedGroup.academicLevel))}),i(17,"option",60),a(18,"Seleccionar nivel"),o(),i(19,"option",61),a(20,"Colegio"),o(),i(21,"option",62),a(22,"Universidad"),o()()(),i(23,"div",58)(24,"label",54),a(25,"Grado *"),o(),i(26,"select",63),O("ngModelChange",function(n){m(e);let p=c(2);return P(p.editedGroup.grade,n)||(p.editedGroup.grade=n),g(n)}),i(27,"option",60),a(28,"Seleccionar grado"),o(),_(29,qt,2,2,"option",64),o()()(),i(30,"div",53)(31,"label",54),a(32,"M\xE1ximo de Estudiantes"),o(),i(33,"input",65),O("ngModelChange",function(n){m(e);let p=c(2);return P(p.editedGroup.maxStudents,n)||(p.editedGroup.maxStudents=n),g(n)}),o()(),i(34,"div",66)(35,"button",67),h("click",function(){m(e);let n=c(2);return g(n.saveGroup())}),_(36,Yt,1,0,"span",68)(37,$t,1,0,"i",69),a(38," Guardar Cambios "),o(),i(39,"button",70),h("click",function(){m(e);let n=c(2);return g(n.cancelEdit())}),l(40,"i",71),a(41," Cancelar "),o()()()()}if(t&2){let e=c(2);s(7),M("ngModel",e.editedGroup.name),s(4),M("ngModel",e.editedGroup.description),s(5),M("ngModel",e.editedGroup.academicLevel),s(10),M("ngModel",e.editedGroup.grade),s(3),d("ngForOf",e.validGrades),s(4),M("ngModel",e.editedGroup.maxStudents),s(2),d("disabled",e.savingGroup),s(),d("ngIf",e.savingGroup),s(),d("ngIf",!e.savingGroup)}}function Xt(t,u){if(t&1){let e=f();i(0,"button",48),h("click",function(){m(e);let n=c(2);return g(n.createLesson())}),l(1,"i",75),a(2," Crear Lecci\xF3n "),o()}}function Jt(t,u){if(t&1){let e=f();i(0,"button",48),h("click",function(){m(e);let n=c(3);return g(n.createLesson())}),a(1," Crear Primera Lecci\xF3n "),o()}}function Kt(t,u){if(t&1&&(i(0,"div",76)(1,"div",77),l(2,"i",15),o(),i(3,"h4"),a(4,"No hay lecciones"),o(),i(5,"p"),a(6,"Este grupo a\xFAn no tiene lecciones creadas."),o(),_(7,Jt,2,0,"button",29),o()),t&2){let e=c(2);s(7),d("ngIf",e.canCreateLesson())}}function Qt(t,u){if(t&1){let e=f();i(0,"div",80)(1,"div",81)(2,"h4"),a(3),o(),i(4,"span",45),a(5),o()(),i(6,"div",82)(7,"p"),a(8),o(),i(9,"div",83)(10,"small"),l(11,"i",84),a(12),o()()(),i(13,"div",85)(14,"button",86),h("click",function(){let n=m(e).$implicit,p=c(3);return g(p.viewLesson(n._id))}),l(15,"i",87),a(16," Ver "),o()()()}if(t&2){let e=u.$implicit,r=c(3);s(3),x(e.title),s(),d("ngClass",r.getStatusBadgeClass(e.status)),s(),b(" ",r.getStatusLabel(e.status)," "),s(3),x(e.resume),s(4),b(" ",r.getAuthorName(e),"")}}function Zt(t,u){if(t&1&&(i(0,"div",78),_(1,Qt,17,5,"div",79),o()),t&2){let e=c(2);s(),d("ngForOf",e.lessons)}}function en(t,u){if(t&1){let e=f();i(0,"div",8),_(1,Wt,16,8,"div",9)(2,Ht,42,9,"div",9),i(3,"div",10)(4,"div",11)(5,"div",12),l(6,"i",13),o(),i(7,"div",14)(8,"h3"),a(9),o(),i(10,"p"),a(11,"Estudiantes"),o()()(),i(12,"div",11)(13,"div",12),l(14,"i",15),o(),i(15,"div",14)(16,"h3"),a(17),o(),i(18,"p"),a(19,"Lecciones"),o()()(),i(20,"div",11)(21,"div",12),l(22,"i",16),o(),i(23,"div",14)(24,"h3"),a(25),o(),i(26,"p"),a(27,"Capacidad M\xE1xima"),o()()()(),i(28,"div",17)(29,"ul",18)(30,"li",19)(31,"button",20),l(32,"i",15),a(33," Lecciones "),o()(),i(34,"li",19)(35,"button",21),l(36,"i",13),a(37," Estudiantes "),o()(),i(38,"li",19)(39,"button",22),l(40,"i",23),a(41," Discusi\xF3n "),o()(),i(42,"li",19)(43,"button",24),l(44,"i",25),a(45," Recursos "),o()()(),i(46,"div",26)(47,"div",27)(48,"div",28)(49,"h3"),a(50,"Lecciones del Grupo"),o(),_(51,Xt,3,0,"button",29),o(),_(52,Kt,8,1,"div",30)(53,Zt,2,1,"div",31),o(),i(54,"div",32)(55,"app-group-students",33),h("studentsUpdated",function(){m(e);let n=c();return g(n.onStudentsUpdated())}),o()(),i(56,"div",34),l(57,"app-group-discussion",35),o(),i(58,"div",36)(59,"app-group-resources",37),h("resourcesUpdated",function(){m(e);let n=c();return g(n.onResourcesUpdated())}),o()()()()()}if(t&2){let e=c();s(),d("ngIf",!e.editMode),s(),d("ngIf",e.editMode),s(7),x(e.students.length),s(8),x(e.lessons.length),s(8),x(e.group.maxStudents),s(26),d("ngIf",e.canCreateLesson()),s(),d("ngIf",e.lessons.length===0),s(),d("ngIf",e.lessons.length>0),s(2),d("groupId",e.groupId)("students",e.students)("userRole",e.userRole)("currentUserRole",e.currentUserRole)("teacherId",e.group==null?null:e.group.teacher)("currentUserId",e.currentUserId),s(2),d("groupId",e.groupId)("userRole",e.userRole)("currentUserId",e.currentUserId)("teacherId",e.group==null?null:e.group.teacher)("canPostInForum",e.canPostInForum()),s(2),d("groupId",e.groupId)("groupResources",e.groupResources)("userRole",e.userRole)("token",e.token)("teacherId",e.group==null?null:e.group.teacher)("currentUserId",e.currentUserId)}}var En=(()=>{class t{constructor(e,r,n,p,C,w){this.route=e,this.router=r,this.academicGroupService=n,this.academicLessonService=p,this.userService=C,this.resourceService=w,this.group=null,this.lessons=[],this.students=[],this.loading=!1,this.error="",this.groupId="",this.userRole="student",this.currentUserId="",this.currentUserRole="",this.url=D.url,this.editMode=!1,this.startInEditMode=!1,this.editedGroup={},this.validGrades=[],this.savingGroup=!1,this.groupResources=[],this.token=""}ngOnInit(){this.groupId=this.route.snapshot.paramMap.get("id")||"",this.token=this.userService.getToken()||"",this.determineUserRole(),this.startInEditMode=this.route.snapshot.queryParamMap.get("editMode")==="true",this.loadGroupDetails(),this.loadGroupLessons(),this.userRole==="teacher"&&this.loadGroupStudents(),this.loadGroupResources()}determineUserRole(){try{let e=localStorage.getItem("identity")||localStorage.getItem("user")||"{}",r=JSON.parse(e);this.currentUserId=r?._id||"";let n=(r?.role||"").toString().toLowerCase();this.currentUserRole=n==="facilitator"?"expert":n,["teacher","admin","delegated_admin","lesson_manager","expert"].includes(this.currentUserRole)?this.userRole="teacher":this.userRole="student"}catch{this.userRole="student"}}loadGroupDetails(){if(!this.groupId){this.error="ID de grupo no v\xE1lido";return}this.loading=!0,this.academicGroupService.getGroupById(this.groupId).subscribe({next:e=>{this.group=e.data,console.log("[GroupDetail] Grupo cargado:",{groupId:this.group._id,teacher:this.group.teacher,students:this.group.students,currentUserId:this.currentUserId,currentUserRole:this.currentUserRole}),this.group&&this.currentUserId&&this.group.teacher?.toString?.()===this.currentUserId&&(this.userRole="teacher",this.loadGroupStudents()),this.loading=!1,this.startInEditMode&&this.canEditGroup()&&this.editGroup(),console.log("[GroupDetail] Permisos de foro:",{canPost:this.canPostInForum(),isTeacher:this.userRole==="teacher",currentUserRole:this.currentUserRole})},error:e=>{this.error="Error al cargar los detalles del grupo",this.loading=!1,console.error("Error loading group details:",e)}})}loadGroupLessons(){this.groupId&&this.academicLessonService.getGroupLessons(this.groupId).subscribe({next:e=>{this.lessons=e.data||[]},error:e=>{console.error("Error loading group lessons:",e)}})}canPostInForum(){if(!this.group||!this.currentUserId)return!1;let e=this.group.teacher,n=(typeof e=="object"&&e?._id?e._id:e)?.toString()===this.currentUserId,C=(this.group.students||[]).some(y=>y?typeof y=="object"&&y._id?y._id.toString()===this.currentUserId:(y.toString?y.toString():y)===this.currentUserId:!1),w=["admin","delegated_admin","lesson_manager"].includes(this.currentUserRole);return n||C||w}loadGroupResources(){this.groupId&&this.academicGroupService.getGroupResources(this.groupId).subscribe({next:e=>this.groupResources=e.data||[],error:()=>{}})}loadGroupStudents(){this.groupId&&this.academicGroupService.getGroupStudents(this.groupId).subscribe({next:e=>{this.students=e.data||[]},error:e=>{console.error("Error loading group students:",e)}})}onStudentsUpdated(){this.loadGroupStudents()}onResourcesUpdated(){this.loadGroupResources()}editGroup(){this.editMode=!0,this.editedGroup=Q({},this.group),this.editedGroup.academicLevel&&this.loadValidGrades(this.editedGroup.academicLevel)}loadValidGrades(e){this.academicGroupService.getValidGrades(e).subscribe({next:r=>{this.validGrades=r.data},error:r=>{console.error("Error al cargar grados v\xE1lidos:",r)}})}saveGroup(){if(!this.editedGroup.name||!this.editedGroup.description||!this.editedGroup.academicLevel||!this.editedGroup.grade){alert("Por favor completa todos los campos obligatorios");return}this.savingGroup=!0,this.academicGroupService.updateGroup(this.groupId,this.editedGroup).subscribe({next:()=>{this.loadGroupDetails(),this.editMode=!1,this.savingGroup=!1,alert("Grupo actualizado exitosamente")},error:e=>{console.error("Error al actualizar grupo:",e),alert(e.error?.message||"Error al actualizar el grupo"),this.savingGroup=!1}})}cancelEdit(){this.editMode=!1,this.editedGroup={}}deleteGroup(){confirm("\xBFEst\xE1s seguro de que quieres eliminar este grupo? Esta acci\xF3n no se puede deshacer.")&&this.academicGroupService.deleteGroup(this.groupId).subscribe({next:()=>{this.router.navigate(["/academia/groups"])},error:e=>{this.error="Error al eliminar el grupo",console.error("Error deleting group:",e)}})}getAuthorName(e){let r=e&&e.author||null;return r?typeof r=="string"?r:r.name||"Autor":"Autor"}viewLesson(e){this.router.navigate(["/academia/lessons",e])}createLesson(){this.router.navigate(["/academia/lessons/create"],{queryParams:{groupId:this.groupId}})}getAcademicLevelLabel(e){return e==="Colegio"?"Colegio":"Universidad"}getStatusLabel(e){return{draft:"Borrador",proposed:"Propuesta",approved:"Aprobada",rejected:"Rechazada",in_development:"En Desarrollo",completed:"Completada",graded:"Calificada"}[e]||e}getStatusBadgeClass(e){return{draft:"badge-secondary",proposed:"badge-warning",approved:"badge-success",rejected:"badge-danger",in_development:"badge-info",completed:"badge-primary",graded:"badge-success"}[e]||"badge-secondary"}canEditGroup(){return this.userRole==="teacher"||["admin","delegated_admin","lesson_manager"].includes(this.currentUserRole)}canDeleteGroup(){return this.userRole==="teacher"||["admin","delegated_admin","lesson_manager"].includes(this.currentUserRole)}canAddStudents(){return this.userRole==="teacher"||["admin","delegated_admin","lesson_manager"].includes(this.currentUserRole)}canRemoveStudents(){return this.userRole==="teacher"||["admin","delegated_admin","lesson_manager"].includes(this.currentUserRole)}canCreateLesson(){return this.userRole==="teacher"||["admin","delegated_admin","lesson_manager"].includes(this.currentUserRole)?!0:(console.log(this.group?.permissions?.studentsCanCreateLessons),this.group?.permissions?.studentsCanCreateLessons===!0)}static{this.\u0275fac=function(r){return new(r||t)(v(_e),v(he),v(U),v(Ce),v(Y),v($))}}static{this.\u0275cmp=I({type:t,selectors:[["app-group-detail"]],decls:4,vars:3,consts:[[1,"group-detail-container"],["class","loading-container",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["class","group-content",4,"ngIf"],[1,"loading-container"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"alert","alert-danger"],[1,"group-content"],["class","group-header",4,"ngIf"],[1,"statistics-section"],[1,"stat-card"],[1,"stat-icon"],[1,"fas","fa-users"],[1,"stat-content"],[1,"fas","fa-book"],[1,"fas","fa-chart-line"],[1,"tabs-section"],["id","groupTabs","role","tablist",1,"nav","nav-tabs"],["role","presentation",1,"nav-item"],["id","lessons-tab","data-bs-toggle","tab","data-bs-target","#lessons","type","button","role","tab",1,"nav-link","active"],["id","students-tab","data-bs-toggle","tab","data-bs-target","#students","type","button","role","tab",1,"nav-link"],["id","discussion-tab","data-bs-toggle","tab","data-bs-target","#discussion","type","button","role","tab",1,"nav-link"],[1,"fas","fa-comments"],["id","resources-tab","data-bs-toggle","tab","data-bs-target","#resources","type","button","role","tab",1,"nav-link"],[1,"fas","fa-folder-open"],["id","groupTabsContent",1,"tab-content"],["id","lessons","role","tabpanel",1,"tab-pane","fade","show","active"],[1,"tab-header"],["class","btn btn-primary",3,"click",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","lessons-grid",4,"ngIf"],["id","students","role","tabpanel",1,"tab-pane","fade"],[3,"studentsUpdated","groupId","students","userRole","currentUserRole","teacherId","currentUserId"],["id","discussion","role","tabpanel",1,"tab-pane","fade"],[3,"groupId","userRole","currentUserId","teacherId","canPostInForum"],["id","resources","role","tabpanel",1,"tab-pane","fade"],[3,"resourcesUpdated","groupId","groupResources","userRole","token","teacherId","currentUserId"],[1,"group-header"],[1,"group-info"],[1,"group-description"],[1,"group-meta"],[1,"badge","bg-primary"],[1,"badge","bg-secondary"],[1,"badge","bg-info","text-dark"],[1,"badge",3,"ngClass"],["class","group-actions",4,"ngIf"],[1,"group-actions"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-edit"],[1,"btn","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"group-info","w-100"],[1,"mb-3"],[1,"form-label"],["type","text","placeholder","Nombre del grupo",1,"form-control",3,"ngModelChange","ngModel"],["rows","3","placeholder","Descripci\xF3n del grupo",1,"form-control",3,"ngModelChange","ngModel"],[1,"row"],[1,"col-md-6","mb-3"],[1,"form-control",3,"ngModelChange","change","ngModel"],["value",""],["value","Colegio"],["value","Universidad"],[1,"form-control",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["type","number","min","1","max","100",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","gap-2"],[1,"btn","btn-success",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","fas fa-save",4,"ngIf"],[1,"btn","btn-secondary",3,"click"],[1,"fas","fa-times"],[3,"value"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-save"],[1,"fas","fa-plus"],[1,"empty-state"],[1,"empty-icon"],[1,"lessons-grid"],["class","lesson-card",4,"ngFor","ngForOf"],[1,"lesson-card"],[1,"lesson-header"],[1,"lesson-content"],[1,"lesson-meta"],[1,"fas","fa-user"],[1,"lesson-actions"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"fas","fa-eye"]],template:function(r,n){r&1&&(i(0,"div",0),_(1,zt,4,0,"div",1)(2,Nt,2,1,"div",2)(3,en,60,25,"div",3),o()),r&2&&(s(),d("ngIf",n.loading),s(),d("ngIf",n.error),s(),d("ngIf",!n.loading&&n.group))},dependencies:[R,q,G,E,V,le,ue,F,ce,de,j,me,pe,A,fe,ve,Me,Pe],styles:[".group-detail-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:50px}.alert[_ngcontent-%COMP%]{padding:15px;margin-bottom:20px;border-radius:5px}.alert-danger[_ngcontent-%COMP%]{background-color:#f8d7da;border:1px solid #f5c6cb;color:#721c24}.group-content[_ngcontent-%COMP%]{background:#fff;border-radius:10px;box-shadow:0 4px 6px #0000001a;overflow:hidden;margin:1rem}.group-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:30px;display:flex;justify-content:space-between;align-items:flex-start}.group-info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 10px;font-size:2.5rem;font-weight:700}.group-description[_ngcontent-%COMP%]{margin:0 0 20px;font-size:1.1rem;opacity:.9;line-height:1.6}.group-meta[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap}.badge[_ngcontent-%COMP%]{padding:8px 12px;border-radius:20px;font-size:12px;font-weight:600}.badge-primary[_ngcontent-%COMP%]{background-color:#fff3;color:#fff}.badge-secondary[_ngcontent-%COMP%], .badge-info[_ngcontent-%COMP%]{background-color:#ffffff26;color:#fff}.badge-success[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.badge-danger[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.group-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.btn[_ngcontent-%COMP%]{padding:10px 20px;border-radius:5px;text-decoration:none;display:inline-flex;align-items:center;gap:8px;transition:all .3s ease;border:none;cursor:pointer;font-weight:600}.btn-primary[_ngcontent-%COMP%]{background-color:#fff3;color:#fff;border:1px solid rgba(255,255,255,.3)}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#ffffff4d;transform:translateY(-2px)}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545cc;color:#fff;border:1px solid rgba(220,53,69,.9)}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#dc3545;transform:translateY(-2px)}.statistics-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;padding:30px;background:#f8f9fa}.stat-card[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:10px;box-shadow:0 2px 4px #0000001a;display:flex;align-items:center;gap:15px;transition:transform .3s ease}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.stat-icon[_ngcontent-%COMP%]{width:50px;height:50px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.5rem}.stat-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:2rem;font-weight:700;color:#2c3e50}.stat-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0 0;color:#6c757d;font-weight:500}.tabs-section[_ngcontent-%COMP%]{padding:30px}.nav-tabs[_ngcontent-%COMP%]{border-bottom:2px solid #e9ecef;margin-bottom:30px}.nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{border:none;color:#6c757d;font-weight:600;padding:15px 25px;display:flex;align-items:center;gap:8px;transition:all .3s ease}.nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{color:#3498db;background:none;border:none}.nav-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:#3498db;background:none;border:none;border-bottom:3px solid #3498db}.tab-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.tab-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#2c3e50;font-weight:600}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#6c757d}.empty-icon[_ngcontent-%COMP%]{font-size:4rem;color:#dee2e6;margin-bottom:20px}.empty-state[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#495057;margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:20px;font-size:16px}.lessons-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.lesson-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e9ecef;border-radius:10px;padding:20px;transition:all .3s ease}.lesson-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 8px 15px #0000001a}.lesson-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:15px}.lesson-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 10px 0 0;color:#2c3e50;font-weight:600;flex:1}.lesson-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d;margin-bottom:15px;line-height:1.5}.lesson-meta[_ngcontent-%COMP%]{display:flex;gap:15px;margin-bottom:15px}.lesson-meta[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#6c757d;display:flex;align-items:center;gap:5px}.lesson-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.btn-sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px}.btn-outline-primary[_ngcontent-%COMP%]{color:#3498db;border-color:#3498db;background:transparent}.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:#3498db;border-color:#3498db;color:#fff}.tab-header[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background-color:#3498db;border-color:#3498db;color:#fff;padding:10px 20px;border-radius:5px;text-decoration:none;display:inline-flex;align-items:center;gap:8px;transition:all .3s ease;border:1px solid #3498db;cursor:pointer;font-weight:600}.tab-header[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{background-color:#2980b9;border-color:#2980b9;transform:translateY(-2px);box-shadow:0 4px 8px #3498db4d}.empty-state[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background-color:#3498db;border-color:#3498db;color:#fff;padding:12px 24px;border-radius:5px;text-decoration:none;display:inline-flex;align-items:center;gap:8px;transition:all .3s ease;border:1px solid #3498db;cursor:pointer;font-weight:600;font-size:16px}.empty-state[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{background-color:#2980b9;border-color:#2980b9;transform:translateY(-2px);box-shadow:0 4px 8px #3498db4d}.students-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:20px}.student-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e9ecef;border-radius:10px;padding:12px;display:flex;flex-direction:column;gap:8px;transition:all .3s ease}.student-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 4px 8px #0000001a}.student-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.student-avatar[_ngcontent-%COMP%]{width:50px;height:50px;background:#f8f9fa;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#6c757d;font-size:1.5rem;overflow:hidden;flex-shrink:0}.student-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.student-info[_ngcontent-%COMP%]{flex:1}.student-info[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 0 4px;color:#2c3e50;font-weight:600;font-size:1rem}.student-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;color:#6c757d;font-size:13px}.student-stats[_ngcontent-%COMP%]{display:flex;gap:15px}.student-stats[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#6c757d;font-size:12px}.student-actions[_ngcontent-%COMP%]{display:flex;gap:5px}.btn-outline-danger[_ngcontent-%COMP%]{color:#dc3545;border-color:#dc3545;background:transparent}.btn-outline-danger[_ngcontent-%COMP%]:hover{background-color:#dc3545;border-color:#dc3545;color:#fff}@media (max-width: 768px){.group-detail-container[_ngcontent-%COMP%]{padding:10px}.group-header[_ngcontent-%COMP%]{flex-direction:column;gap:20px;align-items:stretch}.group-info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem}.group-actions[_ngcontent-%COMP%]{justify-content:center}.statistics-section[_ngcontent-%COMP%]{grid-template-columns:1fr;padding:20px}.tabs-section[_ngcontent-%COMP%]{padding:20px}.nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding:10px 15px;font-size:14px}.tab-header[_ngcontent-%COMP%]{flex-direction:column;gap:15px;align-items:stretch}.lessons-grid[_ngcontent-%COMP%], .students-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 480px){.group-header[_ngcontent-%COMP%]{padding:20px}.group-info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.group-meta[_ngcontent-%COMP%]{justify-content:center}.statistics-section[_ngcontent-%COMP%], .tabs-section[_ngcontent-%COMP%]{padding:15px}}.theme-dark[_nghost-%COMP%]   .group-detail-container[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .group-detail-container[_ngcontent-%COMP%]{color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .group-content[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .group-content[_ngcontent-%COMP%]{background:#1a1f24f2;color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .group-header[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .group-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#111a22,#1a1f24);color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .group-info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .group-info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff}.theme-dark[_nghost-%COMP%]   .group-description[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .group-description[_ngcontent-%COMP%]{color:var(--rd-muted)}.theme-dark[_nghost-%COMP%]   .statistics-section[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .statistics-section[_ngcontent-%COMP%]{background:#0f1420}.theme-dark[_nghost-%COMP%]   .stat-card[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .stat-card[_ngcontent-%COMP%]{background:#111821;border-color:#2a2f36;color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .stat-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .stat-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .stat-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .stat-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--rd-muted)}.theme-dark[_nghost-%COMP%]   .nav-tabs[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .nav-tabs[_ngcontent-%COMP%]{border-bottom-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:var(--rd-muted)}.theme-dark[_nghost-%COMP%]   .nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover, .theme-dark   [_nghost-%COMP%]   .nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{color:var(--rd-primary)}.theme-dark[_nghost-%COMP%]   .nav-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .nav-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:var(--rd-primary);border-bottom-color:var(--rd-primary)}.theme-dark[_nghost-%COMP%]   .tab-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .tab-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .empty-state[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .empty-state[_ngcontent-%COMP%]{color:var(--rd-muted)}.theme-dark[_nghost-%COMP%]   .lessons-grid[_ngcontent-%COMP%]   .lesson-card[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .lessons-grid[_ngcontent-%COMP%]   .lesson-card[_ngcontent-%COMP%], .theme-dark[_nghost-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-card[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-card[_ngcontent-%COMP%]{background:#0f1420;border-color:#2a2f36;color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .lesson-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .lesson-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .theme-dark[_nghost-%COMP%]   .student-info[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .student-info[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .lesson-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .lesson-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .theme-dark[_nghost-%COMP%]   .student-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .student-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .theme-dark[_nghost-%COMP%]   .student-stats[_ngcontent-%COMP%]   small[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .student-stats[_ngcontent-%COMP%]   small[_ngcontent-%COMP%], .theme-dark[_nghost-%COMP%]   .lesson-meta[_ngcontent-%COMP%]   small[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .lesson-meta[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:var(--rd-muted)}.theme-dark[_nghost-%COMP%]   .student-avatar[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .student-avatar[_ngcontent-%COMP%]{background:#0b1020;color:#94a3b8}.resource-item-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border:1px solid #e9ecef;transition:all .3s ease}.resource-item-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a;transform:translateY(-2px)}.resources-modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#000000b3;display:flex;justify-content:center;align-items:center;z-index:9999;padding:20px;animation:_ngcontent-%COMP%_fadeIn .2s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.resources-modal-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;width:100%;max-width:1200px;height:85vh;display:flex;flex-direction:column;box-shadow:0 10px 40px #0000004d;animation:_ngcontent-%COMP%_slideUp .3s ease}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(50px);opacity:0}to{transform:translateY(0);opacity:1}}.resources-modal-header[_ngcontent-%COMP%]{padding:20px 30px;border-bottom:1px solid #e9ecef;display:flex;justify-content:space-between;align-items:center;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:12px 12px 0 0}.resources-modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600}.btn-close-modal[_ngcontent-%COMP%]{background:#fff3;border:none;color:#fff;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;font-size:1.2rem}.btn-close-modal[_ngcontent-%COMP%]:hover{background:#ffffff4d;transform:rotate(90deg)}.resources-modal-body[_ngcontent-%COMP%]{flex:1;overflow:hidden;padding:0}.resources-column[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;padding:20px;border-right:1px solid #e9ecef}.resources-column.selection-column[_ngcontent-%COMP%]{border-right:none;background:#f8f9fa}.column-header[_ngcontent-%COMP%]{padding-bottom:15px;border-bottom:2px solid #e9ecef;margin-bottom:15px}.column-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;color:#2c3e50;font-weight:600;font-size:1.1rem}.resources-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding-right:10px}.resources-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.resources-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}.resources-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:10px}.resources-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}.resource-item[_ngcontent-%COMP%]{padding:15px;margin-bottom:10px;border:2px solid #e9ecef;border-radius:8px;cursor:pointer;transition:all .2s ease;background:#fff}.resource-item[_ngcontent-%COMP%]:hover{border-color:#667eea;box-shadow:0 2px 8px #667eea33;transform:translate(5px)}.resource-item.selected[_ngcontent-%COMP%]{border-color:#28a745;background:#f0fff4}.resource-item.selected-item[_ngcontent-%COMP%]{background:#fff;border-color:#28a745;cursor:default}.resource-item.selected-item[_ngcontent-%COMP%]:hover{transform:none}.resource-icon-small[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.5rem;flex-shrink:0}.resource-name[_ngcontent-%COMP%]{color:#2c3e50;font-weight:600;font-size:.95rem;line-height:1.4}.resource-description[_ngcontent-%COMP%]{font-size:.85rem;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}.resource-check[_ngcontent-%COMP%]{font-size:1.5rem;flex-shrink:0;margin-left:10px}.btn-remove-selection[_ngcontent-%COMP%]{background:#dc3545;border:none;color:#fff;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;flex-shrink:0;margin-left:10px}.btn-remove-selection[_ngcontent-%COMP%]:hover{background:#c82333;transform:scale(1.1)}.empty-state-small[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center}.resources-modal-footer[_ngcontent-%COMP%]{padding:20px 30px;border-top:1px solid #e9ecef;display:flex;justify-content:flex-end;gap:10px;background:#f8f9fa;border-radius:0 0 12px 12px}.resources-modal-footer[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:10px 24px;font-weight:600;border-radius:6px;transition:all .3s ease}.resources-modal-footer[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background:#6c757d;border-color:#6c757d;color:#fff}.resources-modal-footer[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover{background:#5a6268;border-color:#545b62}.resources-modal-footer[_ngcontent-%COMP%]   .btn-success[_ngcontent-%COMP%]{background:#28a745;border-color:#28a745;color:#fff}.resources-modal-footer[_ngcontent-%COMP%]   .btn-success[_ngcontent-%COMP%]:hover:not(:disabled){background:#218838;border-color:#1e7e34;transform:translateY(-2px);box-shadow:0 4px 12px #28a7454d}.resources-modal-footer[_ngcontent-%COMP%]   .btn-success[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.theme-dark[_nghost-%COMP%]   .resource-item-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resource-item-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background:#0f1420;border-color:#2a2f36;color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .resources-modal-container[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resources-modal-container[_ngcontent-%COMP%]{background:#1a1f24;color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .resources-modal-header[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resources-modal-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#111a22,#1a1f24)}.theme-dark[_nghost-%COMP%]   .column-header[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .column-header[_ngcontent-%COMP%]{border-bottom-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .column-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .column-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .resources-column[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resources-column[_ngcontent-%COMP%]{border-right-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .resources-column.selection-column[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resources-column.selection-column[_ngcontent-%COMP%]{background:#0f1420}.theme-dark[_nghost-%COMP%]   .resource-item[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resource-item[_ngcontent-%COMP%]{background:#111821;border-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .resource-item[_ngcontent-%COMP%]:hover, .theme-dark   [_nghost-%COMP%]   .resource-item[_ngcontent-%COMP%]:hover{border-color:#667eea;background:#1a1f24}.theme-dark[_nghost-%COMP%]   .resource-item.selected[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resource-item.selected[_ngcontent-%COMP%], .theme-dark[_nghost-%COMP%]   .resource-item.selected-item[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resource-item.selected-item[_ngcontent-%COMP%]{background:#0d1f15;border-color:#28a745}.theme-dark[_nghost-%COMP%]   .resource-name[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resource-name[_ngcontent-%COMP%]{color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .resources-modal-footer[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .resources-modal-footer[_ngcontent-%COMP%]{background:#0f1420;border-top-color:#2a2f36}@media (max-width: 768px){.resources-modal-container[_ngcontent-%COMP%]{height:95vh;max-width:100%;margin:0;border-radius:0}.resources-modal-header[_ngcontent-%COMP%]{padding:15px 20px;border-radius:0}.resources-modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.2rem}.resources-modal-body[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{flex-direction:column}.resources-column[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #e9ecef;max-height:40vh}.resources-column.selection-column[_ngcontent-%COMP%]{border-bottom:none}.resources-modal-footer[_ngcontent-%COMP%]{padding:15px}.resource-item[_ngcontent-%COMP%]:hover{transform:none}}.threads-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.thread-item[_ngcontent-%COMP%]{background:#fff;border:1px solid #e9ecef;border-radius:8px;padding:20px;transition:all .3s ease;cursor:pointer}.thread-item[_ngcontent-%COMP%]:hover{border-color:#667eea;box-shadow:0 4px 12px #667eea26;transform:translate(5px)}.thread-header-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px}.thread-icons[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:1.5rem;min-width:40px}.thread-info[_ngcontent-%COMP%]{flex:1;min-width:0}.thread-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#2c3e50;margin:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.thread-description[_ngcontent-%COMP%]{font-size:.9rem;margin:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.thread-meta[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}.thread-actions[_ngcontent-%COMP%]{display:flex;gap:5px}.thread-actions-toolbar[_ngcontent-%COMP%]{display:flex;gap:5px;flex-wrap:wrap}.thread-view-header[_ngcontent-%COMP%]{border-bottom:2px solid #e9ecef;padding-bottom:20px}.new-message-form[_ngcontent-%COMP%]{background:#f8f9fa;padding:20px;border-radius:8px;border:1px solid #e9ecef}.messages-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px;max-height:600px;overflow-y:auto;padding-right:10px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:10px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}.message-item[_ngcontent-%COMP%]{display:flex;gap:15px;padding:15px;background:#fff;border:1px solid #e9ecef;border-radius:8px;transition:all .2s ease}.message-item[_ngcontent-%COMP%]:hover{background:#f8f9fa;box-shadow:0 2px 8px #0000000d}.message-avatar[_ngcontent-%COMP%]{flex-shrink:0}.message-content[_ngcontent-%COMP%]{flex:1;min-width:0}.message-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-bottom:8px}.message-text[_ngcontent-%COMP%]{margin:0;line-height:1.6;word-wrap:break-word;white-space:pre-wrap;color:#2c3e50}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#000000b3;display:flex;justify-content:center;align-items:center;z-index:9999;animation:_ngcontent-%COMP%_fadeIn .2s ease}.modal-dialog-custom[_ngcontent-%COMP%]{background:#fff;border-radius:12px;width:90%;max-width:600px;max-height:85vh;display:flex;flex-direction:column;box-shadow:0 10px 40px #0000004d;animation:_ngcontent-%COMP%_slideUp .3s ease}.modal-header-custom[_ngcontent-%COMP%]{padding:20px 30px;border-bottom:1px solid #e9ecef;display:flex;justify-content:space-between;align-items:center;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:12px 12px 0 0}.modal-header-custom[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-weight:600}.btn-close-custom[_ngcontent-%COMP%]{background:#fff3;border:none;color:#fff;width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;font-size:1.1rem}.btn-close-custom[_ngcontent-%COMP%]:hover{background:#ffffff4d;transform:rotate(90deg)}.modal-body-custom[_ngcontent-%COMP%]{padding:30px;overflow-y:auto;flex:1}.modal-footer-custom[_ngcontent-%COMP%]{padding:20px 30px;border-top:1px solid #e9ecef;display:flex;justify-content:flex-end;gap:10px;background:#f8f9fa;border-radius:0 0 12px 12px}.empty-state-small[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6c757d}.theme-dark[_nghost-%COMP%]   .thread-item[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .thread-item[_ngcontent-%COMP%]{background:#111821;border-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .thread-item[_ngcontent-%COMP%]:hover, .theme-dark   [_nghost-%COMP%]   .thread-item[_ngcontent-%COMP%]:hover{background:#1a1f24;border-color:#667eea}.theme-dark[_nghost-%COMP%]   .thread-title[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .thread-title[_ngcontent-%COMP%]{color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .thread-view-header[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .thread-view-header[_ngcontent-%COMP%]{border-bottom-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .new-message-form[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .new-message-form[_ngcontent-%COMP%]{background:#0f1420;border-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .message-item[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .message-item[_ngcontent-%COMP%]{background:#111821;border-color:#2a2f36}.theme-dark[_nghost-%COMP%]   .message-item[_ngcontent-%COMP%]:hover, .theme-dark   [_nghost-%COMP%]   .message-item[_ngcontent-%COMP%]:hover{background:#1a1f24}.theme-dark[_nghost-%COMP%]   .message-text[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .message-text[_ngcontent-%COMP%]{color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .modal-dialog-custom[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .modal-dialog-custom[_ngcontent-%COMP%]{background:#1a1f24;color:var(--rd-text)}.theme-dark[_nghost-%COMP%]   .modal-header-custom[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .modal-header-custom[_ngcontent-%COMP%]{background:linear-gradient(135deg,#111a22,#1a1f24)}.theme-dark[_nghost-%COMP%]   .modal-body-custom[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .modal-body-custom[_ngcontent-%COMP%]{background:#1a1f24}.theme-dark[_nghost-%COMP%]   .modal-footer-custom[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .modal-footer-custom[_ngcontent-%COMP%]{background:#0f1420;border-top-color:#2a2f36}@media (max-width: 768px){.thread-header-row[_ngcontent-%COMP%]{flex-wrap:wrap}.thread-actions[_ngcontent-%COMP%]{width:100%;justify-content:flex-end}.thread-meta[_ngcontent-%COMP%]{font-size:.8rem}.message-item[_ngcontent-%COMP%]{flex-direction:column}.modal-dialog-custom[_ngcontent-%COMP%]{width:95%;max-height:95vh;margin:0}.modal-header-custom[_ngcontent-%COMP%], .modal-body-custom[_ngcontent-%COMP%], .modal-footer-custom[_ngcontent-%COMP%]{padding:15px 20px}.thread-view-header[_ngcontent-%COMP%]   .d-flex[_ngcontent-%COMP%]{flex-direction:column;gap:15px}.thread-actions-toolbar[_ngcontent-%COMP%]{width:100%}}"]})}}return t})();export{En as a};
