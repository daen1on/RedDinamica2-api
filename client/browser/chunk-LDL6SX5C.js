import{a as z}from"./chunk-ZTCIQEDA.js";import{a as N}from"./chunk-H2O7B6BZ.js";import{a as O}from"./chunk-M6MDGVAZ.js";import{Da as d,Ib as $,Jb as V,Na as n,Oa as i,Ob as D,Pa as m,Qb as R,Rb as A,Sb as P,Ta as g,Ua as f,Va as c,Vb as H,W as y,Z as w,ba as v,ca as _,cc as B,db as k,eb as s,ec as q,fb as u,ga as F,gb as h,hb as x,ib as T,nb as E,ob as M,pa as o,sa as L,sb as S,ta as I,ub as C,vb as j,ya as p}from"./chunk-3BHHYQXT.js";var G=(()=>{class t{constructor(e,a){this.http=e,this.userService=a,this.url=O.url}authHeaders(){return new P({"Content-Type":"application/json",Authorization:this.userService.getToken()||""})}getSummary(){return this.http.get(`${this.url}admin/tasks/summary`,{headers:this.authHeaders()})}listConvocatorias(){return this.http.get(`${this.url}admin/tasks/convocatorias`,{headers:this.authHeaders()})}listConvocatoriasAbiertas(){return this.http.get(`${this.url}admin/tasks/convocatorias-abiertas`,{headers:this.authHeaders()})}listSugerencias(){return this.http.get(`${this.url}admin/tasks/sugerencias`,{headers:this.authHeaders()})}listRecursosPendientes(){return this.http.get(`${this.url}admin/tasks/recursos`,{headers:this.authHeaders()})}listLeccionesAcademicas(){return this.http.get(`${this.url}admin/tasks/lecciones-academicas`,{headers:this.authHeaders()})}aprobarRecurso(e){return this.http.put(`${this.url}resource/${e}/approve`,{},{headers:this.authHeaders()})}rechazarRecurso(e,a){return this.http.put(`${this.url}resource/${e}/reject`,{reason:a},{headers:this.authHeaders()})}moverLeccionAcademica(e){return this.http.post(`${this.url}admin/tasks/lecciones/${e}/mover-a-reddinamica`,{},{headers:this.authHeaders()})}avalarYabrirConvocatoria(e){return this.http.post(`${this.url}admin/tasks/lecciones/${e}/avalar-y-abrir`,{},{headers:this.authHeaders()})}static{this.\u0275fac=function(a){return new(a||t)(w(H),w(N))}}static{this.\u0275prov=y({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Y=t=>["/academia/lessons",t],J=()=>[];function Q(t,l){t&1&&(n(0,"div",10)(1,"div",11)(2,"span",12),s(3,"Loading..."),i()()())}function W(t,l){if(t&1&&(n(0,"div",13),s(1),i()),t&2){let e=c();o(),u(e.errorMessage)}}function X(t,l){t&1&&(n(0,"div",14),s(1," No hay lecciones acad\xE9micas para destacar. "),i())}function Z(t,l){if(t&1){let e=g();n(0,"div",21)(1,"div",22)(2,"div",23)(3,"h6",24)(4,"a",25),s(5),i()(),n(6,"div",26),s(7),i()(),n(8,"div",27)(9,"button",28),f("click",function(){let r=v(e).$implicit,b=c(2);return _(b.moverARedDinamica(r._id))}),m(10,"i",29),i(),n(11,"button",30),f("click",function(){let r=v(e).$implicit,b=c(2);return _(b.moverARedDinamica(r._id))}),m(12,"i",31),i()()(),n(13,"p",32),s(14),i()()}if(t&2){let e=l.$implicit;o(4),d("routerLink",M(4,Y,e._id)),o(),h(" ",e.title," "),o(2),u((e.author==null?null:e.author.name)||"Autor desconocido"),o(7),u(e.resume)}}function ee(t,l){if(t&1&&(n(0,"div",2)(1,"div",3)(2,"div",15)(3,"div",16)(4,"div"),m(5,"i",17),n(6,"strong"),s(7,"Mejores lecciones candidatas"),i()(),n(8,"span",18),s(9),i()(),n(10,"div",19),p(11,Z,15,6,"div",20),i()()()()),t&2){let e=c();o(9),u(e.lessons.length),o(2),d("ngForOf",e.lessons)}}function te(t,l){t&1&&(n(0,"span"),m(1,"i",51),s(2,"Publicar lecci\xF3n"),i())}function ie(t,l){t&1&&(n(0,"span"),m(1,"span",52),s(2,"Publicando... "),i())}function ne(t,l){if(t&1){let e=g();n(0,"div",33)(1,"div",34)(2,"div",35)(3,"div",36)(4,"h5",37),m(5,"i",38),s(6,"Confirmar publicaci\xF3n"),i(),n(7,"button",39),f("click",function(){v(e);let r=c();return _(r.cancelarMovimiento())}),i()(),n(8,"div",40)(9,"div",41),m(10,"i",42),n(11,"strong"),s(12,"Mapeo de roles:"),i(),n(13,"ul",43)(14,"li"),s(15,"El "),n(16,"strong"),s(17,"autor"),i(),s(18," acad\xE9mico se mantiene como "),n(19,"strong"),s(20,"autor"),i(),s(21," en RedDin\xE1mica"),i(),n(22,"li"),s(23,"El "),n(24,"strong"),s(25,"l\xEDder"),i(),s(26," acad\xE9mico se mantiene como "),n(27,"strong"),s(28,"l\xEDder"),i(),s(29," en RedDin\xE1mica"),i(),n(30,"li"),s(31,"El "),n(32,"strong"),s(33,"profesor"),i(),s(34," acad\xE9mico se convierte en "),n(35,"strong"),s(36,"Facilitador"),i(),s(37," en RedDin\xE1mica"),i()()(),n(38,"p"),s(39,"\xBFEst\xE1s seguro de que deseas publicar esta lecci\xF3n en la RedDin\xE1mica principal?"),i(),n(40,"p",44),m(41,"i",45),s(42," Se notificar\xE1 a todos los participantes (author, leader, teacher y miembros del equipo de desarrollo) sobre la publicaci\xF3n. "),i()(),n(43,"div",46)(44,"button",47),f("click",function(){v(e);let r=c();return _(r.cancelarMovimiento())}),m(45,"i",48),s(46,"Cancelar "),i(),n(47,"button",49),f("click",function(){v(e);let r=c();return _(r.confirmarMovimiento())}),p(48,te,3,0,"span",50)(49,ie,3,0,"span",50),i()()()()()}if(t&2){let e=c();o(47),d("disabled",e.loading),o(),d("ngIf",!e.loading),o(),d("ngIf",e.loading)}}function se(t,l){if(t&1&&(n(0,"div",77)(1,"strong"),s(2,"Metodolog\xEDa:"),i(),n(3,"p",80),s(4),i()()),t&2){let e=c(3);o(4),u(e.previewLesson.justification.methodology)}}function ae(t,l){if(t&1&&(n(0,"div")(1,"strong"),s(2,"Objetivos:"),i(),n(3,"p",80),s(4),i()()),t&2){let e=c(3);o(4),u(e.previewLesson.justification.objectives)}}function oe(t,l){t&1&&(n(0,"p",81),s(1," Sin justificaci\xF3n "),i())}function re(t,l){if(t&1&&(n(0,"span",18),s(1),i()),t&2){let e=l.$implicit;o(),h(" ",(e==null?null:e.name)||e," ")}}function le(t,l){t&1&&(n(0,"span",58),s(1,"Sin \xE1reas asignadas"),i())}function de(t,l){if(t&1&&(n(0,"span",82),s(1),i()),t&2){let e=l.$implicit;o(),u(e)}}function me(t,l){t&1&&(n(0,"span",58),s(1,"Sin niveles asignados"),i())}function ce(t,l){if(t&1&&(n(0,"li"),m(1,"i",84),s(2),n(3,"span",58),s(4),S(5,"number"),i()()),t&2){let e=l.$implicit;o(2),h("",e.originalName||e.name," "),o(2),h("(",C(5,2,e.size/1024,"1.0-0")," KB)")}}function pe(t,l){if(t&1&&(n(0,"div",65)(1,"ul",79),p(2,ce,6,5,"li",83),i()()),t&2){let e=c(3);o(2),d("ngForOf",e.previewLesson.files)}}function ue(t,l){t&1&&(n(0,"span",58),s(1,"Sin archivos adjuntos"),i())}function ve(t,l){if(t&1&&(n(0,"span",58),s(1),i()),t&2){let e=c().$implicit;o(),h(" - ",e.role,"")}}function _e(t,l){if(t&1&&(n(0,"li"),s(1),p(2,ve,2,1,"span",71),i()),t&2){let e=l.$implicit;o(),x(" ",(e.user==null?null:e.user.name)||""," ",(e.user==null?null:e.user.surname)||""," "),o(),d("ngIf",e.role)}}function fe(t,l){if(t&1&&(n(0,"div")(1,"strong"),s(2),i(),n(3,"ul",80),p(4,_e,3,3,"li",83),i()()),t&2){let e=c(3);o(2),h("Miembros del equipo (",e.previewLesson.development_group.length,"):"),o(2),d("ngForOf",e.previewLesson.development_group)}}function he(t,l){t&1&&(n(0,"p",81),s(1,"Sin miembros adicionales"),i())}function ge(t,l){if(t&1&&(n(0,"div")(1,"div",57)(2,"div")(3,"h4",24),s(4),i(),n(5,"div",58),s(6),S(7,"date"),i()(),n(8,"span",59),s(9,"Academia"),i()(),n(10,"div",4)(11,"h6",60),m(12,"i",61),s(13,"Resumen"),i(),n(14,"p",58),s(15),i()(),m(16,"hr"),n(17,"div",4)(18,"h6",60),m(19,"i",62),s(20,"Referencias"),i(),n(21,"pre",63),s(22),i()(),n(23,"div",4)(24,"h6",60),m(25,"i",64),s(26,"Justificaci\xF3n"),i(),n(27,"div",65),p(28,se,5,1,"div",66)(29,ae,5,1,"div",50)(30,oe,2,0,"p",67),i()(),n(31,"div",4)(32,"h6",60),m(33,"i",68),s(34,"\xC1reas de conocimiento"),i(),n(35,"div",69),p(36,re,2,1,"span",70)(37,le,2,0,"span",71),i()(),n(38,"div",4)(39,"h6",60),m(40,"i",72),s(41,"Nivel(es)"),i(),n(42,"div",69),p(43,de,2,1,"span",73)(44,me,2,0,"span",71),i()(),n(45,"div",4)(46,"h6",60),m(47,"i",74),s(48,"Archivos adjuntos"),i(),p(49,pe,3,1,"div",75)(50,ue,2,0,"ng-template",null,0,j),i(),n(52,"div",4)(53,"h6",60),m(54,"i",76),s(55,"Equipo de desarrollo"),i(),n(56,"div",65)(57,"div",77)(58,"strong"),s(59,"L\xEDder:"),i(),s(60),i(),p(61,fe,5,2,"div",50)(62,he,2,0,"p",67),i()(),n(63,"div",4)(64,"h6",60),m(65,"i",78),s(66,"Docente"),i(),n(67,"p",79),s(68),i()()()),t&2){let e=k(51),a=c(2);o(4),u(a.previewLesson.title),o(2),T(" por ",(a.previewLesson.author==null?null:a.previewLesson.author.name)||"Autor"," ",(a.previewLesson.author==null?null:a.previewLesson.author.surname)||""," \u2022 ",C(7,21,a.previewLesson.createdAt,"short")," "),o(9),u(a.previewLesson.resume||"Sin resumen"),o(7),u(a.previewLesson.references||"Sin referencias"),o(6),d("ngIf",a.previewLesson.justification==null?null:a.previewLesson.justification.methodology),o(),d("ngIf",a.previewLesson.justification==null?null:a.previewLesson.justification.objectives),o(),d("ngIf",!(a.previewLesson.justification!=null&&a.previewLesson.justification.methodology)&&!(a.previewLesson.justification!=null&&a.previewLesson.justification.objectives)),o(6),d("ngForOf",a.previewLesson.knowledge_areas||E(24,J)),o(),d("ngIf",!(a.previewLesson.knowledge_areas!=null&&a.previewLesson.knowledge_areas.length)),o(6),d("ngForOf",a.previewLesson.level||E(25,J)),o(),d("ngIf",!(a.previewLesson.level!=null&&a.previewLesson.level.length)),o(5),d("ngIf",a.previewLesson.files==null?null:a.previewLesson.files.length)("ngIfElse",e),o(11),x(" ",(a.previewLesson.leader==null?null:a.previewLesson.leader.name)||""," ",(a.previewLesson.leader==null?null:a.previewLesson.leader.surname)||"\u2014"," "),o(),d("ngIf",a.previewLesson.development_group==null?null:a.previewLesson.development_group.length),o(),d("ngIf",!(a.previewLesson.development_group!=null&&a.previewLesson.development_group.length)),o(6),x(" ",(a.previewLesson.teacher==null?null:a.previewLesson.teacher.name)||""," ",(a.previewLesson.teacher==null?null:a.previewLesson.teacher.surname)||"No asignado"," ")}}function xe(t,l){if(t&1){let e=g();n(0,"div",33)(1,"div",53)(2,"div",35)(3,"div",54)(4,"h5",37),m(5,"i",55),s(6,"Previsualizaci\xF3n de lecci\xF3n a publicar"),i(),n(7,"button",39),f("click",function(){v(e);let r=c();return _(r.cancelarMovimiento())}),i()(),n(8,"div",40),p(9,ge,69,26,"div",50),i(),n(10,"div",46)(11,"button",47),f("click",function(){v(e);let r=c();return _(r.cancelarMovimiento())}),s(12,"Cancelar"),i(),n(13,"button",56),f("click",function(){v(e);let r=c();return r.showConfirmModal=!0,_(r.showPreviewModal=!1)}),s(14,"Continuar y publicar"),i()()()()()}if(t&2){let e=c();o(9),d("ngIf",e.previewLesson)}}var je=(()=>{class t{constructor(e,a){this.adminTasks=e,this.academicLessons=a,this.loading=!1,this.errorMessage="",this.lessons=[],this.selectedLessonId=null,this.showConfirmModal=!1,this.showPreviewModal=!1,this.previewLesson=null,this.lessonsCountChange=new F}ngOnInit(){this.loadLessons()}loadLessons(){this.loading=!0,this.adminTasks.listLeccionesAcademicas().subscribe({next:e=>{this.lessons=e?.items||e?.data||[],console.log("\u{1F4CC} [FeaturedLessons] lessons cargadas:",this.lessons),this.lessonsCountChange.emit(this.lessons.length),this.loading=!1},error:e=>{console.error(e),this.errorMessage="Error al cargar lecciones acad\xE9micas",this.lessonsCountChange.emit(0),this.loading=!1}})}moverARedDinamica(e){let a=this.lessons.find(r=>r._id===e)||null;this.previewLesson=a,console.log("\u{1F441}\uFE0F [FeaturedLessons] previewLesson:",this.previewLesson),this.selectedLessonId=e,this.showPreviewModal=!0}confirmarMovimiento(){this.selectedLessonId&&(this.loading=!0,this.adminTasks.moverLeccionAcademica(this.selectedLessonId).subscribe({next:()=>{console.log("\u2705 [FeaturedLessons] Publicada en RedDin\xE1mica:",this.selectedLessonId),this.showConfirmModal=!1,this.showPreviewModal=!1,this.selectedLessonId=null,this.loadLessons()},error:e=>{console.error(e),this.errorMessage="No se pudo mover la lecci\xF3n",this.loading=!1,this.showConfirmModal=!1,this.showPreviewModal=!1,this.selectedLessonId=null}}))}cancelarMovimiento(){this.showConfirmModal=!1,this.showPreviewModal=!1,this.selectedLessonId=null}static{this.\u0275fac=function(a){return new(a||t)(L(G),L(z))}}static{this.\u0275cmp=I({type:t,selectors:[["app-featured-lessons"]],outputs:{lessonsCountChange:"lessonsCountChange"},decls:11,vars:6,consts:[["nofiles",""],[1,"container-fluid","mt-4"],[1,"row"],[1,"col-12"],[1,"mb-3"],["class","text-center text-muted my-4",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["class","alert alert-info",4,"ngIf"],["class","row",4,"ngIf"],["class","modal fade show","tabindex","-1","aria-modal","true","role","dialog","style","display: block; background: rgba(0,0,0,0.5);",4,"ngIf"],[1,"text-center","text-muted","my-4"],["role","status",1,"spinner-border",2,"width","3rem","height","3rem"],[1,"visually-hidden"],[1,"alert","alert-danger"],[1,"alert","alert-info"],[1,"card","shadow-sm"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"fas","fa-trophy","text-warning","me-2"],[1,"badge","bg-primary"],[1,"list-group","list-group-flush"],["class","list-group-item lesson-item",4,"ngFor","ngForOf"],[1,"list-group-item","lesson-item"],[1,"d-flex","w-100","justify-content-between","align-items-start"],[1,"flex-grow-1"],[1,"mb-1"],[1,"text-decoration-none","text-primary","lesson-title-link",3,"routerLink"],[1,"small","text-muted"],[1,"btn-group"],["title","Ver detalles",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"fas","fa-eye"],["title","Publicar en RedDin\xE1mica",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-upload"],[1,"mb-0","mt-2","text-muted","small"],["tabindex","-1","aria-modal","true","role","dialog",1,"modal","fade","show",2,"display","block","background","rgba(0,0,0,0.5)"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header","bg-primary","text-white"],[1,"modal-title"],[1,"fas","fa-check-circle","me-2"],["type","button","aria-label","Close",1,"btn-close","btn-close-white",3,"click"],[1,"modal-body"],[1,"alert","alert-info","mb-3"],[1,"fas","fa-info-circle","me-2"],[1,"mb-0","mt-2"],[1,"mb-0","text-muted","small"],[1,"fas","fa-bell","me-1"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"fas","fa-times","me-2"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[4,"ngIf"],[1,"fas","fa-rocket","me-2"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"modal-dialog","modal-lg","modal-dialog-centered","modal-dialog-scrollable"],[1,"modal-header","bg-info","text-white"],[1,"fas","fa-eye","me-2"],["type","button",1,"btn","btn-primary",3,"click"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"text-muted"],[1,"badge","bg-info"],[1,"text-primary"],[1,"fas","fa-file-alt","me-2"],[1,"fas","fa-book","me-2"],[1,"bg-light","p-2","rounded",2,"white-space","pre-wrap"],[1,"fas","fa-lightbulb","me-2"],[1,"bg-light","p-2","rounded"],["class","mb-2",4,"ngIf"],["class","mb-0 text-muted",4,"ngIf"],[1,"fas","fa-graduation-cap","me-2"],[1,"d-flex","flex-wrap","gap-2"],["class","badge bg-primary",4,"ngFor","ngForOf"],["class","text-muted",4,"ngIf"],[1,"fas","fa-layer-group","me-2"],["class","badge bg-secondary",4,"ngFor","ngForOf"],[1,"fas","fa-paperclip","me-2"],["class","bg-light p-2 rounded",4,"ngIf","ngIfElse"],[1,"fas","fa-users","me-2"],[1,"mb-2"],[1,"fas","fa-chalkboard-teacher","me-2"],[1,"mb-0"],[1,"mb-0","mt-1"],[1,"mb-0","text-muted"],[1,"badge","bg-secondary"],[4,"ngFor","ngForOf"],[1,"fas","fa-file","me-2"]],template:function(a,r){a&1&&(n(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2",4),s(4,"Mejores lecciones (RedDin\xE1mica acad\xE9mica)"),i()()(),p(5,Q,4,0,"div",5)(6,W,2,1,"div",6)(7,X,2,0,"div",7)(8,ee,12,2,"div",8)(9,ne,50,3,"div",9),i(),p(10,xe,15,1,"div",9)),a&2&&(o(5),d("ngIf",r.loading),o(),d("ngIf",!r.loading&&r.errorMessage),o(),d("ngIf",!r.loading&&!r.errorMessage&&r.lessons.length===0),o(),d("ngIf",!r.loading&&r.lessons.length>0),o(),d("ngIf",r.showConfirmModal),o(),d("ngIf",r.showPreviewModal))},dependencies:[A,$,V,R,D,q,B],encapsulation:2})}}return t})();export{G as a,je as b};
